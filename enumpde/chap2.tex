\chapter{Finite Differenzen Verfahren für elliptische Probleme} \label{chap:2}



\section{Finite Differenzen für Poisson-Gleichung} \label{sec:2.1}


\begin{df}[Finite Differenz] \label{2.1}
	Sei $h \in \R$, $e_j \in \R^d$ Einheitsvektor für $j = 1, \dotsc, d$ und $u: \Set{x, x \pm e_j h & j = 1, \dotsc, d} \to \R$, dann definieren wir \emphdef[Vorwärtsdifferenz]{Vorwärts-} oder \emphdef{rechtsseitige Differenz} durch
	\[
		(\partial_{x_j}^{+h}u)(x) := \frac{u(x+he_j) -u(x)}{h}
	\]
	analog \emphdef[Rückwärtsdifferenz]{Rückwärts-} oder \emphdef{linksseitige Differenz} durch
	\[
		(\partial_{x_j}^{-h}u)(x) := \frac{u(x) - u(x-he_j)}{h}
	\]
	und \emphdef[symmetrische Differenz]{symmetrische} oder \emphdef{zentrale Differenz} durch
	\[
		(\partial_{x_j}^{ch} u)(x)
		:= \f 12 (\partial_{x_j}^{+h} u(x) + \partial_{x_j}^{-h} u(x))
		= \frac{u(x+he_j) - u(x-he_j)}{2h}
	\]
\end{df}


\begin{st}[Approximationsgüte] \label{2.2}
	Sei $u: \Omega \to \R, x \in \Omega \subset \R^d, r \in \N^+$ mit $B_r(x) \subset \Omega$.
	Für $h < r$ gilt dann
	\begin{enumerate}[i)]
		\item
			$|\partial_{x_j} u(x) - \partial_{x_j}^{\pm h} u(x)| \le \f h2 \|\partial_{x_j}^2 u\|_\infty$ für $u \in C^2(\_\Omega)$
		\item
			$|\partial_{x_j} u(x) - \partial_{x_j}^{c, h} u(x)| \le \f {h^2}6 \|\partial_{x_j}^3 u\|_\infty$ für $u \in C^3(\_\Omega)$
		\item
			$|\partial_{x_j}^2 u(x) - \partial_{x_j}^{-h} \partial_{x_j}^{+h} u(x)| \le \f {h^2}{12} \|\partial_{x_j}^4 u\|_\infty$ für $u \in C^4(\_\Omega)$
	\end{enumerate}
	\begin{proof}
		Es genügt dies für $d = 1$ zu zeigen, denn  sei $u \in C^k(\_\Omega), v(t) = u(x + th e_j)$.
		Dann ist $\|\ddx[t^k] v(t)\|_\infty \le \|\partial_{x_j}^k u\|_{C^0(\_\Omega)}$.
		\begin{enumerate}[i)]
			\item
				Taylor liefert für ein $\xi \in (x, x + h)$
				\[
					u(x+h) = u(x) + hu'(x) + \f {h^2}2 u''(\xi)
				\]
				Es folgt
				\[
					\partial_x u(x) - \partial_x^{+h} u(x)
					= u'(x) - \f{u(x+h) - u(x)}{h}
					= - \f h2 u''(\xi).
				\]
				Analog für die linksseitige Differenz.
			\item
				Subtraktion von
				\begin{align*}
					u(x+h) &= u(x) + hu'(x) + \f {h^2}2 u''(x) + \f {h^3}6 u'''(\xi) \\
					u(x-h) &= u(x) - hu'(x) + \f {h^2}2 u''(x) - \f {h^3}6 u'''(\_\xi) \\
				\end{align*}
				mit $\xi \in (x,x+h), \_\xi \in (x-h,x)$ liefert
				\[
					u(x+h) - u(x-h) = 2h u'(x) + \f{h^3}6 \big(u'''(\xi) + u'''(\_\xi)\big),
				\]
				also
				\[
					u'(x) - \f{u(x+h) - u(x-h)}{2h}
					= - \f{h^2}{12} \big( u'''(\xi) + u'''(\_\xi) \big)
					\le \f{h^2}6 \|u'''\|_\infty.
				\]
			\item
				Addition von
				\begin{align*}
					u(x+h) &= u(x) + hu'(x) + \f{h^2}2 u''(x) + \f {h^3}6 u'''(x) + \f{h^4}{24} u''''(\xi) \\
					-2u(x) &= -2u(x) \\
					u(x+h) &= u(x) - hu'(x) + \f{h^2}2 u''(x) - \f {h^3}6 u'''(x) + \f{h^4}{24} u''''(\_\xi) \\
				\end{align*}
				mit $\xi \in (x,x+h), \_\xi \in (x-h, x)$ liefert
				\begin{align*}
					\partial_x^{-h} \partial_x^{+h} u(x)
					&= \dfrac{\frac{u(x+h)-u(x)}{h}-\frac{u(x)-u(x-h)}{h}}{h} \\
					&= \frac{u(x+h) - 2u(x) +  u(x+h)}{h^2} \\
					&= \f 1{h^2} \big( \f {h^2}2 + \f {h^2}2 \big) u''(x) + \f 1{h^2} \f {h^4}{24} \big( u''''(\xi) + u''''(\_\xi) \big)
				\end{align*}
		\end{enumerate}
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Die Approximation in iii) ist also eine zweite zentrale Differenz
				\[
					\partial_{x_j}^{-h} \partial_{x_j}^{+h} u(x)
					= \partial_{x_j}^{+h} \partial_{x_j}^{-h} u(x)
					= \partial_{x_j}^{c, \f h2} \partial_{x_j}^{c, \f h2} u(x)
					= \f{u(x+h) - 2u(x) + u(x-h)}{h^2}.
				\]
			\item
				Aus dem Beweis folgt, dass $\partial_x^{-h} \partial_{x}^{+h} u(x) = u''(x)$ falls $u^{(4)} = 0$, z.B. für $u \in \P_3$.
			\item
				Man kann zentrale Differenzen für höhere Ableitungen verallgemeinern:
				\[
					\partial_{x_j}^{h,m} u(x)
					:= (\partial_{x_{j}}^{c, \f h2})^m u(x)
				\]
				falls $u: \Set{u+(k-\f m2) h e_j & k = 0, \dotsc, m } \to \R$.
				Dann ist
				\[
					\partial_{x_j}^{h,m} u(x)
					= \f 1{h^m} \sum_{k=0}^m \binom{m}{k} (-1)^{k+m} u\big( x + (k-\f m2) h e_j \big).
				\]
		\end{itemize}
	\end{note}
\end{st}

\begin{kor}[FD-Approximation für Laplace] \label{2.3}
	Sei $u : \Set{x, x \pm h e_j} \to \R$.
	Dann definieren wir
	\begin{equation} \label{eq:2.1}
		\Laplace_h u(x) :=
		\Big(\sum_{j=1}^d \partial_{x_j}^{-h} \partial_{x_j}^{+h} u \Big) (x)
	\end{equation}
	und es gilt unter den Voraussetzungen von \ref{2.2}
	\[
		|\Laplace u(x) - \Laplace_h u(x)| \le C h^2
	\]
	für $u \in C^4(\_\Omega)$.
	\begin{proof}
		Dreiecksungleichung und \ref{2.2} iii) liefert
		\begin{align*}
			|\Laplace u(x) - \Laplace_h u(x)|
			&= \Big| \sum_{i=1}^d \partial_{x_j}^2 u(x) - \partial_{x_j}^{-h} \partial_{x_j}^{+h} u(x) \Big| \\
			&\le \sum_{i=1}^d | \partial_{x_j}^2 u(x) - \partial_{x_j}^{-h} \partial_{x_j}^{+h} u(x) \Big| \\
			&\le \sum_{j=1}^d \f {h^2}{12} \|\partial_{x_j}^{(4)} u\|_\infty \\
			&\le d \f {h^2}{12} \|u\|_{C^4(\_\Omega)}.
		\end{align*}
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Für $p(x) := \prod_{i=1}^d p_i(x_i)$ mit $p_i \in \P_3$ ist $\Laplace_h$ exakt, d.h. $\Laplace_h p(x) = \Laplace p(x)$.
		\end{itemize}
	\end{note}
\end{kor}


\begin{df}[Würfelgebiet] \label{2.4}
	Sei $\Omega \subset \R^d$ offen, beschränkt.
	$\Omega$ heißt \emphdef{Würfelgebiet} zu $h \in \R^+$, falls $Z \subset \Z^d$ sodass $\Omega = W \setminus \Boundary W =: \mathring W$ mit $W := \bigcup_{z \in Z} W(z)$ und
	\begin{math}
		W(z) := [z_1h , (z_1+1)h] \times \dotsc \times [z_d h, (z_d+1)h] \subset \R^d.
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				Ist $\Omega$ ein Würfelgebiet zu $h$, dann ist $\Omega$ auch ein Würfelgebiet zu $\f hn$ für alle $n \in \N$.
		\end{itemize}
	\end{note}
\end{df}

\begin{df}[FD-Gitter] \label{2.5}
	Sei $\Omega \subset \R^d$ ein Würfelgebiet zu $h \in \R^+$, $\Gamma := \Boundary \Omega$, also $\_\Omega = \Omega \cup \Gamma$.
	Wir definieren das \emphdef{Gitter} $\_\Omega_h$ durch \emphdef{innere Punkte} $\Omega_h$ und \emphdef{Randpunkte} $\Gamma_h$, wobei
	\begin{math}
		\Omega_h &:= \Set{ x \in \Omega & \exists z \in \Z^d : x = hz }, \\
		\Gamma_h &:= \Set{ x \in \Gamma & \exists z \in \Z^d : x = hz }, \\
		\_\Omega_h &:= \Omega_h \cup \Gamma_h.
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				Jeder innere Punkt hat genau $2d$ Nachbarn im Abstand von $h$ in $\_\Omega_h$
			\item
				Erweiterung für allgemeine Gebiete später.
		\end{itemize}
	\end{note}
\end{df}

\begin{df}[Gitterfunktionen] \label{2.6}
	Zu einem Gitter $\_\Omega_h$ definieren wir den Raum der \emphdef{Gitterfunktionen} $X_h := \Set{ v : \_\Omega_h \to \R }$
	und den Teilraum der Funktionen mit Nullrandwerten $X_h^0 := \Set{ v \in X_h & \forall x \in \Gamma_h : v(x) = 0 } \subset X_h$
	und den Raum der Funktionen auf inneren Punkten $Y_h := \Set{v: \Omega_h \to \R}$ mit Maximumsnorm $\|v\|_{\_\Omega_h} := \max_{x\in \_\Omega_h} |v(x)|$ und $\|v\|_{\Omega_h} := \max_{x\in\Omega_h} |v(x)|$.
\end{df}

\begin{nt*}[Nebenbemerkungen]
	\begin{itemize}
		\item
			$X_h, \|\argdot\|_{\_\Omega_h}), (X_h^0, \|\argdot\|_{\Omega_h}), (X_h^ , \|\argdot\|_{\_\Omega_h}), (Y_h, \|\argdot\|_{\Omega_h})$ sind endlichdimensionale, normierte Vektorräume über $\R$ und damit vollständig, also Banachräume.
		\item
			Man kann auch $X_h$ mit einer Hilbertraumstruktur versehen, indem man das \emphdef[diskretes $l_2$-Skalarprodukt]{diskrete $L_2$-Skalarprodukt} definiert:
			\[
				\<u,v\>_{l_2} := h^d \sum_{x\in\_\Omega_h} u(x) v(x),
			\]
			welches die Norm $\|u\|_{l_,} := \sqrt{h^d \sum_{x\in\_\Omega} u(x)^2}$ induziert.
			Dann ist $X_h$ auch vollständig bezüglich $\|\argdot\|_{l_2}$, weiter gilt: $\lim_{h\to 0} \|u\|_{l_2} = \|u\|_{L^2(\Omega)}$ für $u \in C^0(\Omega)$.
		\item
			Man kann $X_h$ mit einer Seminorm versehen, welche auch die Ableitungen miteinbezieht
			\[
				|u|_{h_1}
				:= \Big( h^d \sum_{x\in\Omega} \sum_{j=1}^d  \big(\partial_{x_j}^{+h} u(x)\big)^2 \Big)^{\f 12},
			\]
			die \emphdef{diskrete $h_1$ Seminorm}.
			Dies ist sogar eine Norm auf $X_h^0$, aber nicht auf $X_h$.

			Durch Kombination mit der diskreten $l_2$-Norm erhält man eine Norm auf $X_h$ („diskrete $h_1$ Norm“):
			\[
				\|u\|_{h_1}
				:= \sqrt{\|u\|_{l_2}^2 + |u|_{h_1}^2},
			\]
			bezüglich welcher $X_h$ ein Hilbertraum ist.
	\end{itemize}
\end{nt*}

Für $v \in X_h$ ist mit \eqref{eq:2.1} der Operator $-\Laplace_h v(x)$ für $x \in \Omega_h$ wohldefiniert, d.h. wir können $\Laplace_h : X_h \to Y_h$ als linearen Operator sehen.

\begin{df}[FD-Approximation für Poisson-RWP] \label{2.7}
	Sei ein Gitter $\_\Omega_h$ gegeben.
	Dann nennen wir $u_h \in X_h$ \emphdef{Finite Differenzen Lösung} des Poisson-RWPs aus \ref{1.23}, falls
	\begin{align} \label{eq:2.2}
		\Laplace_h u_h(x) &= f(x) && \text{$x \in \Omega_h$} \\
		u_h(x) &= g(x) && \text{$x\in \Gamma_h$}. \notag
	\end{align}
\end{df}

\begin{nt*}[Berechnung via LGS]
	\begin{itemize}
		\item
			Lege eine Aufzählung $\Set{x_1, \dotsc, x_n} = \Omega_h$ fest.
			Dann ist \eqref{eq:2.2} äquivalent zu einem LGS für Unbekannte $\underbar{u}_h = (u_i)_{i=1}^n$ mit $u_i = u_h(x_i)$ für $i=1,\dotsc, n$.
			Auf dem Rand $\Gamma_h$ ist $u_h$ schon festgelegt durch $g$.
		\item
			Sei FD-Operator in $x_i \in \Omega_h$ gegeben durch
			\[
				\Laplace_h u(x_i) = \sum_{j=1}^n \alpha_{ij} u(x_j) + \sum_{x\in \Gamma_h} \beta_{ix} u(x).
			\]
			Dann ist das LGS gegeben durch $A_h \underbar{u}_h = b_h$ mit $(A_h)_{ij} = \alpha_{ij}$ und $(b_h)_i = f(x_i) - \sum_{x\in \Gamma_h} \beta_{ix} g(x)$.
		\item
			$A_h$ ist dünn besetzt (sparse), da sie nur sehr wenige nichtnull-Einträge pro Zeile enthält.
	\end{itemize}
\end{nt*}

\Timestamp{2014-10-31}

\begin{ex} \label{2.8}
	Sei $d=1, \Omega = (0,1), n \in \N, h := \f 1{n+1}, x_i := i h, i \in \Set{0, \dotsc, n+1}$.
	Dann ist $\Omega_h := \Set{x_1, \dotsc, x_n}, \Gamma_h := \Set{x_0, x_{n+1}}$.
	Betrachte die Poisson-Gleichung
	\begin{align*}
		-u''(x) &= f(x) && x \in \Omega, \\
		u(0) &= \alpha, \\
		u(1) &= \beta.
	\end{align*}
	Sei $u_i \approx u(x_i)$ für $i=1, \dotsc, n$, $u_0 = \alpha, u_{n+1} = \beta$.
	Diskretisierung ergibt
	\[
		- \f{u_{i+1} - 2u_i + u_{i-1}}{h^2} = f(x_i)
	\]
	für $i = 1, \dotsc, n$.
	Das LGS ergibt sich als
	\[
		\overbrace{\f 1{h^2} \underbrace{\Matrix{2 & -1 & & \\ -1 & \ddots & \ddots & \\ & \ddots & \ddots & -1 \\ & & -1 & 2}}_{\tilde A_n}}^{A_h}
		\Vector{u_1 & \dots & u_n}
		= \Vector{f(x_1) + \f{\alpha}{h^2} & f(x_2) & \dots & f(x_{n-1}) & f(x_n) + \f{\beta}{h^2}}.
	\]
	\begin{note}
		\begin{itemize}
			\item
				$A_h$ ist tridiagonal, symmetrisch, $A_h = \f 1{h^2} \tilde A_n$
			\item
				$A_h$ ist regulär, denn per Induktion folgt $\det \tilde A_{n} = n + 1$:
				\begin{proof}
					Für $n = 1$ ist $\det(\tilde A_n) = \det(2) = n+1$.
					Die Aussage gelte für $n-1$, es gilt
					\begin{align*}
						\det \tilde A_n
						&= \det \Matrix{\tilde A_{n-1} & & \\ & & -1 \\ & -1 & 2} \\
						&= 2 \det \tilde A_{n-1} - (-1) \det \Matrix{\tilde A_{n-2} & & \\ & & & \\ & -1 & -1} \\
						&= 2 n + (-1) \det \tilde A_{n-2}
						= 2n - (n-1)
						= n+1
					\end{align*}
				\end{proof}
			\item
				$A_h$ ist positiv definit, denn Gerschgorin liefert $\lambda_i(\tilde A_n) \in [0,4]$ und wegen Regularität $\lambda_i(\tilde A_n) \neq 0$.
				Es folgt also $\lambda_i > 0$ für $i = 1, \dotsc, n$.
			\item
				Also existiert eine eindeutige FD-Lösung für das Poisson-RWP in einer Dimension.
			\item
				Wegen $A_h$ symmetrisch, positiv definit kann das CG oder das PCG Verfahren zum iterativen Lösen des LGS verwendet werden.
			\item
				Man kann hier auch direkt stetige Abhängigkeit von den Daten beweisen:
				Seien $u_h, \_u_h$ Lösungen zu $f, \alpha, \beta$, bzw. $\_f, \_\alpha, \_\beta$.
				Dann existiert $C > 0$ unabhängig von $f, \_f, \alpha, \_\alpha, \beta, \_\beta$ sodass
				\[
					\|u_h - \_u_h\| \le C \Big( \|f-\_f\| + |\alpha - \_\alpha| + |\beta - \_\beta| \Big).
				\]
		\end{itemize}
	\end{note}
\end{ex}

\begin{ex} \label{2.9}
	Sei $d = 2, \Omega = (0,1)^2$ und betrachte das Poisson-RWP mit $g(x) = 0$, $m \in \N, h:= \f 1{m+1}, n := m^2$.
	Statt Einzelindex ist ein Doppelindex übersichtlicher, setze dazu
	\begin{align*}
		x_{ij} &= (ih, jh),&
		u_{ij} &\approx u(x_{ij}) \quad \text{für $0 \le i,j \le m+1$}.
	\end{align*}
	Die Diskretisierung des RWP liefert für jeden inneren Punkt eine Gleichung
	\[
		\f 1{h^2} \Big( 4 u_{ij} - u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1}\Big)
		= f(ih, jh).
	\]
	Am Rand gilt
	\[
		u_{0,j} = u_{m+1,j} = u_{j,0} = u_{j,m+1}
	\]
	für $0 < i,j < m$.
	Für jede beliebige Wahl einer Aufzählung der $\Set{u_{ij}}$ erhält man ein System $A_h u_h = b_h$ mit $A_h$ symmetrisch, $\f 4{h^2}$ auf der Diagonalen und $-\f 1{h^2}$ an bis zu $4$ Einträgen pro Zeile/Spalte.

	Falls eine lexikographische Aufzahlung gewählt wird:
	\[
		\_u_h = \Big(u_{11}, u_{12}, \dotsc, u_{1m}, u_{21}, \dotsc, u_{2m}, \dotsc, u_{mm} \Big)
	\]
	so erhält $A_h$ eine Bandstruktur, jedoch nicht mehr tridiagonal wie in \ref{2.8}, sondern „Block-tridiagonal“:
	\begin{align*}
		A_h &= \f 1{h^2} \Matrix{B & C & & \\C & \ddots & \ddots & \\ & \ddots & \ddots & C \\ & & C & B}, &
		B &= \Matrix{4 & -1 & & \\ -1 & \ddots & \ddots & \\ & \ddots & \ddots & -1 \\ & & -1 & 4}, &
		C &= \Matrix{-1 & & \\ & \ddots & \\ & & -1},
	\end{align*}
	\begin{note}[Beliebige Gebiete]
		\begin{itemize}
			\item
				Falls $\Omega$ beschränkt ist, aber kein Würfelgebiet, muss das Gitter modifiziert werden, indem Schnittpunkte von $\Gamma$ mit den $h \Z^d$ Würfelkanten hinzugenommen werden:
				\[
					\Gamma_h := \Set{ x \in \Gamma & \exists z\in \Z^d, j =1,\dotsc, d : x \in z + \R e_j }
				\]
				Dann wird wie gehabt $\_\Omega_h := \Omega_h \cup \Gamma_h$ mit $\Omega_h$ aus \ref{2.5} definiert.
			\item
				% Rand in Süd/West richtung
				Koeffizienten der FD-Diskretisierung werden angepasst.
				Die Taylor-Entwicklung liefert
				\begin{align*}
					u''(x) &= \f{2}{h_W(h_O + h_W)} u(x-h_W) - \f 2{h_Oh_W} u(x) + \f 2{h_O(h_O+h_W)} u(x+h_O) \\
					&\quad + \LandauO(h) \\
					\Laplace(u) &= \f{2}{h_W(h_O+h_W)} u(x-e_1h_W) - \f 2{h_Oh_N} u(x) + \f 2{h_O(h_O+h_W)} u(x+h_O e_1) \\
					&\quad + \f 2{h_S(h_N+h_S)} u(x-e_2 h_S) - \f 2{h_S h_N} u(x) + \f 2{h_N(h_S+h_N)} u(x+ e_2 h_N) \\
					&\quad + \LandauO(h)
				\end{align*}
				„Shortley-Weller Approximation“.
		\end{itemize}
	\end{note}
	\begin{note}[Andere Randbedingungen]
		Neben Dirichlet- können auch andere Randbedingungen realisiert werden, z.B. Neumann-Randbedingungen:
		\begin{align*}
			(\Nabla u) \cdot n &= g_N
			&& \text{auf $\Gamma_N \subset \Gamma$}.
		\end{align*}
		Wir nennen $\Gamma_N$ \emphdef{Neumann-Randteil}.
		Wir nehmen an, dass $x$ auf einer Kante liegt und nicht auf einer Ecke von $\Gamma$ (sonst ist keine Normale $n$ definiert).
		Sei $n = \pm e_j$ (da Würfelgebiet) äußerer Normalenvektor für ein $j = 1, \dotsc, d$.
		Wir Approximieren $\Nabla u$ durch
		\[
			(\Nabla_h u)_i :=
			\begin{cases}
				\partial_{x_i}^{c,h} u & i \neq j \\
				\partial_{x_j}^{-h} u & i = j
			\end{cases}.
		\]
		Nun sind $u_h(x), x \in \Gamma_h \cap \Gamma_N$ Unbekannte.
		Es fällt eine weitere Gleichung für das LGS an:
		\[
			(\Nabla_h u_h(x)) \cdot n = g_N(x)
		\]
		für $x \in \Gamma_h \cap \Gamma_N$.
	\end{note}
\end{ex}


\section{Allgemeine Elliptische PDEs zweiter Ordnung} \label{sec:2.2}

\begin{df}[Allgemeine Elliptische RWP] \label{2.10}
	Zu $\Omega \subset \R^d$ beschränkt, $f \in C^0(\Omega), g \in C^0(\Boundary \Omega)$ sei
	\begin{equation} \label{eq:2.3}
		(\scr L u)(x)
		= - \sum_{i,j=1}^d a_{ij}(x) \partial_{x_j} \partial_{x_i} u(x)
		+ \sum_{i=1}^d b_i(x) \partial_{x_i} u(x) + c(x) u(x)
	\end{equation}
	gleichmäßig elliptisch und $a_{ij}, b_i, c \in C^0(\_\Omega)$.
	Gesucht ist $u \in C^2(\Omega) \cap C^0(\_\Omega)$.
	\begin{align*}
		\scr L u(x) &= f(x) && \text{$x \in \Omega$}, \\
		u(x) &= g(x) && \text{$x\in\Gamma$}.
	\end{align*}
\end{df}

\begin{df}[FD-Approximation] \label{2.11}
	Für $\scr L$ aus \eqref{eq:2.3}, $x \in \Omega$ mit $\_B_h(x)  \subset \_\Omega$ definiere
	\begin{math}
		\scr L_h u(x)
		&:= - \sum_{i=1}^d a_{ii} (x) \partial_{x_i}^{-h} \partial_{x_i}^{+h} u(x)
		- \sum_{\substack{i,j=1 \\ i\neq j}}^d a_{ij} (x) \partial_{x_i}^{c,h} \partial_{x_j}^{c,h} u(x) \\
		&\qquad + \sum_{i=1}^d b_i(x) \partial_{x_i}^{c,h} u(x)	+ c(x) u(x).
	\end{math}
	\begin{note}
		Wir werden sehen, dass
		\begin{itemize}
			\item
				\ref{2.11} nur unter weiteren Annahmen an $a_{ij}, b_i, c, h$ eine „stabile Diskretisierung“ ergibt,
			\item
				Eine etwas sorgfältigere Diskretisierung des Hauptteils eine erweiterte Klasse von Problemen stabil diskretisiert.
		\end{itemize}
	\end{note}
\end{df}

\begin{st}[FD-Approximationsfehler für $\scr L_h$] \label{2.12}
	Sei $u \in C^4(\_\Omega), x \in \Omega$ sodass $x + \sum_{i=1}^d \sigma_i e_i h \in \_\Omega$ für $\sigma_i = \Set{0,+1, -1}$, $i = 1, \dotsc, d$.
	Dann existiert ein $C$ (unabhängig von $x,h$) sodass
	\[
		\big|\scr L u(x) - \scr L_h u(x)\big| \le C h^2.
	\]
	\begin{proof}
		Taylor analog zu \ref{2.2} und \ref{2.3}.
	\end{proof}
\end{st}

\begin{note}[FD-Stern]
	\begin{itemize}
		\item
			Die Diskretisierung $\scr L_h$ kann man anschaulicher notieren: z.B. für $d = 2$.
			Falls $\scr L_h u(x_1, x_2) = \f 1{h^2} \sum_{i,j=-m}^m \alpha_{ij} u(x_1 + ih, x_2 + jh)$ dann ist
			\begin{equation} \label{eq:2.4}
				\Matrix[{
					\alpha_{-m,m} & \hdots & \alpha_{0,m} & \hdots & \alpha_{m,m} \\
					\vdots && \vdots && \vdots \\
					\alpha_{-m, 0} & \hdots & \alpha_{0,0} & \hdots & \alpha_{m,0} \\
					\vdots && \vdots && \vdots \\
					\alpha_{-m,-m} & \hdots & \alpha_{0,-m} & \hdots & \alpha_{m,-m}
				}_*
			\end{equation}
			Für $\scr L_h = -\Laplace_h$ aus \ref{2.3} ergibt sich für $m = 1$ der \emphdef{5-Punkt-FD-Stern}
			\[
				\Matrix[{ 0 & -1 & 0 \\ -1 & 4 & -1 \\ 0 & -1 & 0 }_*
			\]
			Für $\scr L_h$ aus \ref{2.11} (ohne Einschräkung $a_{12} = a_{21}$):
			\begin{math}[numbered] \label{eq:2.5}
				\f 12 \Matrix[{ a_{12}(x) & - 2 a_{22}(x) & - a_{12}(x) \\ -2 a_{11}(x) & 4(a_{11}(x) + a_{22}(x)) & -2a_{11}(x) \\ -a_{12}(x) & -2 a_{22}(x) & a_{12}(x)}_*
				+ \f h2 \Matrix[{ 0 & b_2(x) & 0 \\ -b_1(x) & 0 & b_1(x) \\ 0 & -b_2(x) & 0 }_*
				+ h^2 \Matrix[{0 & 0 & 0 \\ 0 & c(x) & 0 \\ 0 & 0 & 0}_*.
			\end{math}
		\item
			Für $m = 1$ (also $3\times 3$ Sterne) ist höchstens Approximationsordnung 2 erreichbar, wie in \ref{2.12} und \ref{2.3} für spezielle $\scr L_h$ gesehen
		\item
			Für $m > 1$ sind bessere Approximationsordnungen erreichbar
	\end{itemize}
\end{note}

\begin{df}[FD-Approximation für elliptisches RWP] \label{2.13}
	Sei $\Omega$ Würfelgebiet zu $h \in \R^+$, $\_\Omega_h$ zugehöriges Gitter.
	Dann ist $u_h \in X_h$ FD-Lösung falls
	\begin{align*}
		\scr L_h u_h(x) &= f(x) && \text{$x \in \Omega_h$}, \\
		u_h(x) &= g(x) && \text{$x\in \Gamma_h$}.
	\end{align*}
\end{df}

\begin{df}[Diskreter Zusammenhang] \label{2.14}
	Ein Gitter $\_\Omega_h$ heißt \emphdef{diskret zusammenhängend} falls es für alle $x,y \in \Omega_h$ (innere Punkte) eine Punktfolge $z_i \in \Omega_h$, $i = 0, \dotsc, k$ gibt mit $z_0 = x, z_k = y$ und $|z_i - z_{i-1}| = h$ für $i = 1, \dotsc, k$.
	\begin{note}
		Wenn zu grob gesampled wird, kann es vorkommen, dass $\Omega$ zwar zusammenhängend ist, $\Omega_h$ jedoch nicht.
		Falls $\Omega$ zusammenhängend, ist jedoch für hinreichend kleines $h$ auch $\_\Omega_h$ diskret zusammenhängend.
	\end{note}
\end{df}

\begin{lem}[Sternlemma] \label{2.15}
	Sei $k \ge 1$, $\Set{\alpha_i}_{i=0}^k \subset \R$ und $\Set{p_i}_{i=0}^n \subset \R$ gegeben und es gelte
	\begin{enumerate}[i)]
		\item
			$\alpha_0 > 0$ und $\alpha_i < 0$ für $i = 1, \dotsc, k$
		\item
			$\sum_{i=0}^k \alpha_i = 0$,
		\item
			$\sum_{i=0}^k \alpha_i p_i \le 0$.
	\end{enumerate}
	Dann folgt aus $p_0 \ge \max_{i=1,\dotsc, k} p$ die Gleichheit $p_0 = p_1 = \dotsb = p_k$.
	\begin{proof}
		Es gilt
		\[
			\sum_{i=1}^k \alpha_i(p_i-p_0)
			= \sum_{i=0}^k \alpha_i (p_i-p_0)
			= \underbrace{\sum_{i=0}^k \alpha_i p_i}_{\le 0} - \underbrace{p_0 \sum_{i=0}^k \alpha_i}_{=0}
			\le 0.
		\]
		Wegen $p_0 \ge p_i, \alpha_i < 0$ für $i = 1, \dotsc, k$ sind die Summanden links nicht-negativ, also null und es folgt $p_i = p_0$.
	\end{proof}
\end{lem}

\begin{st}[Diskretes Maximumsprinzip] \label{2.16}
	Sei $u_h \in X_h$ eine FD-Lösung zu dem RWP \ref{2.13} mit $f(x) \le 0$ für $x \in \Omega_h$.
	Der Differenzenstern \eqref{eq:2.4} zu $m = 1$ (also ein $3\times 3$ Stern) erfülle in allen Punkten
	\begin{enumerate}[i)]
		\item
			$\sum_{i,j=-1}^1 \alpha_{i,j} = 0$,
		\item
			$\alpha_{0,0} > 0$,
		\item
			$\forall (i,j) \neq (0,0) : \alpha_{i,j} \le 0$,
		\item
			$\alpha_{1,0}, \alpha_{0,1}, \alpha_{0,-1}, \alpha_{-1,0} < 0$, „Koeffizienten in Hauprichtungen negativ“.
	\end{enumerate}
	Dann gilt
	\[
		\max_{x\in\_\Omega_h} u_h(x) = \max_{x\in \Gamma_h} u_h(x).
	\]
\Timestamp{2014-11-04}
	\begin{proof}
		Sei $x \in \_\Omega_h$ mit $u_h(x) = \max_{\_x\in \_\Omega_h} u_h (\_x)$.
		Falls $x \in \Gamma_h$, so sind wir fertig.
		Falls $x \in \Omega_h$: setze $p_0 := u_h(x)$, $(p_i)_{i=1}^k$ als „Nachbarwerte“ von $u_h(x)$, $\alpha_0 := \alpha_{0,0}$, $(\alpha_i)_{i=1}^k$ als Nicht-Null-Koeffizienten des FD-Sterns.
		Es gilt also $\f 1{h^d} \sum_{i=0}^k \alpha_i p_i = \scr L_h u(x) = f(x) \le 0$.
		Das Sternlemma \ref{2.15} hier angewandt ergibt $p_0 = p_1 = \dotsc = p_k$, also $u_h$ konstant in $x$ und seinen Nachbarn, welche im Differenzenstern auftreeten.
		Wiederholung dieses Argumentes in alle $2d$ Hauptrichtungen führt zum Rand (Beschränktheit von $\Omega$)
	\end{proof}
\end{st}

Falls $\Omega_h$ diskret zusammenhängend ist, führt das Argument aus dem Beweis von \ref{2.16} zu allen Punkten in $\Omega_h$, also folgt

\begin{kor}[Lösung $u_h$ konstant] \label{2.17}
	Falls $\_\Omega_h$ diskret zusammenhängend und die FD-Lösung für $f \le 0$ nimmt ihr Maximum im Inneren an, so ist $u_h$ konstant.
\end{kor}

\begin{note}
	\begin{itemize}
		\item
			Obiges diskretes Maximum-Prinzip gilt für $\scr L_h = - \Laplace_h$, weil Voraussetzungen erfüllt sind.
		\item
			Für $\scr L_h$ aus \eqref{eq:2.5} mit $a_{1,2} = 0$, $c = 0$, $b \neq 0$ sind die Voraussetzungen von \ref{2.16} erfüllt, falls $h$ hinreichend klein gewählt wird.
			Aus gleichmäßiger Elliptizität folgt für $z = e_i$
			\[
				0 < \tilde \alpha \underbrace{\|z\|^2}_{= 1} \le z^T A(x) z = a_{ii}(x),
			\]
			also $\alpha_{0,0} = 2(a_{11} + a_{22}) > 0$.
			Falls $|b_i| \le B$ und $h < \f 2B \tilde \alpha$, dann gilt für $\alpha_{1,0}$
			\[
				\alpha_{1,0}
				= -a_{11} + \f h2 b_1
				< -\tilde \alpha + \f 2B \tilde \alpha \f 12 B
				= 0.
			\]
			Analog für $\alpha_{-1,0} = \alpha_{0,-1} = \alpha_{0,1} = 0$.
		\item
			Falls $c(x) > 0$ in \eqref{eq:2.5}, so ist $\sum_{i,j = -1}^1 \alpha_{ij} > 0$.
			Für diesen Fall lassen sich Abschwächungen des Sternlemmas und des Maximumsprinzips formulieren und beweisen.
		\item
			Falls $a_{1,2} \neq 0$, so ist eine Modifikation der Diskretisierung notwendig.
	\end{itemize}
\end{note}

\begin{kor}[Diskretes Vergleichsprinzip] \label{2.18}
	Seien $u_h, v_h \in X_h$ und es gelte $\scr L_h u_h \le \scr L_h v_h$ in $\Omega_h$ und $u_h \le v_h$ auf $\Gamma_h$ und es gelte das diskrete Maximumsprinzip.
	Dann gilt $u_h \le v_h$ in $\_\Omega_h$.
	\begin{proof}
		Für $w_h := u_h - v_h$ gilt $\scr L_h w_h = \scr L_h u_h - \scr L_h v_h \le 0$ in $\Omega_h$ und $w_h \le 0$ auf $\Gamma_h$.
		Mit dem diskreten Maximumsprinzip wird das Maximum auf dem Rand $\Gamma_h$ angenommen und daher $\max_{x\in \_\Omega_h} w_h(x) \le \max_{x\in\Gamma_h}w_h(x) \le 0$, also $u_h \le v_h$ auf $\_\Omega_h$.
	\end{proof}
\end{kor}

\begin{kor}[Existenz und Eindeutigkeit] \label{2.19}
	Sei ein diskretes RWP gemäß \ref{2.13} gegeben und es gelte das Maximumsprinzip.
	Dann existiert eine eindeutige FD-Lösung $u_h \in X_h$.
	\begin{proof}
		\begin{seg}{Eindeutigkeit}
			Seien $u_h, \_u_h \in X_h$ zwei Lösungen, setze $v := u_h - \_u_h$.
			Es gilt
			\begin{align*}
				\scr L_h v &= \scr L_h u_h - \scr L_h \_u_h = f - f = 0 && \text{in $\Omega_h$} \\
				v &= u_h - \_u_h = g - g = 0 && \text{auf $\Gamma_h$}.
			\end{align*}
			Das Maximumsprinzip liefert $v(x) \le \sup_{x\in\Gamma_h} v(x) = 0$ für alle $x \in \_\Omega_h$.
			Analoge Argumentation für $-v$ liefert $-v(x) \le 0$ in $\_\Omega_h$, folglich $v(x) = 0$ in ganz $\_\Omega_h$
		\end{seg}
		\begin{seg}{Existenz}
			Die FD-Diskretisierung führt auf ein $n \times n$ System $A_h \underbar{u}_h = b_h$ mit $\ker A_h = \Set 0$ wegen der Eindeutigkeit.
			Folglich hat $A_h$ vollen Rang und ist regulär, also $\underbar{u}_h := A_h^{-1} b_h$ ist eindeutiger DOF-Vektor von $u_h \in X_h$.
		\end{seg}
	\end{proof}
\end{kor}

\begin{kor}[Stetige Abhängigkeit von Randdaten] \label{2.20}
	Seien $u_h, \_u_h \in X_h$ FD-Lösungen zum RWP \ref{2.13} mit identischem $f$ aber unterschiedlichen Randdaten $g, \_g$ und es gelte das diskrete Maximumsprinzip.
	Dann gilt
	\[
		\|u_h - \_u_h\|_{\Omega_h} = \|g-\_g\|_{\Gamma_h} := \sup_{x\in\Gamma_h} |g(x) - \_g(x)|.
	\]
	\begin{proof}
		Setze $v := u_h - \_u_h$, dann ist $\scr L_h v = 0$ in $\Omega_h$ mit diskretem Maximumsprinzip, also
		\[
			v(x) \le \max_{\_x \in \Gamma_h} v(\_x)
			\le \max_{\_x \in \Gamma_h} |v(\_x)|
			= \|g - \_g\|_{\Gamma_h},
		\]
		analog für $-v(x)$, es folgt die Behauptung.
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Anschauliche Bedeutung: Leichte Änderung in Daten ergibt nur leichte Änderung in Lösung.
			\item
				Ähnlich: Stetige Abhängigkeit bezüglich der rechten Seite $f$.
		\end{itemize}
	\end{note}
\end{kor}

\begin{df}[Stabilität, Konsistenz, Konvergenz] \label{2.21}
	Sei $u \in X := C^2(\Omega) \cap C^0(\_\Omega)$ Lösung des elliptischen RWP \ref{2.10} und $u_h \in X_h$ FD-Approximation aus \ref{2.13}.
	Die FD-Diskretisierung ist
	\begin{enumerate}[i)]
		\item
			\emphdef{konsistenz mit Ordnung $p$}, wenn für ein $C_c = C_c(x)$ unabhängig von $h$ gilt
			\[
				\|\scr L_h u - \scr L u\|_{\Omega_h} \le C_c h^p.
			\]
		\item
			\emphdef{stabil} (genauer: $(X_h^0, Y_h)$-stabil), wenn $C_s$ unabhängig von $h$ existiert, sodass
			\[
				\|v_h\|_{\_\Omega_h} \le C_s \|\scr L_h v_h\|_{\Omega_h}
			\]
			für alle $v_h \in X_h^0$.
		\item
			\emphdef{konvergent mit Ordnung $p$}, wenn für ein $C = C(u)$ unabhängig von $h$ gilt:
			\[
				\|u - u_h\|_{\_\Omega_h} \le C h^p.
			\]
	\end{enumerate}
	\begin{note}[Konsistenz der FD-Approximation]
		\begin{itemize}
			\item
				Punktweise Fehlerschranke aus \ref{2.3}, oder \ref{2.12} besagten $|\scr L_h u(x) - \scr L u(x)| \le C h^2$ mit $C$ unabhängig von $x$.
				Also liegt eine \emphdef{uniforme Schranke in $x$} vor, falls $u \in C^4(\_\Omega)$.
				Mit $C_c := C$ gilt Konsistenz der FD-Approximation mit Ordnung 2 für $\Omega$ Würfelgebiet und Ordnung $1$ für Nicht-Würfelgebiete, z.B. durch die Shortley-Weller-Approximation.
		\end{itemize}
	\end{note}
	\begin{note}[Stabilität]
		\begin{itemize}
			\item
				Stabilität bedeutet anschaulich, dass die Lösung der PDE durch die rechte Seite beschränkt bleibt, unabhängig von $h$.
				Sei $w_h: \Omega_h \to \R$, also $w_h \in Y_h$ und $v_h \in X_h^0$ Lösung von $\scr L_h v_h = w_h$ in $\Omega_h$, $v_h = 0$ auf $\Gamma_h$.
				Dann ist also
				\[
					\|v_h\|_{\_\Omega_h} \le C_s \|\scr L_h v_h\| = C_s \|w_h\|_{\Omega_h}.
				\]
		\end{itemize}
	\end{note}
\end{df}

\begin{st}[Hinreichende Bedingung für Stabilität] \label{2.22}
	Sei $A_h \in \R^{n\times n}$ die FD-System-Matrix.
	Falls $C_s$ unabhängig von $h$ existiert, sodass $\|A_h^{-1}\|_\infty \le C_s$.
	Dann ist das FD-Verfahren stabil.
	\begin{proof}
		Seien $\underbar{v}_h, \underbar{w}_h \in \R^n$ Vektoren der \emph{inneren} Knotenwerte für $v_h \in X_h^0$, $w_h \in Y_h$ und $A_h \underbar{v}_h = \underbar{w}_h$.
		Dann gilt ($v_h$ hat Nullrandwerte)
		\begin{align*}
			\|v_h\|_{\_\Omega_h}
			= \|\underbar{v}_h\|_\infty
			&= \|A_h^{-1} \underbar{w}_h\|_\infty \\
			&\le \|A_h^{-1}\|_\infty \|\underbar{w}_h\|_\infty \\
			&\le C_s \|w_h\|_{\Omega_h}
			= C_s \|\scr L_h v_h\|
		\end{align*}
	\end{proof}
\end{st}

\begin{st}[Stabiltität für Poisson-RWP, FD-Diskretisierung] \label{2.23}
	Sei $\Omega \subset \R^d$ beschränktes Gebiet mit $\Omega \subset B_R(0)$ für ein $R > 0$.
	Dann gilt für alle $v_h \in X_h^0$, dass
	\[
		\|v_h\|_{\_\Omega_h} \le \f {R^2}{2d} \|\Laplace_h v_h\|_{\Omega_h}
	\]
	also das FD-Verfahren stabil mit $C_s := \f {R^2}{2d}$.
	\begin{proof}
		Sei $v_h \in X_h^0$ und $w_h$ aus \ref{2.24}.
		Dann ist für $x \in \Omega_h$
		\[
			- \frac{\Laplace_h v_h(x)}{\|\Laplace_h v_h\|_{\Omega_h}}
			\le \frac{\Laplace_h v_h(x)}{\|\Laplace_h v_h\|_{\Omega_h}}
			\le 1
			= - \Laplace_h w_h(x)
		\]
		Für $x \in \Gamma_h$ gilt $- \frac{v_h(x)}{\|\Laplace_h v_h\|} = 0 = w_h(x)$.
		Also mit diskretem Vergleichsprinzip \ref{2.18} für alle $x \in \Omega_h$
		\[
			\frac{v_h(x)}{\|\Laplace_h v_h\|_{\Omega_h}}
			\le w_h(x)
			\stack{\ref{2.14}}{\le} \f 1{2d} (R^2 - \|x\|^2)
			\le \f {R^2}{2d}.
		\]
		Eine analoge Argumentation für $-v_h$ liefert
		\[
			- \frac{v_h(x)}{\|\Laplace_h v_h\|_{\Omega_h}}
			\le \frac{R^2}{2d},
		\]
		also $\|v_h\|_{\_\Omega_h} \le \f {R^2}{2d} \|\Laplace_h v_h\|_{\Omega_h}$.
	\end{proof}
\end{st}

\begin{lem} \label{2.24}
	Sei $w_h \in X_h$ Lösung von $-\Laplace_h w_h = 1$ in $\Omega_h$, $w_h = 0$ auf $\Gamma_h$.
	Dann gilt
	\begin{equation} \label{eq:2.6}
		0 \le w_h(x) \le \f 1{2d} (R^2 - \|x\|_2^2)
	\end{equation}
	für $x \in \_\Omega_h$.
	\begin{proof}
		Sei $w(x) := \f 1{2d} (R^2 - \|x\|_2^2)$.
		Dann ist $w$ Polynom zweiten Grades, also $\Laplace_h$ exakt für $w$ gemäß Bemerkung nach \ref{2.3}.
		Für $x \in \Omega_h$ gilt somit
		\begin{align*}
			-\Laplace_h w(x)
			= - \Laplace w(x)
			&= - \sum_{i=1}^d \partial_{x_i}^2 \Big(R^2 - \sum_{j=1}^d x_j^2 \Big) \f 1{2d} \\
			&= - \sum_{i=1}^d (-2) \f 1{2d}
			= 1
			= - \Laplace_h w_h(x).
		\end{align*}
		Weiter ist $w \ge 0 = w_h$ auf $\Gamma_h$ nach Wahl von $R$.
		Aus dem diskreten Vergleichsprinzip \ref{2.18} folgt $w \ge w_h$ auf $\_\Omega_h$, also die zweite Gleichung in der Behauptung.
		Die erste Ungleichung folgt aus dem diskreten Maximumsprinzip für $-w_h$:
		\[
			- \Laplace_h (-w_h) =  -1 \le 0
		\]
		für $x \in \Omega_h$, also $\max_{x\in\_\Omega_h} (-w_h(x)) \le \max_{x\in \Gamma_h} (-w_h(x)) = 0$ und damit $w_h \ge 0$ auf $\Omega_h$.
	\end{proof}
\end{lem}

\Timestamp{2014-11-07}

\begin{st}[Konvergenz] \label{2.25}
	Sei ein FD-Verfahren für ein elliptisches RWP gemäß \ref{2.10} gegeben.
	Falls das Verfahren stabil und konsistent mit Ordnung $p$ ist, so auch konvergent mit Ordnung $p$.
	\begin{proof}
		Seien $u \in X$ die exakte und $u_h \in X_h$ die FD-Lösung.
		Dann hat $u - u_h$ Nullrandwerte auf $\Gamma_h$, also folgt mit Stabilität:
		\[
			\|u-u_h\|_{\_\Omega_h}
			\le C_S \| \scr L_h (u-u_h) \|_{\Omega_h}
			= C_s \|\scr L_h u - \scr L_h u_h\|_{\Omega_h}
		\]
		Wegen $(\scr L_h u_h)(x) = f(x) = (\scr L u)(x)$ für alle $x \in \Omega_h$ folgt mit Konsistenz:
		\[
			\|u - u_h\|_{\_\Omega_h}
			\le C_s \|\scr L_h u - \scr L u\|_{\Omega_h}
			\le \underbrace{C_s C_c}_{=:C} h^p.
		\]
	\end{proof}
\end{st}

\ref{2.25} ist auf die FD-Diskretisierung des Poisson-RWPs anwendbar, denn wir haben Konsistenz (siehe Bemerkung nach \ref{2.21}) und Stabilität in \ref{2.23} nachgewiesen.

\begin{kor}[Konvergenz für FD-Diskretisierung, Poisson-RWP] \label{2.26}
	Sei $\Omega \subset \R^d$ beschränktes Gebiet und die Lösung $u$ des Poisson-RWP erfülle $u \in C^4(\_\Omega)$.
	Dann konvergiert das FD-Verfahren, d.h.
	\[
		\|u - u_h\|_{\_\Omega_h}
		\le C h^p
	\]
	mit $p = 2$ für Würfelgebiete und $p = 1$ für allgemeine Gebiete.
\end{kor}

Ein Weg, Stabilität zu zeigen, führt über das diskrete Maximumsprinzip.
Ein alternativer Weg bietet \ref{2.22}:
es genügt $\|A_h^{-1}\|_\infty \le C_s$ für geeignetes $C_s$ unabhängig von $h$ zu zeigen.
Dies ist mit der sogenannten „M-Matrix-Theorie“ möglich.

\begin{df} \label{2.27}
	\begin{enumerate}[i)]
		\item
			Eine Matrix $A = (a_{ij})_{i,j=1}^n \in \R^{n\times n}$ heißt \emphdef{$L_0$-Matrix}, falls $a_{ij} \le 0$ für alle $i \neq j$.
		\item
			Eine Matrix $A = (a_{ij})_{i,j=1}^n \in \R^{n\times n}$ heißt \emphdef{$L$-Matrix}, falls $A$ eine $L_0$-Matrix ist und $a_{ii} > 0$ für $i= 1, \dotsc, n$.
		\item
			Eine $L_0$-Matrix $A$, für die $A^{-1}$ existiert und $A^{-1} \ge 0$ (komponentenweise größergleich Null) heißt \emphdef{M-Matrix}.
	\end{enumerate}
	\begin{note}
		\begin{itemize}
			\item
				Wenn $A^{-1}$ existiert und $A^{-1} \ge 0$, so nennt man $A$ auch \emphdef{inversmonoton}.
			\item
				Eine M-Matrix ist also eine inversmonotone $L_0$-Matrix.
			\item
				Ziel: für gegebene $L_0$- oder $L$-Matrix finde Zusatzbedingungen, welche $M$-Matrix-Eigenschaft implizieren und es erlauben $\|A^{-1}\|_\infty$ abzuschätzen.
		\end{itemize}
	\end{note}
\end{df}

\begin{st}[$M$-Kriterium] \label{2.28}
	Sei $A \in \R^{n\times n}$ ein $L_0$-Matrix.
	\begin{enumerate}[i)]
		\item
			$A$ ist inversmonoton (also $M$-Matrix) genau dann, wenn $e \in \R^n$ existiert mit $e > 0$ und $Ae > 0$.
		\item
			Falls $A$ eine $M$-Matrix und $e$ wie in i), so gilt
			\[
				\|A^{-1}\|_{\infty} \le \frac{\|e\|_\infty}{\min_{k}(Ae)_k}.
			\]
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[i)]
			\item
				\begin{segnb}{\ProofImplication}
					Setze $e := A^{-1} \Vector{1 & \dots & 1}$, dann ist $e > 0$ und $Ae = \Vector{1 & \dots & 1} > 0$.
				\end{segnb}
				\begin{seg}{\ProofImplication*}
					Sei $e > 0$ und $Ae > 0$, d.h. $\sum_{j} a_{ij} e_j > 0$ für alle $i = 1, \dotsc, n$.
					Weil $a_{ij} e_j \le 0$ für $i \neq j$, da $A$ $L_0$-Matrix, muss $a_{ii} e_i > 0$, also $a_{ii} > 0$ und $A$ ist eine $L$-Matrix.
					Setze $D := \diag(a_{11}, \dotsc, a_{nn})$, diese ist offenbar invertierbar.
					Setze $P d= D^{-1}(D-A) = I - D^{-1} A$, also $A = D(I-P)$ und $P \ge 0$ (wegen $D - A \ge 0$ und $D^{-1} \ge 0$).
					Weiter ist $(I-P)e = D^{-1}A e > 0$, also folgt
					\begin{equation} \label{eq:2.7}
						e = Ie > Pe
					\end{equation}
					Führe eine spezielle Norm ein: $\|x\|_e := \max_i \frac{|x_i|}{e_i}$ mit induzierter Matrixnorm $\|P\|_e := \sup_{\|x\|_e = 1} \|Px\|_e$.
					Es gilt $\|e\|_e = \max \frac{|e_i|}{e_i} = 1$, also $\|P\|_e \ge \|Pe\|_e$, andererseits ist für $y \in \R^n$ mit $\|y\|_e = 1$, d.h. $\max_i \frac{|y_i|}{e_i} = 1$ auch $y \le e$ und es folgt wegen $P \ge 0$, dass $Py \le Pe$, also $\|Py\|_e \le \|Pe\|_e$.
					Somit ist
					\[
						\|P\|_e = \sup_{\|x\|_e = 1} \|Px\|_e = \|Pe\|_e = \max_i \frac{(Pe)_i}{e_i}.
					\]
					Wegen \eqref{eq:2.7} ist $Pe < e$ und somit $\|P\|_e < 1$.
					Damit existiert $(I - P)^{-1}$ und es gilt die Darstellung als Neumannsche Reihe:
					\[
						(I - P)^{-1} = \sum_{j=0}^\infty P^j.
					\]
					Wegen $A = D(I-P)$ existiert auch $A^{-1} = (I-P)^{-1}D^{-1}$ und wegen $P \ge 0$ auch $P^j \ge 0$, also mittels Neumannscher Reihe $(I-P)^{-1} \ge 0$, und somit $A^{-1} \ge 0$ inversmonoton.
				\end{seg}
			\item
				Sei $Aw = f$, d.h. $w = A^{-1} f$ und
				\[
					w_i = (A^{-1}f)_i = \sum_{j} (A^{-1})_{ij} f_j \le \|f\|_\infty \sum_{j=1}^n (A^{-1})_{ij}.
				\]
				Also gilt
				\begin{equation} \label{eq:2.8}
					w \le \|f\|_\infty A^{-1} \Vector{1 & \dots & 1}
				\end{equation}
				und analog $-w \le \|f\|_\infty A^{-1} \Vector{1 & \dots & 1}$.
				Es gilt $Ae \ge (\min_k (Ae_k)) \Vector{1 & \dots & 1}$, mit $Ae > 0$ folgt
				\[
					\frac{Ae}{\min_k (Ae)_k} \ge \Vector{1 & \dots & 1}.
				\]
				Also ist mit \eqref{eq:2.8} $\pm w \le \|f\|_\infty A^{-1} \frac{Ae}{\|\min_k (Ae)_k\|} = \|f\|_\infty \frac{c}{\min_k (Ae)_k}$, es folgt $\|w\|_\infty \le \|f\|_\infty \frac{\|e\|_\infty}{\min_k(Ae)_k}$, also
				\[
					\|A^{-1}\|_\infty
					= \sup_{f\neq 0} \frac{\|A^{-1} f\|_\infty}{\|f\|_\infty}
					= \sup_{f \neq 0} \frac{\|w\|_\infty}{\|f\|_\infty}
					\le \frac{\|e\|_\infty}{\min_k (Ae)_k}.
				\]
		\end{enumerate}
	\end{proof}
\end{st}

\begin{ex*}
	Betrachte die FD für das Poisson-RWP, $d = 1$ wie in \ref{2.8}, $h := \f 1{n+1}$, $A_h = \f 1{h^2} \Matrix{2 & -1 &  & \\ -1 & \ddots & \ddots & \\ &\ddots & \ddots & -1 \\ & & -1 & 2} \in \R^{n\times n}$.
	$A_h$ ist eine $L_0$-Matrix.
	Finde $e \in \R^n, e > 0$ und z.B. $A_h e = \Vector{1 & \dots & 1} > 0$.
	Die Lösung ist $e := e_h = (e_k)_{k=1}^n$ mit $e_k = \f 12 k h  (1-kh) = \f 12 kh - \f 12 k^2h^2$.
	Es gilt
	\[
		(A_h e_h)_1 = \frac{1}{h^2} (2e_1 - e_2)
	\]
	mit $e_1 = \f 12 h - \f 12 h^2, e_2 = h - 2h^2$ folgt
	\[
		(A_h e_h)_1 = \f 1{h^2}(h - h^2 - h + 2h^2) = 1
	\]
	und analog $(Ae)_n = 1$ wegen Symmetrie in $A_h$ und $e$.
	Für $1 < k < n$ haben wir
	\begin{align*}
		h^2 (Ae)_k
		&= (-e_{k-1} + 2e_k - e_{k+1}) \\
		&= -\f 12 (k-1)h + \f 12(k-1)^2 h^2 + kh -k^2 h^2 - \f 12 (k+1)h + \f 12 (k+1)^2 h^2 \\
		&= -\f 12 kh + \f 12 h + \f 12(k^2 - 2k + 1)h^2 + kh - k^2h^2 \\
		&\qquad - \f 12 kh - \f 12 h + \f 12 (k^2 + 2k+1)h^2 \\
		&= h^2( \f 12 k^2 - k^2 + \f 12 k^2 - k + \f 12 + k + \f 12) \\
		&= h^2
	\end{align*}
	und damit ist $A_h$ eine $M$-Matrix.

	Es gilt $\|e\|_\infty = \max_k \f 12 kh(1-kh) \le \f 12 \f 12 ( 1 - \f 12) = \f 18$.
	Wegen $Ae = \Vector{1 & \dots & 1}$ ist $\min_k (Ae)_k = 1$ und aus \ref{2.28} ii) folgt
	\[
		\|A_h^{-1}\| \le \frac{\|e\|_\infty}{\min_k (Ae)_k} = \f 18.
	\]
	Vergleich zu $C_S = \frac{R^2}{2d}$ aus \ref{2.23} mit $R = 1, d=1$ liefert $C_s = \f 12$.
	Die Konstante $\f 18$ ist also besser als die in \ref{2.23}.
\end{ex*}

\begin{df}[Diagonaldominanz, Irreduzibilität]
	\begin{enumerate}[i)]
		\item
			$A \in \R^{n\times n}$ ist \emphdef[diagonaldominant!stark]{stark (zeilen-)diagonaldominant}, falls $|a_{ii}| > \sum_{j \neq i}^n |a_{ij}|$ für alle $i = 1, \dotsc, n$.
		\item
			$A \in \R^{n\times n}$ ist \emphdef[diagonaldominant!schwach]{schwach (zeilen-)diagonoldominant}, falls $|a_{ii}| \ge \sum_{j \neq i}^n |a_{ij}|$ für alle $i = 1, \dotsc, n$ mit mindestens einem $k \in \Set{1,\dotsc, n}$ mit $|a_{kk}| > \sum_{j \neq k} |a_{kj}|$.
		\item
			$A$ ist \emphdef{irreduzibel}, falls keine Permutationsmatrix $P$ existiert, sodass
			\[
				P A P^T = \Matrix{ A_{11} & 0 \\ A_{21} & A_{22} }
			\]
			mit $A_{11} \in \R^{p\times p}$ mit $p \in {1, \dotsc, n-1}$.
	\end{enumerate}
\end{df}

\begin{st} \label{2.30}
	Sei $A_h$ eine $L$-Matrix.
	Falls $A_h$ stark diagonaldominant, oder schwach diagonaldominant und irreduzibel, so ist $A_h$ ein $M$-Matrix.
	\begin{proof}
		Siehe Großmann/Roos, Satz 2.8.
	\end{proof}
\end{st}

\begin{note}
	Falls $A_h$ strikt diagonaldominant, so ist $e = \Vector{1 & \dots & 1}$ ein geeigneter Vektor für \ref{2.28}, denn $e > 0$ und $A_h e > 0$.
	Also $\|A_h^{-1}\|_\infty \le \f 1{\min_k(Ae)_k}$ (aber potentiell von $h$ abhängig).
\end{note}

\begin{note}[gemischte Ableitung]
	\begin{itemize}
		\item
			In \ref{2.11} wurde $-\sum_{i\neq j} a_{ij}(x) \partial_{x_i}^{c,h} \partial_{x_j}^{c,h} u(x)$ gewählt, was zu $\f 12 \Matrix[{a_{12} & 0 & -a_{12} \\ 0 & 0 & 0 \\ -a_{12} & 0 & a_{12}}_*$ führte.
			Weder das Maximumsprinzip, noch $M$-Matrix-Eigenschaft können mit unseren Techniken gezeigt werden wegen unterschiedlicher Vorzeichen im Fall $a_{12} \neq 0$.
		\item
			Man kann FD-Sterne 2. Ordnung mit nichtpositiven Eck-Koeffizienten für $-2a_{12} \partial_{x_1} \partial_{x_2} u$ konstruieren:
			\begin{enumerate}[i)]
				\item
					Falls $- a_{12} > 0$:
					\[
						\Matrix[{ a_{12} & -a_{12} & 0 \\ -a_{12} & 2 a_{12} & - a_{12} \\ 0 & - a_{12} & a_{12} }_*
					\]
				\item
					Falls $- a_{12} < 0$:
					\[
						\Matrix[{ 0 & a_{12} & -a_{12} \\ a_{12} & - 2a_{12} & a_{12} \\ - a_{12} & a_{12} & 0}_*
					\]
			\end{enumerate}
			Mit der Konvention $a_{12}^+ := \max\{0, a_{12}\}, a_{12}^- := \min\{a_{12}, 0\}$ folgt für den gesamten FD-Stern
			\begin{equation} \label{eq:2.9}
				\Matrix[{
					a_{12}^- & -(a_{22}-|a_{12}|) & -a_{12}^+ \\
					-(a_{11}-|a_{12}|) & 2(a_{11} + a_{22}-|a_{12}|) & - (a_{11} -|a_{12}|) \\
					-a_{12}^+ & -(a_{22} - |a_{12}|) & a_{12}^-
				}_*
				+ \f h2 \Matrix[{
					0 & b_2 & 0 \\
					-b_1 & 2hc & b_1 \\
					0 & -b_2 & 0
				}_*.
			\end{equation}
			Vergleiche mit dem FD-Stern aus \eqref{eq:2.5}:
			\begin{math}
				\f 12 \Matrix[{ a_{12} & - 2 a_{22} & - a_{12} \\ -2 a_{11} & 4(a_{11} + a_{22}) & -2a_{11} \\ -a_{12} & -2 a_{22} & a_{12}}_*
				+ \f h2 \Matrix[{ 0 & b_2 & 0 \\ -b_1 & 2 h c & b_1 \\ 0 & -b_2 & 0 }_*
			\end{math}
	\end{itemize}
\end{note}

\Timestamp{2014-11-11}

\begin{kor} \label{2.31}
	Falls $a_{ii} > |a_{12}| + \f h2 |b_i|$ und $c > 0$ für $i= 1,2$, so ist die FD-Systemmatrix $A_h$ zum FD-Stern \eqref{eq:2.9} eine $M$-Matrix.
	\begin{proof}
		Der FD-Stern wird in jeweils eine Zeile von $A_h$ geschrieben.
		Wir beobachten:
		\begin{enumerate}[i)]
			\item
				Die Nichtdiagonalelemente von $A_h$ sind nicht-positiv.
			\item
				Die Diagonale von $A_h$ ist echt positiv (also ist $A_h$ eine $L$-Matrix).
			\item
				$A_h$ ist streng diagonaldominant, denn die Summe aller FD-Stern-Einträge ist größer 0.
		\end{enumerate}
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Man kann zeigen, dass $\|A_h^{-1}\|_\infty$ unabhängig von $h$ beschränkt ist.
			\item
				Die Bedingung $a_{ii} > |a_{12}| + \f h2 |b_i|$ liefert eine Bedingung für $h$, d.h. eine hinreichend kleine Gitterweite ist erforderlich für Stabilität im Fall $b \neq 0$.
			\item
				Falls $b_i$ sehr „groß“ (sogenannter \emphdef{konvektionsdominanter Fall}, kann dies zu impraktikablen Gitterweiten führen).
			\item
				Falls $A(x) = 0, c = 0$ (also reine Advektion), $b \neq 0$ kann man leicht analytisch sehen, dass der FD-Vektor mit zentralen Differenzen nicht stabil ist: „\emphdef{hyperbolische Gleichung erster Ordnung}“.

				Betrachte $\Omega = (0,1)^2, b = \Vector{1 & 1}, g(x_1, x_2) = (x_1 - x_2)^2$ mit $\partial_{x_1} u + \partial_{x_2} u = 0$ in $\Omega$ und $u = g$ auf $\Gamma$.
				Dies hat die exakte Lösung $u(x_1, x_2) = (x_1 - x_2)^2 = x_1^2 - 2x_1x_2 + x_2^2$.

				Mit $h = \f 12$ folgt $|\Omega_h| = 1$ wegen $\Omega_h = \Set{(\f 12, \f 12)}$, $|\Gamma_h| = 8$.
				Es ergibt sich ein $1\times 1$-System für $u_h(\f 12, \f 12)$.
				Mit zentralen Differenzen (wie in \eqref{eq:2.5}, \eqref{eq:2.9}) für $\partial_{x_1} u, \partial_{x_2} u$ liefert folgende Gleichung für das LGS:
				\[
					\dfrac{u(\f 12 + \f 12, \f 12) - u_h(\f 12 - \f 12, \f 12)}{2 \cdot \f 12}
					+ \dfrac{u(\f 12, \f 12 + \f 12) - u_h(\f 12, \f 12 - \f 12)}{2 \cdot \f 12}
					= 0.
				\]
				Alle Punktauswertungen liegen in $\Gamma_h$, also setzen wir die Werte für $g$ ein:
				\[
					g(1, \f 12) - g(0, \f 12) + g(\f 12, 1) - g(\f 12, 0) = 0,
				\]
				was zu $0 = 0$ führt, die Systemmatrix $A_h = (0)$ ist singulär, insbesondere ist nicht $\|A_h^{-1}\| \le C_s$ mit $C_s$ unabhängig von $h$, das FD-Verfahren also nicht stabil.
			\item
				Für konvektionsdominante Probleme oder hyperbolische Probleme erster Ordnung sind sorgfältige Diskretisierungen erforderlich (siehe \ref{chap:5}, FV-Verfahren).
		\end{itemize}
	\end{note}
\end{kor}

\begin{ex*}
	Betrachte das Poisson-RWP auf $\Omega = (0,1)^2$.
	\begin{enumerate}[i)]
		\item
			Gebe exakte Lösung vor: $u(x_1, x_2) := x_1(1-x_1)x_2(1-x_2)$.
			Für die Daten wählen wir dann entsprechend: $g(x) := 0 = u(x)$ auf $\Gamma$ und $f(x) := 2x_2(1-x_2) + 2x_1(1-x_1) = -\Laplace u$
			\begin{table}[ht]
				\centering
				\begin{tabular}{l|c|l}
					$h$ & $n$ & $\|u - u_h\|_{\_\Omega_h}$ \\ \hline
					0.5 & 1 & 0 \\
					0.25 & 9 & $6 \cdot 10^{-18}$ \\
					\vdots & \vdots & \vdots \\
					0.03125 & 961 & $4.8 \cdot 10^{-16}$
				\end{tabular}
				\caption{\texttt{elliptic\textunderscore fd\textunderscore demos(4)}}
			\end{table}
			Wir sehen, dass $u_h$ für jedes $h$ exakt ist (bis auf numerische Rundungseffekte).
			Dies deckt sich mit der Beobachtung, dass $-\Laplace_h u = - \Laplace u$ für Polynome vom Grad $\le 3$.
		\item
			Setze als exakte Lösung: $u(x_1, x_2) := \sin(2\pi x_1) \sin(2\pi x_2) \in C^\infty$ für Daten $f(x) := 8\pi^2 \sin(2\pi x_1) \sin(2\pi x_2), g(x) := 0$.
			\begin{table}[ht]
				\centering
				\begin{tabular}{l|cl}
					h & h & $\|u - u_h\|_{\_\Omega_h}$ \\ \hline
					0.25 & 9 & $0.2337$ \\
					0.125 & 49 & $0.053024$ \\
					\vdots & \vdots & \vdots \\
					0.00097656 & 1046529 & $3.1375 \cdot 10^{-6}$
				\end{tabular}
				\caption{\texttt{elliptic\textunderscore fd\textunderscore demos(5)}}
			\end{table}

			Das LGS mit $A \in \R^{10^6 \times 10^6}$ ist sehr schnell lösbar dank sparse-Matrizen.
			Konvergenzordnung $2$ ist erkennbar in Übereinstimmung mit der Theorie.
	\end{enumerate}
\end{ex*}

\begin{note}[Relevanz der FD-Verfahren]
	\begin{itemize}
		\item
			Bis Mitte des 20. Jahrhunderts wurden FD-Diskretisierungen als Allzweckwerkzeug gesehen, weil sie eine Vielzahl von Problemen sehr leicht mit ausreichender Genauigkeit diskretisieren.
			Allmählich kamen FEM-Methoden (Finite-Elemente-Methoden), welche eine wesentlich aufwändigere Assemblierung von $A_h$ und $b_h$ erfordern, aber bei gleicher Gitterfeinheit bessere Ergebnisse liefern.
		\item
			Die Konvergenzanalyse von FD-Verfahren macht häufig starke (unrealistische) Glattheits-Annahmen an die Lösung.
			Das wird bei FEM- und FV-Verfahren etwas abgeschwächt.
	\end{itemize}
\end{note}
