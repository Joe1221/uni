\chapter{Finite Elemente für koerzive und inf-sup-stabile Probleme} \label{chap:3}


\section{Sobolev-Räume} \label{sec:3.1}


\begin{df}[Schwache Ableitung] \label{3.1}
	Sei $\Omega \subset \R^d, u \in L_{\text{loc}}^1(\Omega)$ und $\beta \in \N_0^d$ ein Multiindex.
	Wir nennen $v^\beta \in L_{\text{loc}}^1(\Omega)$ \emphdef{schwache Ableitung} von $u$ falls gilt
	\[
		\int_\Omega u \partial^\beta \phi \di[x]
		= (-1)^{|\beta|} \int_\Omega v^\beta \phi \di[x]
	\]
	für alle $\phi \in C_0^\infty(\Omega)$.
\end{df}

\begin{ex*}
	Sei $\Omega = (-1, 1), u: \Omega \to \R, u(x) := |x|$.
	Dann ist $\sign(x)$ die schwache Ableitung von $u$.
	\begin{proof}
		Denn sei $\phi \in C_0^\infty(\Omega)$, dann ist
		\begin{align*}
			\int_{-1}^1 u(x) \phi'(x) \di[x]
			&= \int_{-1}^0 u(x) \phi'(x) \di[x]
			+ \int_0^1 u(x) \phi'(x) \di[x] \\
			&= \int_{-1}^0 -x \phi'(x) \di[x]
			+ \int_0^1 x \phi'(x) \di[x] \\
			&= - \int_{-1}^0 (-1) \phi(x) \di[x] + \underbrace{[-x \phi(x)]_{-1}^0}_{=0}
			- \int_0^1 \phi(x) \di[x] + \underbrace{[x \phi(x)]_0^1}_{=0} \\
			&= - \int_{-1}^1 \sign(x) \phi(x) \di[x].
		\end{align*}
	\end{proof}
\end{ex*}

\begin{st}[Eindeutigkeit] \label{3.2}
	Sei $u \in L^1_{\text{loc}}(\Omega)$, dann existiert höchstens eine schwache Ableitung zu $\beta \in \N_0^d$.
	\begin{proof}
		Seien $v^\beta, \_v^\beta$ zwei schwache Ableitungen.
		Dann ist
		\[
			(-1)^{|\beta|} \int_\Omega \_v^\beta \phi \di[x]
			= \int_\Omega u \partial^\beta \phi \di[x]
			= (-1)^{|\beta|} \int_\Omega v^\beta \phi \di[x],
		\]
		also für alle $\phi \in C_0^\infty(\Omega)$
		\[
			\int_\Omega (v^\beta - \_v^\beta) \phi \di[x] = 0.
		\]
		Nach dem Fundamentalsatz der Variationsrechnung \ref{1.7} also $v^\beta = \_v^\beta$ fast überall, also $v^\beta = \_v^\beta$ im $L^1_{\text{loc}}$-Sinn.
	\end{proof}
\end{st}

\begin{st}[klassische Ableitung ist schwache Ableitung] \label{3.3}
	Sei $u \in C^m(\Omega)$, $v^\beta \in L^1_{\text{loc}}$ für $|\beta| \le m$ die schwache Ableitung von $u$ und $\partial^\beta u \in C^{m-|\beta|}(\Omega)$ die klassische Ableitung von $u$.
	Dann gilt $v^\beta = \partial^\beta u$ in $L^1_{\text{loc}}$.
	\begin{proof}
		Mit partieller Integration gilt
		\[
			\int_\Omega u \partial^\beta \phi \di[x]
			= (-1)^{|\beta|} \int_\Omega (\partial^\beta u) \phi \di[x]
		\]
		für alle $\phi \in C_0^\infty(\Omega)$ und die klassische Ableitung ist eine schwache Ableitung.
		Wegen der Eindeutigkeit \ref{3.2} ist $\partial^\beta u$ in $L^1_{\text{loc}}$ die schwache Ableitung.
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Der Begriff der schwachen Ableitung umfasst den der klassischen Ableitung, daher schreiben wir im Folgenden einfach $\partial^\beta u$ statt $v^\beta$ für die schwache Ableitung.
			\item
				\ref{3.3} gilt auch auf Teilgebieten, z.B. falls $u$ stückweise klassisch differenzierbar und global schwach differenzierbar, so ist die schwache Ableitung gerade die stückweise klassische Ableitung.
		\end{itemize}
	\end{note}
\end{st}

\begin{ex*}
	$u(x) := \sign(x)$ ist nicht schwach differenzierbar.
	\begin{proof}
		Falls $u$ schwach differenzierbar wäre, so müsste
		\[
			\partial_x u = \begin{cases}
				0 & x < 0 \\
				0 & x > 0
			\end{cases}
		\]
		gemäß der stückweisen klassichen Ableitung.
		Es folgt $(-1)\int_\Omega (\partial_x u) \phi \di[x] = 0$.
		Jedoch ist für $\phi \in C_0^\infty(\Omega), \phi(0) \neq 0$:
		\begin{align*}
			\int_\Omega u \partial_x \phi \di[x]
			&= \int_{-1}^0 (-1) \partial_x \phi \di[x] + \int_0^1 1 \partial_x \phi \di[x] \\
			&= \underbrace{\phi(-1)}_{=0} \underbrace{- \phi(0) - \phi(0)}_{= -2 \phi(0)} + \underbrace{\phi(1) }_{=0}
			\neq 0.
		\end{align*}
	\end{proof}
\end{ex*}

\Timestamp{2014-11-14}

\begin{df}[Sobolev-Räume] \label{3.4}
	Sei $m \in \N_0, p \in \N \cup \Set \infty, u \in L_{\text{loc}}^1(\Omega), \Omega\subset \R^d$ offen.
	Falls alle schwachen Ableitungen $\partial^\beta u, |\beta| \le m$ existieren, definieren wir die \emphdef{Sobolev-Norm} durch
	\begin{align*}
		\|u\|_{H^{m,p}(\Omega)}
		&:= \Big( \sum_{|\beta| \le m} \|\partial^\beta u\|_{L^p(\Omega)}^p \Big)^{\f 1p} \qquad 1 \le p < \infty, \\
		\|u\|_{H^{m,\infty}(\Omega)}
		&:= \max_{|\beta|\le m} \|\partial^\beta u\|_{L^\infty(\Omega)}.
	\end{align*}
	Hiermit definieren wir den \emphdef{Sobolev-Raum} $H^{m,p}(\Omega)$ als
	\[
		H^{m,p}(\Omega)
		:= \Set{ u \in L_{\text{loc}}^1(\Omega) & \|u\|_{H^{m,p}} < \infty}
	\]
	mit der entsprechenden Sobolev-Norm.

	Für $p = 2$ schreiben wir auch $H^m(\Omega) := H^{m,2}(\Omega)$.
	Schließlich definieren wir die \emphdef{Sobolev-Seminorm} durch
	\begin{align*}
		|u|_{H^{m,p}(\Omega)}
		&:= \Big( \sum_{|\beta| = m} \|\partial^\beta u\|_{L^p(\Omega)}^p \Big)^{\f 1p} \qquad 1 \le p < \infty, \\
		|u|_{H^{m,\infty}(\Omega)}
		&:= \max_{|\beta| = m} \|\partial^\beta u\|_{L^\infty(\Omega)}.
	\end{align*}
	\begin{note}
		\begin{itemize}
			\item
				Anstelle von $H^{m,p}(\Omega)$ wird in der Literatur auch oft $W^{m,p}(\Omega)$ verwendet.
			\item
				Aus \ref{3.3} folgt $C_0^m(\Omega) \subset H^{m,p}(\Omega)$.
				Falls $\Omega$ beschränkt, gilt auch $C^m(\_\Omega) \subset H^{m,p}(\_\Omega)$.
		\end{itemize}
	\end{note}
\end{df}

\begin{st}[Vollständigkeit von $H^{m,p}(\Omega)$] \label{3.5}
	Sei $\Omega \subset \R^d$ offen, $1 \le p \le \infty, m \in \N_0$.
	Dann ist $H^{m,p}(\Omega)$ vollständig, also ein Banachraum.

	Weiter ist $H^m(\Omega)$ ein Hilbertraum mit dem entsprechenden Skalarprodukt
	\begin{math}
		\<u,v\>_{H^m} := \sum_{|\beta| \le m} \<\partial^\beta u, \partial^\beta u\>_{L^2(\Omega)}.
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				Dies ist eine sehr praktische Eigenschaft im Gegensatz zu klassischen Funktionenräumen, z.B. ist $C^m(\_\Omega)$ nicht vollständig bezüglich $\|\argdot\|_{H^m,p}(\Omega)$.
				% fixme: gegenbeispiel
			\item
				Für $m = 0$ gilt $H^{m,p}(\Omega) = L^p(\Omega)$.
			\item
				Alternativ kann man Sobolev-Räume auch durch Vervollständigung von $C^m$ bezüglich $\|\argdot\|_{H^{m,p}}$ definieren.
				\[
					H^{m,p}(\Omega) = \_{C^m(\Omega)}^{\|\argdot\|_{H^{m,p}}}.
				\]
				Siehe dazu [Alt, 1.15].
		\end{itemize}
	\end{note}
	\begin{proof}[für $p=2$, allgemeiner in Alt, 1.15]
		Sei $(v_n)_{n\in\N}$ Cauchyfolge in $H^m(\Omega)$.
		Dann ist insbesondere $(\partial^\beta v_n)_{n\in\N}$ Cauchyfolge in $L^2(\Omega)$.
		Wegen Vollständigkeit von $L^2(\Omega)$ existiert $v^\beta \in L^2(\Omega)$ mit $\|\partial^\beta v_n - v^\beta\|_{L^2(\Omega)} \to 0$ für $n \to \infty$.
		Für eine Testfunktion $\phi \in C_0^\infty(\Omega)$ und alle $\beta \in \N_0^d$ gilt mit Cauchy-Schwartz
		\begin{align*}
			\<\partial^\beta v_n - v^\beta, \phi\>_{L^2(\Omega)}
			\le \|\partial^\beta v_n - v^\beta\|_{L^2}\|\phi\|_{L^2}.
		\end{align*}
		Es folgt
		\begin{align*}
			\<v^\beta, \phi\>_{L^2(\Omega)}
			&= \lim_{n\to\infty} \<\partial^\beta v_n, \phi\>_{L^2(\Omega)} \\
			&= \lim_{n\to\infty} (-1)^{|\beta|} \<v_n, \partial^\beta \phi\>_{L^2(\Omega)}
			= (-1)^{|\beta|} \<v^0, \partial^\beta \phi\>_{L^2}
		\end{align*}
		mit $v^0 := \lim_{n\to\infty} v_n$ via $\beta = 0$.
		Damit ist $v^\beta$ schwache Ableitung von $v^0$.
		Also $\|v_n - v^0\|_{H^m(\Omega)} \to 0$ und $v^0 \in H^m(\Omega)$.
	\end{proof}
\end{st}

\begin{st}[Approximierbarkeit durch $C^\infty$-Funktionen] \label{3.6}
	Für $1 \le p < \infty$ ist $H^{m,p}(\Omega) \cap C^\infty(\Omega)$ dicht in $H^{m,p}(\Omega)$, d.h. für $f \in H^{m,p}(\Omega)$ existiert $f_j \in H^{m,p}(\Omega) \cap C^\infty(\Omega), j \in \N$ mit $\|f - f_j\|_{H^{m,p}(\Omega)} \to 0$.
	\begin{proof}
		Siehe [Alt, Satz 1.16].
	\end{proof}
	\begin{note}
		Aufgrund von \ref{3.6} sieht man leicht, dass Regeln zum Umgang mit Ableitungen von klassischen Ableitungen auf schwache Ableitungen übertragen werden können,
		darunter Linearität, partielle Integration, Gaußscher Integralsatz, Produkt- und Kettenregel, etc.
	\end{note}
\end{st}

\begin{note}[Randwerte]
	Da $L^p(\Omega)$-Funktionen auf Nullmengen undefiniert sind, bzw. beliebig abgeändert werden können, ist unklar, was man unter Randwerten in $H^{m,p}(\Omega)$ verstehen soll.
	Tatsächlich hilft zusätzliche Regularität ($m \ge 1$), sogenannte „\emphdef{schwache Randwerte}“ zu definieren, welche mit dem „\emphdef{Spuroperator}“ extrahiert werden können.
\end{note}

\begin{df}[Sobolev-Funktionen mit schwachen Nullrandwerten] \label{3.7}
	Für $1 \le p < \infty$ und $m \in \N$ definieren wir Sobolev-Räume mit (schwachen) Nullrandwerten:
	\[
		H^{m,p}_0(\Omega)
		:= \_{C_0^m(\Omega)}^{\|\argdot\|_{H^{m,p}(\Omega)}}.
	\]
	\begin{note}
		\begin{itemize}
			\item
				$\Omega$ darf auch unbeschränkt sein.
			\item
				In der Literatur findet man auch $W_0^{m,p}(\Omega)$ oder $\mathring H^{m,p}(\Omega)$ als Notationen.
		\end{itemize}
	\end{note}
\end{df}

\begin{st}[Vollständigkeit von $H^{m,p}_0(\Omega)$] \label{3.8}
	Für $1 \le p < \infty, m \in \N$ ist $H^{m,p}_0(\Omega)$ abgeschlossener Unterraum von $H^{m,p}(\Omega)$, insbesondere ein Banachraum und die Sobolev-Norm $\|\argdot\|_{H^{m,p}}$ überträgt sich auf $H_0^{m,p}(\Omega)$.
	\begin{proof}
		Abgeschlossenheit ist klar nach Konstruktion.
		$H^{m,p}_0(\Omega) \subset H^{m,p}(\Omega)$ folgt aus $C_0^m(\Omega) \subset H^{m,p}(\Omega)$ und Abgeschlossenheit von $H^{m,p}(\Omega)$.
	\end{proof}
\end{st}

% fixme
%\begin{note}
%	Es gilt
%	\begin{align*}
%		L^p(\Omega) = H^{0,p}(\Omega) \supset H^{1,p}(\Omega) \supset
%		H_0^{0,p}(\Omega) &\supset H_0^{1,p}(\Omega) &\supset \dots
%		C_0^0(\Omega) &\supset C_0^1(\Omega)
%	\end{align*}
%\end{note}

\begin{df}[Lipschitz-Gebiet]
	Sei $\Omega \subset \R^d$ offen und beschränkt.
	$\Omega$ heißt \emphdef{Lipschitz-Gebiet}, wenn endlich viele offene Mengen $U_i \subset \R^d, i = 1, \dotsc, n$ existieren, sodass
	\begin{enumerate}[i)]
		\item
			$\partial \Omega \subset \bigcup_{i=1}^n U_i$,
		\item
			alle $\Boundary \Omega \cap U_i$ lassen sich (in geeigneten Richtungen) als Graphen Lipschitz-stetiger Funktionen schreiben,
		\item
			$\Omega$ liegt auf einer Seite des Graphen.
	\end{enumerate}
	\begin{note}
		Für Lipschitz-Gebiete gelten insbesondere (siehe [Alt, 5.9]):
		\begin{itemize}
			\item
				Satz von Gauß:
				Sei $v \in (\_\Omega, \R^d) \cap C^1(\Omega, \R)$ mit $\div v \in L^1(\Omega)$, dann gilt
				\[
					\int_\Omega \div v(x) \di[x]
					= \int_{\Boundary \Omega} v(x) \cdot n(x) \di[\sigma(x)].
				\]
			\item
				partielle Integration:
				Für $u \in C^1(\_\Omega), v \in C^1(\_\Omega, \R^d)$ gilt
				\[
					\int_\Omega \Nabla u(x) \cdot v(x) \di[x]
					= - \int_\Omega u(x) \div v(x) \di[x] + \int_{\Boundary \Omega} u(x) v(x) \cdot n(x) \di[\sigma(x)].
				\]
		\end{itemize}
	\end{note}
\end{df}

\begin{st}[Spursatz] \label{3.10}
	Sei $\Omega \subset \R^d$ Lipschitz-Gebiet, $1 \le p < \infty$.
	Dann existiert ein linearer, stetiger \emphdef{Spuroperator} $\gamma: H^{1,p}(\Omega) \to L^p(\Boundary \Omega)$ sodass
	\[
		\gamma(u) = u|_{\Boundary \Omega}
	\]
	für alle $u \in H^{1,p}(\Omega) \cap C^0(\_\Omega)$.

	Insbesondere gilt für $u \in H_0^{1,p}(\Omega)$ dann $\gamma(u) = 0$.
	Wegen Stetigkeit existiert also $C_\gamma > 0$, sodass
	\[
		\|\gamma(u)\|_{L^p(\Boundary \Omega)} \le C_\gamma \|u\|_{H^{1,p}(\Omega)}
	\]
	für alle $u \in H^{1,p}(\Omega)$.
	\begin{proof}
		Für $d = 2, p = 2$ siehe PDEMAS 13/14, allgemeiner in [Alt, 5.7].
	\end{proof}
\end{st}

\begin{df}[Sobolev Dualräume] \label{3.11}
	Für $1 \le p, q \le \infty, \f 1p + \f 1q = 1$ bezeichnen wir $H^{-m,q}(\Omega) := (H_0^{m,p}(\Omega))'$.
	Wir schreiben $H^{-m}(\Omega) := H^{-m, 2}(\Omega)$.
	\begin{note}
		Damit werden wir Differentialgleichungen betrachten können, deren rechte Seite (Quellterm) Funktionale statt Funktionen sind.
	\end{note}
\end{df}

\begin{note}[Stetigkeit für $d = 1$]
	\begin{itemize}
		\item
			Für $\Omega \subset \R$ ist $u \in H^1(\Omega)$ stetig (d.h. es existiert ein stetiger Repräsentant in der Äquivalenzklasse von $u$).
		\item
			Für $d > 1$ ist dies falsch: $H^1(\Omega)$ für $\Omega \subset \R^d$ enthält Funktionen mit Punktsingularitäten, z.b.
			\begin{align*}
				d = 2: \qquad u(x) &:= \log \log(\f 2{|x|}) \in H^1(B_1(0)), \\
				d \ge 3: \qquad u(x) &:= |x|^{-\beta} \in H^1(B_1(0)), \beta < \f{d-2}2.
			\end{align*}
	\end{itemize}
\end{note}

\begin{st}[Poincaré-Friedrich Ungleichung] \label{3.12}
	Sei $\Omega \subset \R^d$ offen und beschränkt, $s := \diam(\Omega)$.
	Dann gilt
	\[
		\|v\|_{L^2(\Omega)} \le s |v|_{H^1(\Omega)}
	\]
	für alle $v \in H_0^1(\Omega)$.
	\begin{proof}
		Weil $C_0^\infty(\Omega)$ dicht in $H_0^1(\Omega)$ genügt es, die Ungleichung für $v \in C_0^\infty(\Omega)$ zu zeigen.
		ObdA sei $\Omega \subset [0,s]^d =: R$.
		Dann ist $v \in C_0^\infty(\Omega)$ durch $0$ fortsetzbar, also $v \in C_0^\infty(R)$.
		\[
			v(x_1, \dotsc, x_d) = \underbrace{v(0, x_2, \dotsc, x_d)}_{=0} +  \int_0^{x_1} \partial_{x_1} v(t, x_2, \dotsc, x_d) \di[t].
		\]
		Mit $x = (x_1, \dotsc, x_d)$ ist
		\begin{align*}
			|v(x)|^2
			&\le \Big(\int_0^{x_1} 1^2 \di[t] \Big) \Big( \int_0^{x_1} |\partial_{x_1} v(t,x_2,\dotsc, x_d)|^2 \di[t] \Big) \\
			&\le s \int_0^s |\partial_{x_1} v(t, x_2, \dotsc, x_d)|^2 \di[t].
		\end{align*}
		Die rechte Seite ist unabhängig von $x_1$, integriere daher bezüglich $x_1$:
		\[
			\int_0^s |v(x)|^2 \di[x_1]
			\le s^2 \int_0^s |\partial_{x_1} v(x)|^2 \di[x_1].
		\]
		Integration über andere Koordinaten liefert
		\[
			\int_R |v(x)|^2 \di[x]
			\le s^2 \int_R (\partial_{x_1} v(x))^2 \di[x]
			\le s^2 |v|_{H^1(\Omega)}.
		\]
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Die Ungleichung gilt bereits, wenn Nullrandwerte nur auf einem Teil des Randes vorliegen.
		\end{itemize}
	\end{note}
\end{st}

\begin{st}[Norm-Äquivalenz auf $H_0^{m}(\Omega)$] \label{3.13}
	Sei $\Omega \subset \R^d$ offen, beschränkt mit $\diam(\Omega) \le s$.
	Dann sind in $H_0^m(\Omega)$ die Norm $\|\argdot\|_{H^m(\Omega)}$ und die Seminorm $|\argdot|_{H^m(\Omega)}$ äquivalent.
	Insbesondere ist die Seminorm $|\argdot|_{H^m(\Omega)}$ eine Norm auf $H_0^m(\Omega)$.
	Genauer gilt
	\[
		|v|_{H^m(\Omega)}
		\le \|v\|_{H^m(\Omega)}
		\le (1 + s)^m |v|_{H^m(\Omega)}
	\]
	für $v \in H_0^m(\Omega)$.
	\begin{proof}
		Siehe Übung.
	\end{proof}
\end{st}


\Timestamp{2014-11-18}

\section{Schwache Lösungen für PDEs} \label{sec:3.2}

Sei das Poisson-Problem mit Nullrandwerten gegeben: $-\Laplace u = f$ in $\Omega$, $u = 0$ auf $\Gamma$.
Sei $u \in C^2(\Omega) \cap C^0(\_\Omega)$ klassische Lösung.
Multiplikation mit Testfunktion $v \in C_0^1(\Omega)$ und Integration ergibt
\begin{align*}
	\int_\Omega f(x) v(x) \di[x] &= - \int_\Omega \Laplace u(x) v(x) \di[x] \\
	&= \int_\Omega \Nabla u(x) \cdot \Nabla v(x) \di[x] - \int_{\Boundary \Omega} (\nabla u(x) \cdot n) \underbrace{v(x)}_{=0} \di[x].
\end{align*}
Also löst die klassische Lösung die „schwache Form“ der PDE
\begin{equation} \label{eq:3.1}
	\int_\Omega \Nabla u(x) \cdot \Nabla v(x) \di[x]
	= \int_\Omega f(x) v(x) \di[x],
	\qquad \forall v \in C_0^1(\Omega).
\end{equation}
\begin{itemize}
	\item
		Die Terme in \eqref{eq:3.1} ergeben Sinn für $u\in C_0^1(\Omega)$ oder $u \in H_0^1(\Omega)$.
		Es liegt nahe, nach „schwachen Lösungen“ zu suchen, d.h. nach Lösungen von \eqref{eq:3.1}.
	\item
		Die klassiche Lösung ist insbesondere eine schwache Lösung.
	\item
		Für allgemeine $f$ (z.B. unstetig) kann es sein, dass keine klassische Lösung existiert, dafür aber eine schwache Lösung $u \in H_0^1(\Omega)$.
	\item
		\eqref{eq:3.1} kann durch die Bilinearform $a(u,v) := \int_\Omega \Nabla u \cdot \Nabla v \di[x]$ und die Linearform $l(v) := \int_\Omega fv \di[x]$ umgeschrieben werden:
		\begin{equation} \label{eq:3.2}
			a(u,v) = l(v) \qquad \forall v \in H_0^1(\Omega).
		\end{equation}
	\item
		Im Folgenden wird Lösungstheorie unter anderem für \eqref{eq:3.2} untersucht als Grundlage für FEM in \ref{sec:3.3}.
	\item
		In diesem Abschnitt seien $V, W$ stets Hilberträume mit Skalarprodukte $\<\argdot, \argdot\>_V, \<\argdot, \argdot\>_W$ und Normen $\|\argdot\|_V, \|\argdot\|_W$.
		Das Subkript wird auch weggelassen, wenn keine Verwechslungsgefahr besteht.
\end{itemize}

\begin{df}[Lineare Operatoren] \label{3.14}
	$A: V \to W$ ist \emphdef{linearer stetiger Operator}, falls $\|A\|_{L(V,W)} := \sup_{v \in V\setminus \Set 0} \f{\|Av\|_W}{\|v\|_V} < \infty$.
	Weiter ist
	\[
		L(V,W) := \Set{A: V \to W & \text{$A$ ist linear und stetig}}
	\]
	der \emphdef{Raum der stetigen Operatoren} mit Norm $\|\argdot\|_{L(V,W)}$.
	\begin{note}
		Also ist $V' = L(V, \R)$, d.h. der Dualraum ist der Raum der stetigen linearen Abbildungen nach $\R$.
	\end{note}
\end{df}

\begin{df}[Adjungierter Operator] \label{3.15}
	Zu $A \in L(V,W)$ definieren wir den (Hilbertraum)-adjungierten Operator $A^*: W \to V$ durch
	\[
		\<Av,w\>_W = \<v,A^*w\>_V
	\]
	für alle $v \in V, w \in W$.
	\begin{note}
		\begin{itemize}
			\item
				Es gilt $A^* \in L(W,V), \|A^*\|_{L(W,V)} = \|A\|_{L(V,W)}$.
			\item
				Falls $A$ invertierbar und $A^{-1}$ stetig, dann ist auch $\|(A^{-1})^*\|_{L(V,W)} = \|A^{-1}\|_{L(W,V)}$ (siehe auch [Alt 10.1]).
		\end{itemize}
	\end{note}
\end{df}

\begin{df}[stetige Bilinearform] \label{3.16}
	Eine Bilinearform $a: V \times W \to \R$ heißt \emphdef{stetig} mit \emphdef{Stetigkeitskonstante} $\gamma \in \R$, wenn
	\[
		\gamma = \sup_{v \in V\setminus \Set 0} \sup_{w \in W \setminus \Set 0} \f{a(v,w)}{\|v\|\|w\|} < \infty.
	\]
	\begin{note}
		\begin{itemize}
			\item
				Also ist das Skalarprodukt $\<\argdot, \argdot\>_V: V \times V \to \R$ stetig mit $\gamma = 1$ wegen Cauchy-Schwartz $\<v, w\>_V \le \|v\|\|w\|$.
		\end{itemize}
	\end{note}
\end{df}

\begin{st}[Projektionssatz] \label{3.17}
	Sei $W \subset V$ abgeschlossener Unterraum.
	Dann existiert genau ein Projektionsoperator $P: V \to W$ mit
	\[
		\<v - Pv, w\> = 0
	\]
	für alle $v \in V, w \in W$.

	$P$ ist ein stetiger, linearer Operator, $P \in L(V,W)$, genannt \emphdef{orthogonale Projektion}.
	\begin{proof}
		siehe PDEMAS 13/14, oder Alt
	\end{proof}
	\begin{note}
		Die Orthogonale Projektion erfüllt die Optimalitätseigenschaft: $\|v - Pv\|^2 = \min_{w\in W} \|v - w\|^2$.
	\end{note}
\end{st}

\begin{st}[Rieszscher Darstellungssatz] \label{3.18}
	Sei $V$ ein Hilbertraum und $J: V \to V'$ definiert durch
	\begin{math}
		(J(v))(w) &:= \<v, w\>_V & \forall v, w \in V.
	\end{math}
	Dann ist $J$ eine stetige, lineare, bijektive Isometrie.

	Insbesondere existiert zu $l \in V'$ ein eindeutiger Riesz-Repräsentant $v_l := J^{-1}(l) \in V$ mit $l(\argdot) = \<v_l, \argdot\>_V$.
	\begin{proof}
		Siehe PDEMAS 13/14 oder Alt.
	\end{proof}
\end{st}

\begin{st}[Repräsentierender Operator] \label{3.19}
	Sei $a: V \times W \to \R$ eine stetige Bilinearform mit Stetigkeitskonstante $\gamma$.
	Dann existiert $A \in L(V,W)$ mit $\|A\|_{L(V,W)} = \gamma$ und
	\begin{equation} \label{eq:3.3}
		\<Av, w\>_W = a(v,w)
	\end{equation}
	für alle $(v,w) \in V \times W$.
	\begin{note}
		Die Umkehrung gilt ebenfalls.
	\end{note}
	\begin{proof}
		Es gilt $a(v, \argdot) \in W'$ für alle $v \in V$, also existiert mit Riesz \ref{3.18} ein $w_v \in W$ mit
		\[
			\<w_v, \argdot\>_W = a(v,\argdot).
		\]
		Definiere $A: V \to W$ durch $Av := w_v$ für alle $v \in V$.
		Dann ist \eqref{eq:3.3} klar.
		Linearität von $A$ folgt aus Linearität von $a(v,\argdot)$ bezüglich dem ersten Argument.
		Betracht die Stetigkeit, es gilt
		\[
			\|Av\|_W^2
			= \<Av, Av\>_W
			= \<w_v, Av\>
			= a(v, Av)
			\le \gamma \|v\| \|Av\|,
		\]
		also $\f{\|Av\|}{\|v\|} \le \gamma$ und insbesondere $\|A\| = \sup_{v \neq 0} \f{\|Av\|}{\|v\|} \le \gamma < \infty$.
		Angenommen $\|A\| < \gamma$.
		Dann existiert $v \neq 0, w \neq 0$ mit $\f{a(v,w)}{\|v\|\|w\|} \in (\|A\|, \gamma)$.
		Es folgt
		\[
			\|A\|\|v\|\|w\|
			\ge \<Av, w\>
			= a(v,w)
			> \|A\|\|v\|w\|,
		\]
		ein Widerspruch, also $\|A\| = \gamma$.
	\end{proof}
\end{st}

\begin{df}[Koerzivität] \label{3.20}
	Eine Bilinearform $a: V \times V  \to \R$ heißt \emphdef{koerziv} mit \emphdef{Koerzivitätskonstante} $\alpha$, wenn
	\[
		\alpha := \inf_{v \in V \setminus \Set 0} \f{a(v,v)}{\|v\|^2} > 0.
	\]
	\begin{note}
		\begin{itemize}
			\item
				Also ist das Skalarprodukt koerziv mit $\alpha = 1$:
				\[
					\inf_{v \neq 0} \f{\<v,v\>}{\|v\|^2}
					= \inf_{v \neq 0} 1
					= 1 > 0.
				\]
			\item
				Eine Bilinearform ist koerziv genau dann, wenn der symmetrische Anteil $a_S(V,W)$ koerziv ist:
				\[
					a_S(V,W) := \f 12 (a(v,w) + a(w,v)),
				\]
				denn $a(u,u) = a_S(u,u)$.
			\item
				$\gamma$ und $\alpha$ lassen sich durch geeignete Eigenwertprobleme/Singulärwertprobleme berechnen (siehe Übung).
			\item
				Es gilt stets $\alpha \le \gamma$.
		\end{itemize}
	\end{note}
\end{df}

\begin{df}[Bilinearform/Linearform für PDEs zweiter Ordnung] \label{3.21}
	Sei $\Omega \subset \R^d$ beschränkt und das Null-RWP für eine PDE zweiter Ordnung gegeben, d.h.
	\begin{math}
		-\Nabla \cdot (A \Nabla u) + \Nabla \cdot (b u) + c u &= f && \text{in $\Omega$}, \\
		u &= 0 && \text{auf $\Gamma$},
	\end{math}
	wobei $A = (a_{ij})_{ij=1}^d \in (L^\infty(\Omega))^{d\times d}, b = (b_i)_{i=1}^d \in (L^\infty(\Omega))^d, c \in L^\infty(\Omega), f \in L^2(\Omega)$.

	Dann definieren wir die Bilinearform und Linearform
	\begin{math}[numbered] \label{eq:3.4}
		% a(u,v) &:= \int_\Omega (Au)^T v + (b\nabla v) u + cuv
		a(u,v) &:= \int_\Omega (A \Nabla u) \cdot \Nabla v - (b \cdot \Nabla v) u + c u v \di[x], \\
		l(v) &:= \int_\Omega f v \di[x]
	\end{math}
	für $u, v \in H^1(\Omega)$.
\end{df}

\begin{st}[Stetigkeit und Koerzivität, $b=0$, $c = 0$] \label{3.22}
	Sei $b = 0, c = 0$, $A$ gleichmäßig elliptisch, d.h. für ein $\tilde \alpha > 0$ gilt $z^T A(x) z \ge \tilde \alpha \|z\|^2$ für alle $x \in \Omega, z \in \R^d$ und $A$ gleichmäßig beschränkt, d.h. für $C > 0$ (und beliebiger Matrixnorm) gilt $\|A(x)\| \le C$ für alle $x \in \Omega$.

	Dann ist die Bilinearform $a(\argdot, \argdot)$ aus \ref{3.21} stetig auf $H^1(\Omega)$ und koerziv auf $H_0^1(\Omega)$.
	\begin{proof}
		\begin{math}
			a(u,v)
			&= \int_\Omega (A \Nabla u) \cdot \Nabla v \di[x] \\
			&\le \int_\Omega \underbrace{\|A(x) \Nabla u(x)\|}_{\le \|A\| \|\Nabla u\| \le C \|\Nabla u\|} \|\Nabla v(x)\| \di[x] \\
			&\le C \int_\Omega \|\Nabla u\| \|\Nabla v\| \di[x] \\
			&\le C \Big( \int_\Omega \|\Nabla u\|^2 \Big)^{\f 12} \Big(\int_\Omega \|\Nabla v\|^2 \Big)^{\f 12} \\
			&\le C \sqrt{\int_\Omega \|\Nabla u\|^2 + \|u\|^2} \sqrt{\int_\Omega \|\nabla v\|^2 + \|v\|^2} \\
			&= C \|u\|_{H^1} \|v\|_{H^1},
		\end{math}
		also ist $a(\argdot, \argdot)$ stetig auf $H^1(\Omega) \times H^1(\Omega)$.
		Da $A$ ohne Einschränkung symmetrisch und gleichmäßig elliptisch:
		\begin{align*}
			a(u,u) &= \int_\Omega (A \Nabla u)^T \Nabla u \di[x]
			= \int_\Omega (\Nabla u)^T A \nabla u \di[x] \\
			&\ge \int_\Omega \tilde \alpha \|\Nabla u\|^2
			= \tilde \alpha |u|_{H^1(\Omega)}^2
			\intertext{
				für $u \in H_0^1(\Omega)$ folgt mit Normäquivalenz \ref{3.13}
			}
			&\ge \f {\tilde \alpha}{(1+s)^2} \|u\|_{H^1}^2
		\end{align*}
		mit $\diam(\Omega) \le s$.
		Es folgt
		\[
			\alpha := \inf_{u \neq 0} \frac{a(u,u)}{\|u\|_{H^1}^2}
			\ge \f{\tilde \alpha}{(1+s)^2} \frac{\|u\|_{H^1}^2}{\|u\|_{H_1}^2}
			>0,
		\]
		also ist $a(\argdot, \argdot)$ koerziv auf $H_0^1(\Omega)$.
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				$a(\argdot, \argdot)$ ist nicht koerziv auf $H^1(\Omega)$:
				Wähle $u \in H^1(\Omega)$ konstant $u = k \neq 0$, dann ist
				\[
					\f{a(u,u)}{\|u\|_{H^1(\Omega)}^2}
					= \f{0}{\|u\|_{H^1(\Omega)}^2}
					= 0.
				\]
			\item
				$a(\argdot, \argdot)$ ist stetig auf $H_0^1(\Omega)$, Stetigkeit vererbt sich auf Teilräume:
				\begin{align*}
					\sup_{u \in H_0^1(\Omega)} \sup_{v \in H_0^1(\Omega)} \f{a(u,v)}{\|u\|\|v\|}
					\le \sup_{u \in H^1(\Omega)} \sup_{v \in H^1(\Omega)} \f{a(u,v)}{\|u\|\|v\|}
					= \gamma < \infty
				\end{align*}
			\item
				$a(\argdot, \argdot)$ ist koerziv auf Teilräumen von $H_0^1(\Omega)$.
				Koerzivität vererbt sich auf Teilräume:
				Sei $W \subset H_0^1$, dann gilt
				\[
					\inf_{u \in W} \f{a(u,u)}{\|u\|^2}
					\ge \inf_{u \in H_0^1(\Omega)} \f{a(u,u)}{\|u\|^2}
					= \alpha
					> 0.
				\]
			\item
				Falls $A$ symmetrisch (ist ohne Einschränkung stets der Fall), so ist $a(\argdot, \argdot)$ symmetrische Bilinearform.
			\item
				Ähnliche Aussage wie \ref{3.22} gilt falls $b \neq 0$ und $c > 0$ hinreichend groß.
		\end{itemize}
	\end{note}
\end{st}

\begin{note}[Stetigkeit von $l$]
	\begin{itemize}
		\item
			$l(\argdot)$ aus \eqref{eq:3.4} ist offensichtlich linear, $l: H^1 \to \R$.
		\item
			Ist $f \in L^2(\Omega)$, dann ist
			\[
				l(v) = \int_\Omega fv \di[x]
				= \<f, v \>_{L^2}
				\le \|f\|_{L^2} \|v\|_{L^2}
				\le \|f\|_{H^1}\|v\|_{H^1},
			\]
			also ist $l(\argdot)$ stetig auf $H^1$ und $H_0^1(\Omega)$.
		\item
			Falls $v \in H_0^1(\Omega)$, sind sogar manche $f \not\in L^2(\Omega)$ erlaubt, solange $l \in H^{-1}(\Omega)$.
	\end{itemize}
\end{note}

\Timestamp{2014-11-21}

\begin{df}[Energie-Skalarprodukt] \label{3.23}
	Sei $a$ eine stetige Bilinearform und koerziv.
	Dann bildet der symmetrische Anteil ein Skalarprodukt, das sogenannte \emphdef{Energieskalarprodukt}
	\[
		\<u,v\>_a :=  \f 12\big(a(u,v) + a(v,u)\big).
	\]
	\begin{proof}
		Bilinearität und Symmetrie sind offensichtlich.
		Positivität folgt aus Koerzivität:
		Für $u \neq 0$ gilt
		\[
			\<u,u\>_a
			= \f 12 (a(u,u) + a(u,u))
			= a(u,u)
			\ge \underbrace{\alpha}_{>0} \|u\|^2
			> 0.
		\]
	\end{proof}
	\begin{note}
		Es ergibt sich hiermit die für Fehleranalyse nützliche \emphdef{Energienorm} $\|u\|_a := \sqrt{\<u,u\>_a}$.
	\end{note}
\end{df}

\begin{df}[Schwache Lösung] \label{3.24}
	Seien $a(\argdot, \argdot), l(\argdot)$ wie in \eqref{eq:3.4}.
	Wir nennen $u \in H_0^1(\Omega)$ \emphdef{schwache Lösung} des RWP, falls
	\begin{equation} \label{eq:3.5}
		a(u,v) = l(v)
	\end{equation}
	für alle $v \in H_0^1$.
\end{df}

\begin{st} \label{3.25}
	Sei $u \in C^2(\Omega) \cap C^0(\_\Omega)$ klassische Lösung des RWP und $f \in C^0$.
	Dann ist $u$ auch schwache Lösung.
	\begin{proof}
		Wie zu Beginn des Abschnitts:
		Multiplizieren mit Testfunktion, Integration, partielle Integration.
	\end{proof}
\end{st}

\begin{st}[Wohlgestelltes schwaches Poisson-RWP] \label{3.26}
	Betrachte \eqref{eq:3.5} für $A(x) = I, c(x) = 0, b(x) = 0$, also
	\begin{align*}
		a(u,v) &= \int_\Omega \nabla u \cdot \nabla v \di[x], &
		l(v) &= \int_\Omega f v \di[x].
	\end{align*}
	Dann existiert für $f \in L^2(\Omega)$ eine eindeutige schwache Lösung $u \in H_0^1(\Omega)$, beschränkt durch die rechte Seite:
	\[
		\|u\|_{H^1(\Omega)} \le \f 1{\alpha} \|f\|_{L^2}.
	\]
	\begin{note}
		Dies ist eine Stabilitätsaussage, daher nennt man $\alpha$ auch \emphdef{Stabilitätskonstante}.
	\end{note}
	\begin{proof}
		$A(x)$ ist gleichmäßig elliptisch mit Elliptizitätskonstante $\tilde \alpha = 1$ und gleichmäßig beschränkt.
		Nach \ref{3.22} ist $a(u,v)$ koerziv und stetig auf $H_0^1(\Omega)$ mit Koerzivitätskonstante $\alpha = \f 1{(1+s)^2}$.
		Da $a(\argdot, \argdot)$ auch symmetrisch, ist $a(\argdot, \argdot)$ ein Energieskalarprodukt und
		\[
			a(u,u)
			= \<u,u\>_a
			= \int_\Omega \nabla u \cdot \nabla u \di[x]
			= |u|_{H^1(\Omega)}^2.
		\]
		Mit der Normäquivalenz \ref{3.13} gilt
		\begin{equation} \label{eq:3.6}
			\|v\|_{H^1(\Omega)}
			\le (1+s) |v|_{H^1(\Omega)}
		\end{equation}
		für alle $v \in H_0^1$.
		Also ist $(H_0^1(\Omega), \|\argdot\|_{H^1})$ ein Hilbertraum genau dann, wenn $(H_0^1(\Omega), |\argdot|_{H^1})$ Hilbertraum ist.
		Nach Riesz existiert eine (bijektive) Isometrie $J: H_0^1 \to (H_0^1)' = H^{-1}$ bezüglich $|\argdot|_{H^1}$.
		Mit $f \in L^2(\Omega)$ ist $l \in H^{-1}$ also mit \ref{3.18} $u := J^{-1} l$ ein Element mit
		\[
			a(u,v)
			= \<u,v\>_a
			= \int_\Omega \nabla u \cdot \nabla v \di[x]
			= \<J^{-1}l, v\>_a
			= l(v)
		\]
		und wegen Isometrie
		\begin{equation} \label{eq:3.7}
			|u|_{H^1} = \|l\|_{H^{-1}}
			= \sup_{v} \f{l(v)}{|v|_{H^1}}.
		\end{equation}
		Für die $H^1$-Norm folgt dann
		\begin{align*}
			\|u\|_{H^1}
			&\stack{\eqref{3.6}}\le (1+s)|u|_{H^1} \\
			&\stack{\eqref{3.7}}= (1+s) \sup_v \f{l(v)}{|v|_{H^1}} \\
			&\stack{\eqref{3.6}}\le (1+s) \sup_{v} \f{l(v)}{\|v\|_{H^1} \f 1{(1+s)}}
			= (1+s)^2 \sup_v \f{l(v)}{\|v\|_{H^1}}
			= \f 1{\alpha} \|l\|_{H^{-1}}.
		\end{align*}
	\end{proof}
\end{st}

\begin{note}
	\begin{itemize}
		\item
			Die „schwache Form“ für $-\Laplace u$ ist also $a: H_0^1 \to H^{-1}, u \mapsto a(u,\argdot), u \in H_0^1$.
		\item
			Die Riesz-Abbildung $J^{-1}$ (bezüglich des Energieskalarproduktes) ist also der Lösungsoperator für das Poisson-RWP.
		\item
			Analoge Argumentation liefert Wohlgestelltheit für das RWP \ref{3.24} mit $A(x)$ symmetrisch, gleichmäßig elliptisch und gleichmäßig beschränkt, $b = 0$, $c \ge 0$.
			Dann ist $a(\argdot, \argdot)$ wieder ein Skalarprodukt, also das Energieskalarprodukt.
	\end{itemize}
\end{note}

\begin{kor}[Stetige Abhängigkeit von Daten] \label{3.27}
	Für eine PDE in schwacher Form mit $a(\argdot, \argdot)$ bilinear, $l \in V'$, $a(u,v) = l(v)$ für $v \in V$ existiere für alle $l \in V'$ eine eindeutige Lösung $u \in V$ mit Schranke $\|u\|_{V} \le \f 1{\alpha} \|l\|_{V'}$.

	Dann ist $u$ stetig von der rechten Seite abhängig, d.h. für jede Lösung $\_u$ zu den Daten $\_l \in V'$ gilt
	\[
		\|u-\_u\|_{V} \le \f 1{\alpha} \|l - \_l\|_{V'}.
	\]
	\begin{proof}
		$w := u - \_u$ löst $a(u,v) = l(v) - \_l(v)$.
		Die Behauptung folgt aus der Annahme.
	\end{proof}
\end{kor}

\begin{st}[Schwache Form als Minimierungsproblem] \label{3.28}
	Sei $a: V \times V \to \R$ bilinear, stetig, koerziv und symmetrisch.
	Dann ist die schwache Form \eqref{eq:3.5} äquivalent zu einem Minimierungsproblem, d.h.
	\begin{math}
		& & &\text{$u$ löst $a(u,v) = l(v)$ für alle $v \in V$} \\
		&\iff&
		&\text{$u = \argmin_{v\in V} \big( \f 12 a(v,v) - l(v)$} \big).
	\end{math}
	\begin{proof}
		Siehe Übung.
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Für nichtsymmetrisches $a(\argdot, \argdot)$ existiert keine solche Aussage.
			\item
				Mit diesem Satz wird nocheinmal klar, dass Vollständigkeit von $V$ essentiell für die Existenz einer Lösung ist:
				Über $C_0^1$ wird das Funktional im Allgemeinen kein Minimum annehmen, obwohl Minimalfolgen existieren.
		\end{itemize}
	\end{note}
\end{st}

\begin{note}
	Allgemeine koerzive Probleme (z.B. nicht-symmetrische) erlauben eine Wohlgestellheitsaussage mit „Satz von Lax-Milgram“.
	Wir überspringen diesen hier, weil er aus dem allgemeineren Nečas-Theorem folgt.
\end{note}

\begin{note}[Verallgemeinerte Randbedingungen]
	\begin{enumerate}[i)]
		\item
			Inhomogenes Dirichlet-RWP:
			\begin{math}[numbered] \label{eq:3.8}
				-\Laplace u &= f && \text{in $\Omega$}, \\
				u &= g && \text{auf $\Gamma$}.
			\end{math}
			Sei $g$ derart, dass $\_g \in C^2(\Omega) \cap C^0(\_\Omega)$ existiert mit $\_g = g$ auf $\Gamma$.
			Dann gilt
			\begin{math}
				&\text{$u$ löst \eqref{eq:3.8}} &
				&\iff &
				&\text{$\_u := u - \_g$ löst \eqref{eq:3.9}},
			\end{math}
			wobei
			\begin{math}[numbered] \label{eq:3.9}
				-\Laplace \_u &= - \Laplace (u - \_g) = f - \Laplace \_g && \text{in $\Omega$}, \\
				\_u &= 0 && \text{auf $\Gamma$}.
			\end{math}
			Löse also das homogene Problem für $\_u$ und es folgt, dass $u := \_u + \_g$ das ursprüngliche RWP löst.
			Insbesondere folgt Existenz und Eindeuktigkeit schwacher Lösungen für inhomogene Dirichlet-RWP.
		\item
			Gemischte Dirichlet- und Neumann-Bedingungen:
			Sei $\Gamma = \Gamma_N \cup \Gamma_D$, betrachte
			\begin{math}
				-\Laplace u &= f && \text{in $\Omega$}, \\
				u &= 0 && \text{auf $\Gamma_D$}, \\
				\nabla u \cdot n &= g_N && \text{auf $\Gamma_N$}.
			\end{math}
			Der Lösungs-/Testraum ist
			\[
				V := H_{\Gamma_D}^1
				:= \Set{v \in H^1 & v|_{\Gamma_D} = 0},
			\]
			also $H_0^1(\Omega) \subset H_{\Gamma_D}^1(\Omega) \subset H^1(\Omega)$.
			Multipliziere mit Testfunktion, integriere und nutze partielle Integration:
			\begin{align*}
				\int_\Omega fv
				&= \int_\Omega \nabla u \cdot \nabla v - \int_{\Boundary \Omega} (\nabla u \cdot n) v \\
				&= \int_\Omega \nabla u \cdot \nabla v - \int_{\Gamma_D} (\nabla u \cdot n) \underbrace{v}_{=0} - \int_{\Gamma_N} \underbrace{(\nabla u \cdot n) v}_{= g_N}.
			\end{align*}
			Damit ist die schwache Form durch
			\[
				\int_\Omega \nabla u \cdot \nabla v
				= \int_\Omega fv + \int_{\Gamma_N} g_Nv
			\]
			gegeben.
			Dirichlet-Randbedingungen werden also in die Konstruktion von $V$ eingebaut („wesentliche“, oder „essentielle“ Randbedingungen).
			Neumann-Randebedingungen werden über Zusatzterme in die schwache Form eingebaut („natürliche Randbedingungen“).
	\end{enumerate}
\end{note}

Unter welchen Bedingungen ist $u \in H^m(\Omega), m > 1$, oder gar $u \in C^\infty(\Omega)$?
Dies führt auf die sogenannte \emphdef{Regularitätstheorie}.

\begin{df}[$H^s(\Omega)$-Regularität] \label{3.29}
	Sei $H_0^1(\Omega) \subset V \subset H^1(\Omega)$.
	Eine PDE in schwacher Form
	\[
		a(u,v) = \<f, v\>_{L^2(\Omega)},
		\qquad \forall v \in V
	\]
	mit $a(\argdot, \argdot)$ bilinear, stetig und koerziv auf $V$ heißt \emphdef{$H^s$-regulär}, wenn es eine Konstante $C_R \ge 0$ sodass zu jedem $f \in H^{s-2}(\Omega)$ eine Lösung $u \in H^s(\Omega)$ existiert mit
	\[
		\|u\|_{H^s}
		\le C_R \|f\|_{H^{s-2}(\Omega)}.
	\]
\end{df}

\begin{ex*}
	\begin{itemize}
		\item
			Sei $d = 2$, $\Omega = \Set{ x \in \R^2 & 1 \le \|x\| \le 2 }$.
			$u(x) = \ln(\|x\|)$ ist klassische Lösung des inhomogonen RWP
			\begin{equation*}
				\begin{aligned}
					-\Laplace u &= 0 & \ &\text{in $\Omega$}, \\
					u &= 0 & \ &\text{auf $\Boundary B_1(0)$}, \\
					u &= \ln 2 & \ &\text{auf $\Boundary B_2(0)$}
				\end{aligned}
			\end{equation*}
			Es gilt $u \in C^\infty(\_\Omega)$.
			Mit \ref{3.25}, \ref{3.26} (genauer: die analogen Aussagen für inhomogene RWP) folgt, dass $u$ eindeutige schwache Lösung ist, insbesondere $u \in H^m(\Omega), m \in \N$ wegen Beschränktheit von $\Omega$ also alle $\partial^\beta u \in L^2(\Omega)$.
			Das Problem ist damit $H^s(\Omega)$-regulär für alle $s \in \N$.
		\item
			Sei $\alpha \in (0,2), \Omega := \Set{ x = \Vector{r \cos \phi & r \sin \phi} & r \in (0,1), \phi \in (0,\alpha\pi) }$.
			\begin{math}
				u(x) &= \|x\|^{\f 1\alpha} \sin(\f {\phi(x)}{\alpha}), &
				\phi(x) &= \arctan \f{x_2}{x_1}
			\end{math}
			ist klassische Lösung von
			\begin{math}
				-\Laplace u &= 0 && \text{in $\Omega$}, \\
				u &= \sin(\frac{\phi(x)}{\alpha}) && \text{auf $\Gamma_2$}, \\
				u &= 0 && \text{auf $\Gamma_1 \cup \Gamma_3$}.
			\end{math}
			Für $\alpha \le 1$ ist $u \in H^2(\Omega)$, für $\alpha > 1$ ist $u \not\in H^2(\Omega)$.

			Regulärität häng also von der Geometrie ab.
	\end{itemize}
\end{ex*}

\begin{st}[Satz von Friedrich] \label{3.30}
	Sei $\Omega \subset \R^d$ offen, beschränkt mit glattem Rand (mindestens $C^2$) oder ein konvexes Lipschitzgebiet, $f \in L^2(\Omega)$.
	Dann ist das Poisson-Problem $H^2(\Omega)$-regulär.
	\begin{proof}
		Für glatte Gebiete z.B. in [Alt, 10.17, 10.18].
	\end{proof}
	\begin{note}
		Verallgemeinerung:
		Falls $f \in H^{s-2}(\Omega)$, $\Omega$ hat einen $C^s$-Rand, dann ist $u \in H^s(\Omega)$.
	\end{note}
\end{st}

\begin{df}[Inf-sup-Stabilität] \label{3.31}
	Eine stetige Bilinearform $a: V \times W \to \R$ heißt \emphdef{inf-sup stabil} mit inf-sup-Konstante $\beta$, falls
	\[
		\beta := \inf_{v \in V \setminus \Set 0} \sup_{w \in W \setminus \Set 0} \f{a(v,w)}{\|v\|\|w\|} > 0.
	\]
\end{df}

\begin{st}[Charakterisierung von inf-sup-Stabilität] \label{3.32}
	Sei $a: V \times W \to \R$ stetige, inf-sup stabile Bilinearform mit inf-sup Konstante $\beta$ und $A: V \to W$ repräsentierender Operator gemäß \ref{3.19}.
	Dann gilt
	\begin{enumerate}[i)]
		\item
			$A$ ist \emphdef{suprimierender Operator}:
			\[
				\sup_{w \in W\setminus \Set 0} \f{a(v,w)}{\|w\|}
				= \f{a(v,Av)}{\|Av\|}
			\]
			für alle $v \in V \setminus \Set 0$.
		\item
			$\beta = \inf_{v \neq 0} \f {a(v,Av)}{\|v\| \|Av\|} = \inf_{v \neq 0} \f{\|Av\|}{\|v\|}$.
		\item
			$A$ ist injektiv, d.h. $\forall v \neq 0 : Av \neq 0$.
		\item
			$\forall v \in V \setminus \Set 0 \exists w \in W \setminus \Set 0 : \beta \|v\|\|w\| \le a(v,w)$.
	\end{enumerate}
\Timestamp{2014-11-25}
	\begin{note}
		Analog zu ii) gilt für die Stetigkeitskonstante $\gamma = \sup_{v \in V \setminus \Set 0} \f{\|Av\|}{\|v\|}$.
	\end{note}
	\begin{proof}
		\begin{enumerate}[i)]
			\item
				$\ge$ ist klar wegen Supremum, zeige $\le$.
				Sei $w \in W, v \in V, w \neq 0 \neq v$.
				Dann ist
				\begin{math}
					\f {a(v,w)}{\|w\|}
					= \f{\<Av, w\>}{\|w\|}
					\le \f{\|Av\|\|w\|}{\|w\|}
					= \f{\|Av\|\|Av\|}{\|Av\|}
					= \f{\<Av, Av\>}{\|Av\|}
					= \f{a(v,Av)}{\|Av\|}.
				\end{math}
				Gleiches gilt für $\sup_{w\in W\setminus \Set 0} \f{a(v,w)}{\|w\|} = \f {a(v,Av)}{\|Av\|}$.
			\item
				\begin{math}
					\beta
					= \inf_{v\neq 0} \sup_{w\neq 0} \f{a(v,w)}{\|v\|\|w\|}
					\stack{i)}= \inf_{v\neq 0} \f{a(v,Av)}{\|v\|\|Av\|}
					= \inf_{v\neq 0} \f{\<Av,Av\>}{\|v\|\|Av\|}.
				\end{math}
			\item
				Angenommen $A$ ist nicht injektiv, d.h. $\exists v \in V \setminus \Set 0$ mit $Av = 0$.
				Dann ist
				\begin{math}
					0
					= \<Av, w\>
					= a(v,w)
					\ge \beta \|v\|\|w\|
					> 0
				\end{math}
				für alle $w \in W \setminus \Set 0$.
				Ein Widerspruch, also ist $A$ injektiv.
			\item
				nach ii) gilt $\beta = \inf_{v\in V \setminus \Set 0} \f{a(v,Av)}{\|v\|\|Av\|}$, also für alle $v \in V \setminus \Set 0$:
				\begin{math}
					\beta \|v\|\|Av\| \le a(v,Av),
				\end{math}
				also $w = Av \neq 0$.
		\end{enumerate}
	\end{proof}
\end{st}

\begin{st}[Beziehung von $\alpha$ und $\beta$] \label{3.33}
	Sei $a: V \times V \to \R$ stetig, bilinear.
	Falls $a$ koerziv mit Konstante $\alpha$, dann ist $a$ inf-sup-stabil mit Konstante $\beta$ sodass $\beta \ge \alpha$.
	\begin{proof}
		\begin{math}
			\beta
			= \inf_{v\neq 0} \sup_{w\neq 0} \f{a(v,w)}{\|v\|\|w\|}
			\ge \inf \f{a(v,v)}{\|v\|^2}
			= \alpha
			> 0.
		\end{math}
	\end{proof}
\end{st}

\begin{note}
	\begin{itemize}
		\item
			Man kann zeigen:
			Falls $a(\argdot, \argdot)$ koerziv, symmetrisch, dann ist $a$ inf-sup-stabil mit $\beta = \alpha$.
			\begin{proof}
				Siehe IANS Report 4/2011, B. Haasdonk.
			\end{proof}
		\item
			$\beta$ ist immer die „bessere“ Konstante, da $\beta \ge \alpha$.
			Es ergeben sich schärfere Beschränktheitsaussagen für schwache Lösungen von PDEs.
		\item
			inf-sup-Stabilität überträgt sich nicht auf Teilräume (siehe Übung).
			Dies macht Schwierigkeiten für FEM-Diskretisierungen.
	\end{itemize}
\end{note}

\begin{st} \label{3.34}
	Sei $a: V \times W \to \R$ stetige Bilinearform mit zugehörigem Operator $A: V \to W$ gemäß \ref{3.19}.
	Dann sind äquivalent
	\begin{enumerate}[i)]
		\item
			$a(v,w)$ erfüllt $\inf_{v\neq 0} \sup_{w\neq 0} \frac{a(v,w)}{\|v\|\|w\|} \ge \beta$ und für alle $w \in W \setminus \Set 0$ existiert ein $v \in V$ sodass $a(v,w) \neq 0$.
		\item
			$A$ ist invertierbar mit stetiger Inversen
			\begin{math}
				\|A^{-1}\|_{L(W,V)} \le \frac{1}{\beta}.
			\end{math}
	\end{enumerate}
	\begin{proof}
		\begin{seg}{\ProofImplication[1][2]}
			Zeige, dass $A$ bijektiv ist.
			$A$ ist bereits injektiv nach \ref{3.32} ii).
			Zeige, dass $\im A$ vollständig ist und nutze den Projektionssatz für die Surjektivität.

			Sei $w_n = Av_n$ eine Cauchy-Folge in $\im(A)$.
			$W$ ist vollständig, also existiert $w \in W$ mit $\lim_{n\to \infty} w_n = w$.
			Es verbleibt $w \in \im A$ zu zeigen.
			Mit der inf-sup-Eigenschaft \ref{3.32} ii) folgt
			\begin{math}
				\beta &= \inf_{v\neq 0} \frac{\|Av\|}{\|v\|}
				&&\implies&
				\forall v \in V: \beta \|v\| \le \|Av\|,
			\end{math}
			also
			\begin{math}
				\beta \|v_n - v_m\| \le A(v_n - v_m)\|
				= \|w_n - w_m\|
				\to 0
			\end{math}
			für $n,m \to \infty$.
			Somit ist $v_n$ Cauchy-Folge in $V$ und es existiert $v \in V$ mit $v = \lim_{n\to \infty} v_n$.
			Stetigkeit von $A$ ergibt
			\begin{math}
				Av
				= \lim_{n\to\infty} Av_n
				= \lim_{n\to\infty} w_n
				= w
			\end{math}
			und somit $w \in \im A$ und $\im A$ abgeschlossen.

			Nun zur Surjektivität.
			Angenommen $\_w \in W$ mit $\_w \not \in \im A$.
			Sei $p: W \to \im A$ orthogonale Projektion gemäß \ref{3.17}, d.h. $\_{\_w} = \_w - P\_w \neq 0$ und $\<\_{\_w}, Av\> = 0$ für alle $w \in \im A$.
			Also für alle $v \in V$
			\begin{math}
				0
				= \<\_{\_w}, Av\>
				= \<Av, \_{\_w}\>
				= a(v,\_{\_w}),
			\end{math}
			ein Widerspruch zur zweiten Annahme in i).
			Somit ist $A$ surjektiv.

			Da $A$ bijektiv, existiert die Inverse $A^{-1}$ und für $v \in V$ folgt mit $\beta \|v\| \le \|Av\|$ auch $\beta \|A^{-1}w\| \le \|w\|$.
			Selbiges gilt für das Supremum
			\begin{math}
				\|A^{-1}\|
				= \sup_{w \in W \setminus \Set 0}  \f{\|A^{-1}\|\|w\|}{\|w\|}
				\le \f 1{\beta}.
			\end{math}
		\end{seg}
		\begin{seg}{\ProofImplication[2][1]}
			Es gilt
			\setcounter{equation}{10}
			\begin{math}[numbered] \label{eq:3.11}
				\inf_{v\neq 0} \sup_{w\neq 0} \frac{a(v,w)}{\|v\|\|w\|}
				&\stackrel{\ref{3.32} ii)}= \inf_{v\neq 0} \frac{\|Av\|}{\|v\|}
				= \inf_{w\neq  0} \frac{\|w\|}{\|A^{-1}w\|} \\
				&= \frac{1}{\sup_{w\neq 0} \frac{\|A^{-1}w\|}{\|w\|}}
				= \frac{1}{\|A^{-1}\|}
				\ge \frac{1}{\frac{1}{\beta}}
				= \beta
			\end{math}
			Sei $w \in W \setminus \Set 0$, $\exists v \in V \setminus \Set 0$ mit $w = Av$, dann ist
			\begin{math}
				a(v,w)
				= \<Av,w\>
				= \<Av,Av\>
				= \|Av\|^2
				> 0.
			\end{math}
		\end{seg}
	\end{proof}
\end{st}

\begin{note}[Nicht-Koerzivität für Advektion]
	\begin{itemize}
		\item
			Falls in \eqref{eq:3.4} $A = 0, c = 0$ (oder $A \neq 0, c \neq 0$ und $b$ hinreichend groß), dann ist $a(v,w)$ im Allgemeinen nicht koerziv auf $H_0^1(\Omega)$.
		\item
			Sei $\Omega = [0,1], b = 1, A = c = 0$.
			\begin{math}
				a(v,w)
				= \int_0^1 v \partial_x w \di[x].
			\end{math}
			Betrachte
			\begin{math}
				u(x) &= \sin(2\pi x) \in L^2(\Omega), \\
				\partial_x u(x) &= 2\pi \cos(2\pi x) \in L^2(\Omega), \\
				u(0) = u(1) &= 0.
			\end{math}
			Dann ist $u \in H_0^1(\Omega)$, insbesondere $\|u\|_{H^1(\Omega)} \neq 0$, aber
			\begin{math}
				\inf_{v\neq 0} \frac{a(v,v)}{\|v\|^2}
				\le \frac{a(u,u)}{\|v\|^2}
				= \frac{\int_0^1 u \partial_x u \di[x]}{\|u\|^2}
				= 0.
			\end{math}
			Somit ist $a$ nicht positiv und insbesondere nicht koerziv.
		\item
			Knobelaufgabe:
			Ist $a(\argdot, \argdot)$ inf-sup-stabil auf $H_0^1(\Omega)$?
		\item
			Durch geeignete Wahl von Räumen kann obiges $a$ als inf-sup-stabil nachgewiesen werden mit folgendem Hilfssatz \ref{3.35}.
	\end{itemize}
\end{note}

\begin{st}[Lösbarkeit der Divergenzgleichung] \label{3.35}
	Sei $\Omega$ ein Lipschitzgebiet, $q \in L_0^2(\Omega) = \Set{ p \in L^2(\Omega) & \int_\Omega p = 0 }$.
	Dann existiert $\tilde v \in H_0^1(\Omega)^d$ so dass $\div \tilde v = q$ und es gilt
	\begin{math}[numbered] \label{eq:3.12}
		|\tilde v|_{H^1(\Omega)^d}
		\le C(\Omega) \|q\|_{L^2(\Omega)}.
	\end{math}
	\begin{proof}
		Für $d = 1$ siehe Übung.
		Allgemeiner siehe Babuska und Aziz 1972, “Survey Lectures on the mathematical foundations of the FEM” in “The Mathematical Foundations of the FEM with applications to PDEs”.
	\end{proof}
\end{st}

\begin{kor}[Inf-sup-Stabilität des Divergenzoperators] \label{3.36}
	Sei $\Omega$ ein Lipschitzgebiet und beschränkt.
	Für ein $q \in Q := L_0^2(\Omega)$ und $v \in V = H_0^1(\Omega)^d$.
	Setze $b(q,v) := \int_\Omega q \div v \di[x]$.

	Dann ist $b$ inf-sup-stabil auf $Q \times V$.
	\begin{proof}
		Sei $q \in Q$ und $\tilde v \in V$ aus \ref{3.35}, d.h. $q = \div \tilde v$.
		\begin{math}
			b(q,\tilde v)
			= \int_\Omega q \div \tilde v \di[x]
			= \int_\Omega q^2
			= \|q\|^2_{L^2(\Omega)}.
		\end{math}
		Wegen \eqref{eq:3.12} und der Normäquivalenz aus \ref{3.13} folgt
		\begin{math}
			\|\tilde v\|_{H^1(\Omega)^d}
			\le (1+s) |\tilde v|_{H^1(\Omega)^d}
			\le (1+s) C(\Omega) \|q\|_{L^2(\Omega)}.
		\end{math}
		Betrachte
		\begin{math}
			\inf_{q} \sup_{v} \frac{b(q,v)}{\|q\|\|v\|}
			\ge \inf_{q} \frac{b(q,\tilde v)}{\|q\|\|\tilde v\|}
			= \inf_{q} \frac{\|q\|_{L^2(\Omega)}^2}{C'(\Omega) \|q\|\|q\|}
			= \frac{1}{C'(\Omega)}
			> 0
		\end{math}
		wobei $C'(\Omega) = (1 + s) C(\Omega)$.
	\end{proof}
\end{kor}

\begin{note}
	\begin{itemize}
		\item
			Die Notation $b, Q, V$ (statt $a, V, W$) ist üblich für das Stokes-Problem
		\item
			Der folgende Satz garantiert Wohlgestelltheit für lineare PDEs mit inf-sup-stabiler Bilinearform.
	\end{itemize}
\end{note}

\begin{st}[Nečas Theorem] \label{3.37}
	Sei $a: V \times W \to \R$ stetige Bilinearform, $l \in W'$.
	Dann hat die Gleichung
	\begin{math}[numbered] \label{eq:3.13}
		a(u,w) = l(w)
	\end{math}
	für alle $w \in W$ eine eindeutige Lösung $u \in V$ und ist stetig abhängig von den Daten via
	\begin{math}[numbered] \label{eq:3.14}
		\|u\|_V
		\le \frac{1}{\beta}\|l\|_{W'}
	\end{math}
	für ein $\beta > 0$ unabhängig von $l$ genau dann, wenn eine der folgenden äquivalenten Bedingungen erfüllt ist.
	\begin{enumerate}[i)]
		\item
			$a$ erfüllt $\inf_{v} \sup_{w} \frac{a(v,w)}{\|v\|\|w\|} \ge \beta > 0$ und $\forall w \in W \setminus \Set 0 \exists v \in V: a(v,w) \neq 0$.
		\item
			$a$ erfüllt $\inf_{w} \sup_{v} \frac{a(v,w)}{\|v\|\|w\|} \ge \beta > 0$ und $\forall v \in V \setminus \Set 0 \exists w \in W: a(v,w) \neq 0$.
	\end{enumerate}
	\begin{proof}
		Es gilt $\<Au,w\> = a(u,w) = l(w) = \<w_l, w\>$ genau dann, wenn $Au = w_l$, wobei $w_l$ der Riesz-Repräsentant von $l$ ist.
		Wir führen den Beweis mit Hilfe von \ref{3.34}.
		\begin{seg}{i) $\implies$ \eqref{eq:3.13}, \eqref{eq:3.14}}
			Mittels \ref{3.34} ist $A$ invertierbar und $\|A^{-1}\| \le \f 1\beta$.
			$u := A^{-1} w_l$ ist die eindeutige Lösung von \eqref{eq:3.13}.
			Weiter ist
			\begin{math}
				\|u\|_V
				\le \|A^{-1}w\|
				\le \|A^{-1}\|_{L(W,V)} \underbrace{\|w_l\|_{W}}_{\|l\|_{W'}}
				\le \frac{1}{\beta}\|L\|_{W'}.
			\end{math}
		\end{seg}
		\begin{seg}{\eqref{eq:3.13}, \eqref{eq:3.14} $\implies$ i)}
			\eqref{eq:3.13} hat eine eindeutige Lösung für alle $l \in w'$, also existiert $u \in V$ mit $Au = w_l$ für alle $l \in W'$ und $A$ invertierbar.
			Es gilt
			\begin{math}
				\|A^{-1} w_l\|
				\stack{\eqref{3.14}}\le \frac{1}{\beta}\|w_l\|,
			\end{math}
			also $\|A^{-1}\| \le \frac{1}{\beta}$.
			Aus \ref{3.34} folgt die Bedingung i).
		\end{seg}
		\begin{seg}{ii) $\implies$ \eqref{eq:3.13}, \eqref{eq:3.14}}
			Hier betrachten wir $A^*: W \to V$.
			\eqref{eq:3.11} aus dem Beweis von \ref{3.34} besagte für $a$ inf-sup-stabil:
			\begin{math}
				\inf_{v\neq 0} \sup_{w\neq 0} \frac{a(v,w)}{\|v\|\|w\|}
				= \|A^{-1}\|^{-1}.
			\end{math}
			Falls ii) gilt, so folgt analog mit der Existenz von $A^*$
			\begin{math}
				\beta \le \inf_{w\neq 0} \sup_{v\neq 0} \frac{a(v,w)}{\|v\|\|w\|}
				= \inf_{w\neq 0} \sup_{v\neq 0}  \frac{\<Av, w\>}{\|v\|\|w\|}
				= \inf_{w\neq 0} \sup_{v\neq 0}  \frac{\<v, A^*w\>}{\|v\|\|w\|}.
			\end{math}
			Damit ist $A^*$ invertierbar mit $\|(A^*)^{-1}\| \le \frac{1}{\beta}$.
			Es folgt
			\begin{math}[numbered] \label{eq:3.15}
				= \inf_{w\neq 0} \sup_{v\neq 0}  \frac{\<A^*,w\>}{\|v\|\|w\|}.
				= \|(A^*)^{-1}\|^{-1}.
			\end{math}
			$A^*$ invertierbar, stetig und $A$ stetig, also auch $A$ invertierbar, $\|A\| = \|A^*\|, \|A^{-1}\| = \|(A^*)^{-1}\|$.
			Es existiert ein eindeutiges $u = A^{-1} w_l$ als Lösung von \eqref{eq:3.13}.
			\eqref{3.14} folgt durch Einsetzen.
		\end{seg}
		\begin{seg}{\eqref{eq:3.13}, \eqref{eq:3.14} $\implies$ ii)}
			Analog zum Fall i) kann man zeigen, dass $A$ invertierbar ist $\|A^{-1}\| \le \frac{1}{\beta}$.
			Es folgt, dass $A^*$ invertierbar ist mit $\|(A^*)^{-1}\| \le \frac{1}{\beta}$.
			Mit \eqref{eq:3.15} folgt ii).
		\end{seg}
	\end{proof}
\Timestamp{2014-11-28}
	\begin{note}
		\begin{itemize}
			\item
				Der Satz besagt, dass inf-sup-Stabilität der „allgemeinste“ Stabilitätsbegriff für Wohlgestelltheit eines Problems der Form \eqref{eq:3.13} ist.
			\item
				Für koerzive, aber möglicherwiese unsymmetrische Bilinearform im Fall $V = W$ folgt Existenz, Eindeutigkeit und Stabilität als Korollar.
		\end{itemize}
	\end{note}
\end{st}

\begin{kor}[Lax-Milgram] \label{3.38}
	Sei $a: V \times V \to \R$ stetige, koerzive Bilinearform mit Koerzivitätskonstante $\alpha > 0$.
	Dann hat der Operator $A \in L(V,V)$ mit $\<Au, v\> = a(u,v)$ aus \ref{3.19} eine stetige Inverse mit
	\begin{math}
		\|A^{-1}\| \le \frac{1}{\alpha}
	\end{math}
	\begin{proof}
		Mit \ref{3.33} ist $a(\argdot, \argdot)$ also inf-sup-stabil mit $\beta \ge \alpha > 0$.
		Aus dem Beweis von \ref{3.37} folgt
		\begin{math}
			\alpha
			\le \inf_{v} \sup_{w} \frac{a(v,w)}{\|v\|\|w\|}
			= \|A^{-1}\|^{-1}
		\end{math}
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Mit \ref{3.37} folgt insbesondere Wohlgestelltheit
				\begin{math}[numbered] \label{eq:3.16}
					\inf_{v\neq 0} \sup_{w \neq 0} \frac{a(v,w)}{\|v\|\|w\|}
					= \beta
					= \inf_{w\neq 0} \sup_{v\neq 0} \frac{a(v,w)}{\|v\|\|w\|},
				\end{math}
				also selbes $\beta$ für beide inf-sup-Bedingungen.
			\item
				Die Umgekehrte Richtung in \eqref{eq:3.16} gilt auch:
				\begin{math}
					\inf_{w\neq 0} \sup_{v\neq 0} \frac{a(v,w)}{\|v\|\|w\|}
					&& \implies &&
					\forall w \neq 0 \exists v: a(v,w) \neq 0.
				\end{math}
				Dies zusammen mit der analogen anderen Seite ist gerade Bedingung ii) aus \ref{3.37}, also äquivalent zur Wohlgestelltheit.
			\item
				\ref{3.37} ii) impliziert, dass auch das sogenannte \emphdef[duales Problem]{duale Problem} zu $f \in V'$:
				\begin{math}[numbered] \label{eq:3.17}
					a(v,w) = f(v) && \forall v \in V
				\end{math}
				eine eindeutige Lösung $w \in W$ besitzt mit $\|w\| \le \frac{1}{\beta} \|f\|_{V'}$.
		\end{itemize}
	\end{note}
\end{kor}

\begin{kor}[Wohlgestelltheit für allgemeine elliptische RWP] \label{3.39}
	Sei ein homogenes Dirichlet-RWP für allgemeine PDE zweiter Ordnung in schwacher Form gegeben wie in \ref{3.21}, d.h.
	\begin{math}
		a(u,v) &= \int_\Omega (A \Nabla u) \cdot \Nabla v - (b \cdot \Nabla v) u + c uv \di[x] \\
		l(v) &= \int_\Omega fv \di[x]
	\end{math}
	für $u,v \in H_0^1(\Omega)$.

	Sei $A$ gleichmäßig elliptisch, $A, b, c$ gleichmäßig beschränkt, $c \ge 0$ hinreichend groß, sodass $a(\argdot, \argdot)$ koerziv auf $H_0^1(\Omega)$ mit Koerzivitätskonstante $\alpha > 0$ ist.

	Dann existiert für alle $f \in L^2(\Omega)$ eine eindeutige schwache Lösung $u \in H_0^1(\Omega)$ mit $a(u,v) = l(v)$ für alle $v \in H_0^1(\Omega)$ und diese ist beschränkt durch
	\begin{math}
		\|u\|_{H^1(\Omega)}
		\le \frac{1}{\alpha}\|f\|_{H^{-1}(\Omega)}
	\end{math}
	\begin{proof}
		Analog zu \ref{3.22} sieht man Stetigkeit und Koerzivität von $a$.
		Nach Lax-Milgram \ref{3.38} ist $A$ invertierbar mit $\|A^{-1}\| \le \frac{1}{\alpha}$, also ist $u := A^{-1} v_L$ eindeutige Lösung mit
		\begin{math}
			\|u\|
			\le \|A^{-1}\|\|v_L\|
			\le \frac{1}{\alpha} \|l\|_{H^{-1}(\Omega)}.
		\end{math}
	\end{proof}
\end{kor}

\begin{df}[Sattelpunktproblem] \label{3.40}
	Seien $V, Q$ Hilberträume, $a: V \times V \to \R$, $b: Q \times V \to \R$ stetige Bilinearformen, $f \in V', g \in Q'$.
	Gesucht ist die Lösung $(u,p) \in V \times Q$, welche erfüllt:
	\begin{math}[numbered] \label{eq:3.18}
		a(u,v) + b(p,v) &= f(v) &&\forall v \in V,\\
		b(q,u) &= g(q) && \forall q \in Q.
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				\eqref{eq:3.18} kann auch in bisheriger Form geschrieben werden:
				\begin{math}
					\_a(\_u,\_v) = \_l(\_v) && \forall \_v \in \_V
				\end{math}
				mit $\_u = (u,p) \in \_V := V \times Q$, $\_v = (v,q)$ und
				\begin{math}
					\_a(\_u,\_v)
					&:= a(u,v) + b(p,v) + b(q,u), \\
					\_l(\_v)
					&:= f(v) + g(q).
				\end{math}
				Die inf-sup-Stabilität von $\_a$ ist schwer zu zeigen.
				Daher untersuchen wir das Sattelpunktproblem in der Formulierung \eqref{eq:3.18}.
				Dann folgt inf-sup-Stabilität von $\_a$ aus der Wohlgestelltheit von \eqref{eq:3.18} (Nečas-Theorem).
			\item
				Falls $a$ koerziv und symmetrisch, ist $u \in V$ eindeutiger Minimierer des bedingten Optimierungsproblem
				\begin{math}
					\min_{v\in V} \frac{1}{2} a(v,v) - f(v)
					&\udN&
					b(\argdot, u) = g(\argdot) \text{ in $Q$}.
				\end{math}
				Hier ist $p$ der Lagrange-Multiplikator der Nebenbedingung und $(u,p)$ eindeutiger Sattelpunkt der Lagrange-Funktion
				\begin{math}
					L(v,q)
					= \frac{1}{2} a(v,v) - f(v) + b(q,v) - g(q),
				\end{math}
				mit $v \in V, q\in Q$.
			\item
				Man kann das Stokes-Problem
				\begin{math}
					-\mu \Laplace u + \Nabla p &= r && \text{in $\Omega$} \\
					\div u &= 0 && \text{in $\Omega$} \\
					u &= 0 && \text{auf $\Gamma$}
				\end{math}
				in schwacher Form als Sattelpunktproblem schreiben.
		\end{itemize}
	\end{note}
\end{df}

\begin{st}[Stokes-Sattelpunktproblem] \label{3.41}
	Sei $\Omega \subset \R^d$ offen und beschränktes Lipschitz-Gebiet, $r \in (L^2(\Omega))^d$, $\mu > 0$.
	Wähle $V := (H_0^1(\Omega))^d, Q := \Set{q \in L^2(\Omega) & \int_\Omega q \di[x] = 0}$ und definiere $a: V \times V \to \R, b \in Q \times V \to \R$ und $f \in V', g \in Q'$ durch
	\begin{math}
		a(v,w) &:= \mu \int_\Omega \Nabla u : \Nabla w \di[x], &
		f(v) &:= \int_\Omega rv \di[x], \\
		b(q,v) &:= -\int_\Omega q \div(v) \di[x], &
		g(q) &:= 0,
	\end{math}
	wobei $\Nabla v : \Nabla w := \sum_{i=1}^d \Nabla v_i \cdot \Nabla w_i$ für $v = (v_i)_{i=1}^d, w= (w_i)_{i=1}^d$.

	Dann ist $a(\argdot, \argdot$ stetig, symmetrisch und koreziv, $f, g$ stetig und $b(\argdot, \argdot)$ stetig und inf-sup-stabil.
	\begin{proof}
		Stetigkeit und Koerzivität von $a$ wie im elliptischen Fall in \ref{3.22} wegen $\mu > 0$.
		Stetigkeit von $g$ trivial, von $f$ folgt wie im elliptischen Fall (siehe Bemerkung vor \ref{3.23}).
		Stetigkeit von $b$ folgt mit Cauchy-Schwartz und Normäquivalenz auf $\R^d$:
		\begin{math}
			|b(q,v)|
			&\le \|q\|_{L^2} \|\div v\|_{L^2} \\
			\|\div v\|_{L^2}
			&\le \sum_{i=1}^d \|\partial_{x_i} v_i\|_{L^2} \\
			&\le \underbrace{\sum_{i=1}^d \|v_i\|_{H^1}}_{=\|(\|v_i\|_{H^1})_{i=1}^d\|_1}
			\le C \Big(\sum_{i=1}^d \|v_i\|_{H^1}^2\Big)^{\frac{1}{2}}
			= C \|v\|_{(H^1(\Omega))^d}.
		\end{math}
		Die inf-sup-Stabilität von $b(\argdot, \argdot)$ wurde in \ref{3.36} gezeigt.
	\end{proof}
\end{st}

\begin{st}[Orthogonales Komplement] \label{3.42}
	Sei $V_0 \subset V$ abgeschlossener Teilraum eines Hilbertraums.
	Dann existiert das \emphdef{orthogonale Komplement}
	\[
		V_\orth
		:= \Set{ v \in V & \forall v_0 \in V_0 : \<v,v_0\> = 0 }
	\]
	mit $V = V_0 \oplus V_\orth$ und $V_\orth$ ist abgeschlossener, linearer Teilraum, also Hilbertraum.
	\begin{proof}
		$V_\orth$ linearer Teilraum ist klar.
		Für die direkte Summe sei $v \in V_0 \cap V_\orth$, dann ist $\<v,v\> = 0$, d.h. $v = 0$, also $V_0 \cap V_\orth = \Set 0$.
		%fixme:
		Für die Abgeschlossenheit sei $(v_i)_{i\in\N}$ Cauchy-Folge in $V_\orth$.
		Da $V$ vollständig, existiert $\_v := \lim_{i\to\infty} v_i \in V$.
		Sei $v_0 \in V_0$, dann ist
		\begin{math}
			\<\_v, v_0\>
			= \<\lim_{i\to\infty} v_i, v_0\>
			= \lim_{i\to\infty} \<v_i, v_0\>
			= 0
		\end{math}
		und somit $\_v \in V_\orth$.
	\end{proof}
\end{st}

\begin{st}[Brezzi-Theorem, Existenz und Eindeutigkeit des SPP] \label{3.43}
	Das SPP \eqref{eq:3.18} besitzt für alle $f \in V', g \in Q'$ eine eindeutige Lösung $(u,p) \in V \times Q$ und diese ist beschränkt durch die Daten, d.h. es existiert $\beta > 0$ mit
	\begin{math}[numbered] \label{eq:3.19}
		(\|u\|_V^2 + \|p\|_Q^2)^{\frac{1}{2}}
		\le \frac{1}{\beta} (\|f\|_{V'}^2 + \|g\|_{Q'}^2)^{\frac{1}{2}}
	\end{math}
	genau dann, wenn Konstanten $\beta_a, \beta_b$ existieren, sodass
	\begin{math}[numbered] \label{eq:3.20}
		\inf_{v\in V_0} \sup_{w \in V_0} \frac{a(v,w)}{\|v\|\|w\|}
		= \inf_{w\in V_0} \sup_{v\in V_0} \frac{a(v,w)}{\|v\|\|w\|}
		= \beta_a > 0
	\end{math}
	und
	\begin{math}[numbered] \label{eq:3.21}
		\inf_{q\in Q} \sup_{v \in V} \frac{b(q,v)}{\|q\|\|v\|}
		= \beta_b > 0,
	\end{math}
	wobei $V_0 := \Set{v \in V & \forall q \in Q : b(q,v) = 0}$.
\Timestamp{2014-12-02}
	\begin{proof}[angelehnt an K. Siebert, NUMPDE 12/13]
		\begin{seg}[\ProofImplication*]
			$b(\argdot, \argdot)$ ist stetig, also $V_0$ abgeschlossener Unterraum, also existiert mit \ref{3.42} ein orthogonales Komplement $V_\orth$ mit $v = V_0 \oplus V_\orth$.
			Für $v \in V$ sei $v = v_0 + v_\orth$ mit $v_0 \in V_0, v_\orth \in V_\orth$.

			Wegen $b(q,v) = b(q,v_0) + b(q,v_\orth) = b(q,v_\orth)$ folgt aus \eqref{eq:3.21}, dass
			\begin{math}
				\beta_b
				= \inf_{q\in Q} \sup_{v\in V} \frac{b(q,v)}{\|q\|\|v\|}
				= \inf_{q\in Q} \sup_{v\in V_\orth} \frac{b(q,v)}{\|q\|\|v\|}.
			\end{math}
			Nach Definition von $v_0$ gilt $\forall v \in V_\orth \exists q \in Q: b(q,v) \neq 0$.
			Also sind für $b(\argdot, \argdot)$ die Bedingungen des Nečas-Theorems \ref{3.37} ii) erfüllt, daher existiert für alle $g \in Q'$ eine eindeutige Lösung $u_\orth \in V_\orth$ von
			\begin{math}
				b(q,v_\orth) &= g(q) & \forall q \in Q.
			\end{math}
			Weiter existiert mit \eqref{eq:3.20} eine eindeutige Lösung $u_0 \in V_0$ von
			\begin{math}
				a(u_0,v) &= f(v) - a(u_\orth, v) & \forall v \in V_0,
			\end{math}
			denn $f(\argdot) - a(u_\orth, \argdot) \in V_0'$.
			Wir definieren $u := u_\orth + u_0$ und $f_\orth \in V'$ via
			\begin{math}[numbered] \label{eq:3.22:1}
				f_\orth(v) &:= f(v) - a(u,v) &\forall v \in V.
			\end{math}
			Dann ist auch $f_\orth \in (V_\orth)'$, also hat mit \eqref{3.37} i) und der Bemerkung nach \eqref{3.39} das duale Problem eine eindeutige Lösung $p \in Q$ mit
			\begin{math}
				b(p,v) &= f_\orth(v) & \forall v \in V_\orth.
			\end{math}

			Zeige nun: $(u,p)$ löst Sattelpunktproblem.
			Für $v \in V_0$ gilt
			\begin{math}
				a(u,v) + b(p,v)
				= \underbrace{a(u_0,v)}_{=f(v) - a(u_\orth, v)} + a(u_\orth, v ) + \underbrace{b(p,v)}_{=0}
				= f(v).
			\end{math}
			Für $v \in V_\orth$ gilt mit \eqref{eq:3.22:1}
			\begin{math}
				a(u,v) + b(p,v)
				= f(v) - f_\orth(v) + \underbrace{b(p,v)}_{=f_\orth(v)}
				= f(v).
			\end{math}
			Damit ist die erste Sattelpunktsgleichung erfüllt.
			Für $q \in Q$ gilt
			\begin{math}
				b(q,u)
				= \underbrace{b(q, u_0)}_{=0} + b(q, u_\orth)
				= g(q),
			\end{math}
			d.h. die zweite Sattelpunktsgleichung ist auch erfüllt.
			Somit ist Existenz und Eindeutigkeit gezeigt.

			Stabilität folgt aus Stabilität der Teilprobleme:
			es gilt $\|u_\orth\| \le \frac{1}{\beta}\|g\|_{Q'}, \|u_0\| \le \frac{1}{\beta_a} \|f-a(u_\orth, \argdot)\|_{v'}$.
			Wegen $\|\argdot\|_{V'} \le \|\argdot\|_{V}$ und mit Stetigkeitskonstante $\gamma$ von $a(\argdot, \argdot)$ folgt
			\begin{math}
				\|u_0\| \le \frac{1}{\beta_a}(\|f\|_{V'} + \gamma \|u_\orth\|)
				\le \frac{1}{\beta_a}(\|f\|_{V'} + \frac{\gamma}{\beta_b}\|g\|_{Q'}).
			\end{math}
			Für die Summe also
			\begin{math}
				\|u\|
				\le \|u_L\| + \|u_0\|
				\le \frac{1}{\beta_a} + \frac{1}{\beta_b}(\frac{\gamma}{\beta_a} + 1) \|g\|
				\le C_u(\|f\| + \|g\|),
			\end{math}
			wobei $C_u := \max \Set{\frac{1}{\beta_a}, \frac{1}{\beta_b}(\frac{\gamma}{\beta_a} + 1)}$.
			Mit der Youngschen Ungleichung $2 \_b \_c \le b^2 + c^2$ für $\_b, \_c \ge 0$ folgt für $\_a \le \_b + \_c$
			\begin{math}
				\_a^2
				\le (\_b + \_c)^2
				= \_b^2 + 2\_b\_c + \_c^2
				\le 2(\_b^2 + \_c^2).
			\end{math}
			Mit $\_a := \|u\|, \_b := C_u\|f\|, \_c := C_u\|g\|$ folgt
			\begin{math}
				\|u\|^2 \le 2 C_u^2 (\|f\|^2 + \|g\|^2).
			\end{math}
			Für $p$ folgt analog:
			\begin{math}
				\|p\|
				&\le \frac{1}{\beta_b} \|f_\orth\|
				= \frac{1}{\beta_b}\|f - a(u,\argdot)\|_{(V_\orth)'} \\
				&\le \frac{1}{\beta_b}\|f-a(u,\argdot)\|_{V'} \\
				&\le \frac{1}{\beta_b}(\|f\| + \gamma \|u\|) \\
				&\le \frac{1}{\beta_b}(1 + \gamma C_u) \|f\| + \frac{1}{\beta_b} \gamma C_u \|g\| \\
				&\le C_p (\|f\| + \|g\|).
			\end{math}
			Mit $C_p := \max \Set{ \frac{1}{\beta_b}(1+\gamma C_u), \frac{\gamma}{\beta_b} C_u }$ und mit der Young-Ungleichung wie oben
			\begin{math}
				\|p\|^2 \le 2 C_p^2 (\|f\|^2 + \|g\|^2).
			\end{math}
			Summation ergibt also
			\begin{math}
				(\|u\|^2 + \|p\|^2)^{\frac{1}{2}}
				\le \underbrace{\sqrt{2(C_u^2 + C_p^2)}}_{=\beta^{-1}} (\|f\|^2 + \|g\|^2)^{\frac 12}.
			\end{math}
		\end{seg}
		\begin{seg}[\ProofImplication]
			Angenommen für eine der Konstanten gilt $\beta_a = 0$ oder $\beta_b = 0$.
			Es ergibt sich Mehrdeutigkeit der Lösung eines Teilproblems aus der Rückrichtung des Beweises und somit auch eine mehrdeutige Lösung des Sattelpunktproblems.
		\end{seg}
	\end{proof}
\end{st}

\begin{kor}[Wohlgestelltheit Stokes] \label{3.44}
	Das Stokes-Sattelpunktproblem, d.h. \ref{3.40} mit $a(\argdot, \argdot), b(\argdot), f(\argdot), g(\argdot)$ gemäß \ref{3.41} besitzt eine eindeutige Lösung, welche beschränkt ist durch die Daten $f, g$.
	\begin{proof}
		Klar mit \ref{3.41} und \ref{3.43}.
	\end{proof}
\end{kor}


\section{Petrov-Galerkin-Verfahren} \label{sec:3.3}


Für eine gegebene schwache Form einer PDE suchen wir $u \in V$ mit
\begin{math}
	a(u,w) &= l(w) & \forall w \in W.
\end{math}

Wir schränken dazu das Problem auf endlichdimensionale Teilräume ein, um eine berechenbare Approximation zu erhalten.

\begin{df}[Diskretes Problem, Lösung] \label{3.45}
	Sei $a: V \times W \to \R$ stetige Bilinearform, $l \in W'$.
	Seien $V_h \subset V, W_h \subset W$ endlichdimensionale Teilräume mit $\dim V_h = \dim W_h = n$.
	Dann ist $u_h \in v_h$ gesucht als \emphdef{diskrete Lösung} von
	\begin{math}
		a(u_h, w) &= l(w) & \forall w \in W_h.
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				Wir nennen $V_h$ den \emphdef{Ansatzraum} und $W_h$ \emphdef{Testraum}.
			\item
				Fall $V \neq W$ oder $V_h \neq W_h$, dann heißt diese Einschränkung \emphdef{Petrov-Galerkin-Projektion}.
			\item
				Falls $V = W$ und $V_h = W_h$ heißt es \emphdef{Ritz-Galerkin-Projektion} oder \emphdef{Galerkin-Projektion}.
			\item
				Der Begriff der „Projektion“ legt nahe, dass man sich einen Projektionsoperator $P_h: V \to V_h$ definieren kann mit $P_h u = u_h$ und $P_h^2 = P_h$.
		\end{itemize}
	\end{note}
\end{df}

Wegen $\dim V_h = \dim W_h$ vereinfacht sich die Charakterisierung von inf-sup-Stabilität.

\begin{st}[Diskrete inf-sup-Bedingungen] \label{3.46}
	Für eine Bilinearform $a: V_h \times W_h \to \R$ sind äquivalent
	\begin{enumerate}[i)]
		\item
			$\inf_{v\in V_h} \sup_{w\in W_h} \frac{a(v,w)}{\|v\|\|w\|} = \beta_h > 0$,
		\item
			$\inf_{w\in W_h} \sup_{v\in V_h} \frac{a(v,w)}{\|v\|\|w\|} = \beta_h > 0$,
		\item
			$\forall w \in W_h \setminus \Set 0 \exists v \in V_h : a(v,w) \neq 0$ (d.h. $A$ ist surjektiv),
		\item
			$\forall v \in V_h \setminus \Set 0 \exists w \in W_h : a(v,w) \neq 0$ (d.h. $A$ ist injektiv),
	\end{enumerate}
	\begin{note}
		Wir nennen $\beta_h$ auch \emphdef{diskrete inf-sup-Konstante}.
	\end{note}
	\begin{proof}
		\begin{seg}[\ProofImplication)[1][3]]
			$A$ ist injektiv nach \ref{3.32} ii).
			Wegen $\dim V_h = \dim W_h$ folgt $A$ surjektiv, also $\forall w \in W, w \neq 0 \exists v \in V: a(v,w) \neq 0$ (wähle z.b. $v := A^T w$, dann ist in Matrixdarstellung $a(v,w) = w^TA A^T w = \|A^T w\|^2 \neq 0$ wegen Injektivität).
		\end{seg}
		\begin{seg}[\ProofImplication)[3][1]]
			$A$ ist surjektiv, also auch injektiv und es existiert eine stetige Inverse.
			Setze $\beta := \|A^{-1}\| > 0$.
			Mit \ref{3.34} ist
			\begin{math}
				\inf_{v\in V_h} \sup_{w\in W_h} \frac{a(v,w)}{\|v\|\|w\|}
				\ge \beta
			\end{math}
			und es folgt i).
		\end{seg}
		\begin{seg}[\ProofImplication)[2][4], \ProofImplication)[4][2]]
			analog zu i) $\iff$ iii).
		\end{seg}
		\begin{seg}[\ProofImplication)[1][2]]
			Mit i) und iii) folgt nach \ref{3.34}, dass $A$ invertierbar ist mit $\|A^{-1}\| \le \frac{1}{\beta}$.
			Damit ist $A^*$ invertierbar mit $\|(A^*)^{-1}\| \le \frac{1}{\beta}$.
			Nach \ref{3.34} erfüllt $a(\argdot, \argdot)$
			\begin{math}
				\inf_{w\neq 0} \sup_{v\neq 0} \frac{a(v,w)}{\|v\|\|w\|}
				\ge \beta,
			\end{math}
			also folgt ii).
		\end{seg}
	\end{proof}
\end{st}

\begin{st}[Wohlgestelltheit] \label{3.47}
	$a(\argdot, \argdot)$ erfülle eine der Bedingungen aus \ref{3.46}.
	Dann hat das diskrete Problem \ref{3.45} eine eindeutige Lösung $u_h \in V_h$ mit
	\begin{math}
		\|u_h\| \le \frac{1}{\beta_h} \|l\|_{W'}.
	\end{math}
	\begin{proof}
		klar mit Nečas \ref{3.37}.
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Für koerzive Probleme ist Wohlgestelltheit trivial:
				Koerzivität vererbt sich auf Teilräume, $\beta_h = \alpha$ ist gültige inf-sup-Konstante.
			\item
				Für (nicht-koerzive) inf-sup-stabile Probleme muss diskrete Stabilität bei der Wahl der Teilräume $V_h, W_h$ berücksichtigt werden, siehe auch Beispiel \ref{3.53}.
		\end{itemize}
	\end{note}
\end{st}

\begin{lem}[Galerkin-Orthogonalität] \label{3.48}
	Seien $u \in V, u_h \in V_h$ Lösung der PDE, bzw. der Petrov-Galerkin-Projektion.
	Dann gilt
	\begin{math}
		\forall w \in W_h : a(u - u_h, w) = 0,
	\end{math}
	sogenannte \emphdef{Galerkin-Orthogonalität}.
	\begin{proof}
		Es gilt für alle $w \in W_h$
		\begin{math}
			a(u-u_h, W)
			= \underbrace{a(u, w)}_{l(w)} - \underbrace{a(u_h, w)}_{l(w), w \in W_h}
			= l(w) - l(w)
			= 0.
		\end{math}
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Falls $a(\argdot, \argdot)$ symmetrisch und koerziv, $W = V, W_h = V_h$, dann bedeutet diese Aussage gerade Orthogonalität des Projektionsfehlers bei der orthogonalen Projektion bezüglich des Energie-Skalarprodukts.

				Definiere $P_a: V \to V_h$ durch $\<v - P_a v, w\>_a = 0$ für alle $w \in V_h, v \in V$.
				Dann ist $P_a u = u_h$, denn $\<u - u_h, w\>_a = a(u - u_h, w) = 0$ mittels Galerkin-Orthogonalität \ref{3.48}.
				Die Galerkin-Projektion ist also genau die orthogonale Projektion bezüglich $\<\argdot, \argdot\>_a$.
			\item
				Falls $a(\argdot, \argdot)$ nicht symmetrisch, nicht koerziv oder $V \neq W$, so existiert keine solche Interpretation als orthogonale Projektion.
				Wir sprechen aber trotzdem von Galerkin-Orthogonalität.
		\end{itemize}
	\end{note}
\end{lem}

\Timestamp{2014-12-05}

\begin{kor}[Reproduktion von Lösungen] \label{3.49}
	Sei $a(\argdot, \argdot)$ inf-sup-stabil auf $V \times W$ und $V_h \times W_h$, $u \in V$ Lösung der (schwachen) PDE und $u_h \in V_h$ die Petrov-Galerkin-Projektion.
	Falls $u \in V_h$, dann ist $u_h = u$.
	\begin{proof}
		Für $u \in V_h$, dann ist auch $u - u_h \in Vh$.
		Angenommen $u - u_h \neq 0$, dann existiert $w \in W_h, w \neq 0$ mit
		\begin{math}
			a(u-u_h, w) \neq 0.
		\end{math}
		Dies ist ein Widerspruch zur Galerkin-Orthogonalität, also $u = u_h$.
	\end{proof}
	\begin{note}
		Also ist z.B. $V_h = \Span(u)$ optimaler 1D-Lösungsraum.
		Dieser ist natürlich derart „teuer“ zu berechnen, wie $u$ und daher inpraktikabel.
	\end{note}
\end{kor}

\begin{st}[Diskretes Problem als LGS] \label{3.50}
	Sei $V_h \subset V$ mit Basis $\Set{\phi_j}_{j=1}^n$ und $W_h \subset W$ mit Basis $\Set{\psi_i}_{i=1}^n$.
	Definiere die Systemmatrix $A_h = (a_{ij})_{i,j=1}^n$ und die „rechte Seite“ $b_h = (b_i)_{i=1}^n$ via
	\begin{math}
		a_{ij} &:= a(\phi_j, \psi_i), &
		b_i &:= l(\psi_i)
	\end{math}
	für $i,j = 1, \dotsc, n$.
	Dann ist $u_h = \sum_{j=1}^n u_j \phi_j$ mit DOF-Vektor $\underbar{u}_h = (u_i)_{i=1}^n$ Lösung des LGS
	\begin{math}[numbered] \setcounter{equation}{21} \label{eq:3.22}
		A_h \underbar{u}_h = b_h.
	\end{math}
	\begin{proof}
		Zeige: $\sum_{j=1}^{n} u_j \phi_j$ löst die schwache Form der PDE.
		Für eine Testfunktion $w = \psi_i$ gilt
		\begin{math}
			a\Big(\sum_{j=1}^{n} u_j \phi_j, \psi_i \Big)
			= \sum_{j=1}^{n} a(\phi_j, \psi_i) u_j
			= (A_h \underbar{u}_h)_i
			\stack{\eqref{3.22}}= (b_h)_i
			= b_i
			= l(\psi_i).
		\end{math}
		Für $w \in W_h$ existiert $\underbar{w} \in \R^n$, $w = (w_i)_{i=1}^n$ mit $w = \sum_{i=1}^n w_i \psi_i$ und
		\begin{math}
			a\Big(\sum_{j=1}^{n} u_j \phi_j, w \Big)
			&= \sum_{i=1}^{n} w_i \underbrace{a\Big(\sum_{j=1}^{n} u_j \phi_j, \psi_i\Big)}_{=l(\psi_i)} \\
			&= \sum_{i=1}^{n} w_i l(\psi_i)
			= l\Big(\sum_{i=1}^{n} w_i \psi_i\Big)
			= l(w).
		\end{math}
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Falls $a(\argdot, \argdot)$ symmetrisch und $V_h = W_h$ mit identischer Basis, dann ist auch $A_h$ symmetrisch.
			\item
				Falls $a$ koerziv, dann ist $A_h$ positiv definit
				\begin{proof}
					\begin{math}
						\underbar{v}^T A_h \underbar{v}
						&= \sum_{i,j} v_i v_j (A_{ij})
						= a\Big(\sum_{j}^{} v_j \phi_j, \sum_{i}^{} v_i \phi_i \Big) \\
						&= a(v,v)
						> \alpha\|v\|^2
					\end{math}
					und somit $\underbar{v}^T A_h \underbar{v} > 0 \iff v \neq 0$.
				\end{proof}
			\item
				Falls $a$ koerziv und symmetrisch, wird $A_h$ auch „Steifigkeitsmatrix“ genannt wegen physikalischer Anschauung im Kontext der linearen Elastizität.
		\end{itemize}
	\end{note}
\end{st}

\begin{ex} \label{3.51}
	$V_h$ aus Eigenfunktionen des Differentialoperators im Fall $V = W$.
	Die optimale Basis bei unbekannter/variabler rechte Seite $l$:

	Definiere die „schwache Form“ des Eigenwertproblems als:
	Finde Eigenfunktion $v \in V$ und Eigenwert $\lambda$ mit
	\begin{math}
		a(v,w)
		&= \lambda \<v, w\>_{L^2}
		& \forall w \in V.
	\end{math}
	Unter gewissen Voraussetzungen, z.B. $a(\argdot, \argdot)$ symmetrisch, $\Omega$ zusammenhängend, siehe [Evans, §6.5] kann man zeigen:
	\begin{itemize}
		\item
			Es existieren nur reelle positive Eigenwerte: $\lambda \in (0, \infty)$.
		\item
			Es existiert eine unbeschränkte Folge an Eigenwerten, d.h. $(\lambda_j)_{j\in\N}$ mit
			\begin{math}
				0 < \lambda_1 \le \lambda_2 \le \dotsb
			\end{math}
			und $\lim_{j\to \infty}\lambda_j = \infty$.
		\item
			Es existiert eine $L_2$-orthonormale Menge $\Set{v_j}_{j\in\N}$ aus Eigenfunktionen $v_j$ zu Eigenwerten $\lambda_j$.
			Ansatz: Wähle $n \in \N$, setze $h := \f 1n$, $V_h := \Span(\phi_1, \dotsc, \phi_n) \subset V$ mit $\phi_i := v_i$.
			Für die Steifigkeitsmatrix der Galerkin-Projektion folgt:
			\begin{math}
				a(\phi_j, \phi_i)
				= a(v_j, v_i)
				= \lambda_j \underbrace{\<v_j, v_i\>_{L_2}}_{\delta_{ij}}
				= \lambda_j \delta_{ij},
			\end{math}
			also ergibt sich das LGS
			\begin{math}
				\Matrix{\lambda_1 & & 0 \\ & \ddots & \\ 0 & & \lambda_n}
				\Vector{u_1 & \dots & u_n}
				= \Vector{l(v_1) & \dots & l(v_n)}
			\end{math}
			mit Lösung $u_j := \frac{l(v_j)}{\lambda_j}$.

			Dies ergibt eine optimale Struktur des LGS, da $A_h$ diagonal ist.
			Im Allgemeinen ist das Verfahren jedoch inpraktikabel, da die Eigenfunktionen/Eigenwerte $v_i, \lambda_i$ selten bekannt sind.
	\end{itemize}
\end{ex}

\begin{ex} \label{3.52}
	$V_h$ als polynomieller Ansatzraum ($V = W, V_h = W_h$)
	Sei $d = 1, \Omega = (0,1), a(u,v) := \int_\Omega u' v'$ auf $H_0^1(\Omega)$.
	Ein Polynom mit Nullrandwerten hat die Gestalt $p(x) = x(1-x)q(x)$ für $q \in \P_m$.
	Wähle $n \in \N$, $h := \frac{1}{n}$, $V_h := \Span(\phi_1, \dotsc, \phi_n) \subset V$ mit $\phi_j(x) := x(1-x) x^{j-1} = x^j (1-x)$ für $j = 1, \dotsc, n$.
	Es ergibt sich
	\begin{math}
		a(\phi_j, \phi_i)
		= \int_\Omega \phi_j' \phi_i' \di[x],
	\end{math}
	im Allgemeinen ergibt sich $a(\phi_j, \phi_i) \neq 0$.
	Die Steifigkeitsmatrix $A_h$ ist somit dicht besetzt und bei großen Matrizen ergeben sich Speicherprobleme.
	Folglich ist das Verfahren für großes $n$ impraktikabel.

	Bei mäßigem $n$ (z.B. $n \approx 25$) findet dies unter dem Namen \emphdef{Spektralverfahren} Verwendung.
\end{ex}

\begin{ex}[Notwendigkeit von Petrov-Galerkin bei nicht-koerziven Problemen] \label{3.53}
	Falls $a(\argdot, \argdot)$ nicht koerziv ist, kann die (Ritz-)Galerkin-Projektion aus einem wohlgestellten Problem in $V$ ein singuläres System in $V_h$ liefern.

	Sei $V := \R^2, a(u,v) = u^T \Matrix{1 & 0 \\ 0 & -1} v$ für $u, v \in \R^2$ und $l(v) := \Vector{1 & 1}^T v$.

	$a(\argdot, \argdot)$ ist nicht koerziv, da $a(\Vector{0 & 1}, \Vector{0 & 1}) = -1 < \alpha \|\Vector{0 & 1}\|^2$ für alle $\alpha > 0$.
	Das System in $V$ ist wohlgestellt:
	\begin{math}
		a(u,v) = l(v)
		\iff u^T \Matrix{1 & 0 \\ 0 & -1} = \Vector{1 & 1}^T
		\iff u = \Vector{1 & -1}.
	\end{math}
	Übung: inf-sup-Konstante ist $1$.

	Mit $V_h = \Span(\Vector{1 & 1})$, $W_h = V_h$ entsteht nun ein singuläres System:
	mit dem Ansatz $u_h = u_1 \phi_1$, wobei $\phi_1 = \Vector{1 & 1}$, $u_1 \in \R$ ergibt sich als LGS:
	\begin{math}
		A_h &= (a_{11}) = a(\phi_1, \phi_1) = \Vector{1 & 1}^T \Matrix{1 & 0 \\ 0 & -1} \Vector{1 & 1} = 0, \\
		b_h &= l(\phi_1) = \Vector{1 & 1}^T \Vector{1 & 1} = 2,
	\end{math}
	aber $0 \cdot u_h = 2$ ist nicht lösbar.

	Ein Ausweg bietet Petrov-Galerkin:
	Wähle $\phi_1 \in \R^2 \setminus \Span(\Vector{1 & 1})$ beliebig, $\psi_1 := \Matrix{1 & 0 \\ 0 & -1} \phi_1$, $V_h := \Span(\phi_1), W_h := \Span(\psi_1)$.
	Es ergibt sich
	\begin{math}
		A_h &= (a(\phi_1, \psi_1))
		= \phi_1^T \Matrix{1 & 0 \\ 0 & -1} \underbrace{\Matrix{1 & 0 \\ 0 & -1} \phi_1}_{=\psi_1}
		= \|\phi_1\|^2 > 0, \\
		b_h &= l(\psi_1),
	\end{math}
	Also ist $A_h \underbar{u}_h = b_h$ eindeutig lösbar.
\end{ex}

Wir wenden uns jetzt Fehleranalysen für Petrov-Galerkin zu:
Zentral ist die Beziehung zur Bestapproximation.

Gegeben $V_h$, wie gut kommt $u_h \in V_h$ an das Minimum von $\inf_{v\in V_h} \|u - v\|$ heran?.
Zunächst ein Hilfssatz

\begin{lem} \label{3.54}
	Sei $P \in L(V, V)$ idempotent, d.h. $P^2 = P$, nichttrivial, d.h. $0 \neq P \neq \Id$.
	Dann ist
	\begin{math}
		\|P\|_{L(V,V)}
		= \|\Id - P\|_{L(V,V)}.
	\end{math}
	\begin{proof}
		Siehe Übung.
	\end{proof}
\end{lem}

\begin{st}[Beziehung zur Bestapproximation] \label{3.55}
	Sei $a(\argdot, \argdot)$ inf-sup-stabil auf $V_h \times W_h$ mit inf-sup-Konstante $\beta_h > 0$ und stetig auf $V \times W$ mit Stetigkeitskonstante $\gamma > 0$.
	Dann gilt für den Fehler der Petrov-Galerkin-Projektion
	\begin{math}
		\|u - u_h\| \le \frac{\gamma}{\beta_h} \inf_{v\in V_h} \|u - v\|.
	\end{math}
	\begin{proof}
		Definieren $P_h: V \to V_h$:
		Zu $v \in V$ sei $P_h v \in V_h$ Lösung von
		\begin{math}[numbered] \label{eq:3.23}
			a(P_h v, w) &= a(v,w) & \forall w \in W_h.
		\end{math}
		Wegen $a(v, \argdot) \in W'$ existiert eine eindeutige Lösung $P_h v$, also ist $P_h$ wohldefiniert.
		$P_h$ ist weiter linear (trivial) und eine Projektion $P_h^2 = P_h$, denn für $v \in V_h$ erfüllt $P_h v = v$ die Gleichung \eqref{eq:3.23}.
		Damit gilt
		\begin{math}
			(\Id - P_h)v
			= v - P_h v
			= 0
		\end{math}
		für alle $v \in V_h$.
		Weiter gilt $u_h = P_h u$, denn $a(P_h u, w) \stack{\eqref{eq:3.23}}= a(u,w) = l(w)$ für alle $w \in W_h$, was gerade dem diskreten Problem \ref{3.45} entspricht.
		Für die Norm schließen wir
		\begin{math}
			\|P_h v\|
			\le \frac{\|a(v,\argdot)\|_{W'}}{\beta_h}
			\le \frac{\gamma \|v\|}{\beta_h},
		\end{math}
		also
		\begin{math}
			\|P_h\|
			= \sup_{v\neq 0} \frac{\|P_h v\|}{\|v\|}
			\le \frac{\gamma}{\beta_h}.
		\end{math}
		Für $v \in V_h$ gilt die Behauptung mittels \ref{3.54} falls $P_h$ nichttrivial ist:
		\begin{math}
			\|u - u_h\|
			&= \|(\Id - P_h)u\|
			= \|(\Id - P_h u) - (\Id - P_h)v\| \\
			&= \|(\Id - P_h)(u-v)\| \\
			&\le \|\Id - P_h\| \|u-v\|
			\stack{\ref{3.54}}= \|P_h\|\|u-v\| \\
			&\le \frac{\gamma}{\beta} \|u-v\|
		\end{math}
		für alle $v \in V_h$, insbesondere also
		\begin{math}
			\|u - u_h\| \le \frac{\gamma}{\beta_h} \inf_{v\in V_h} \|u - v\|.
		\end{math}
		Falls $P_h = \Id$ ist $V = V_h$, $\|u - u_h\| = 0$, also ist die Behauptung klar.
		Falls $P_h = 0$, dann ist $V_h = \Set{0}$ (sonst finde $v \in V_h \setminus \Set 0$, also $0 = P_h v = v \neq 0$, ein Widerspruch) und insbesondere $\dim V_h = 0$, also $a(\argdot, \argdot)$ nicht inf-sup-stabil auf $V_h \times W_h$.
	\end{proof}
\end{st}

\begin{kor}[Lemma von Céa] \label{3.56}
	Falls $a(\argdot, \argdot)$ stetig und koerziv mit Koerzivitätskonstante $\alpha$, so gilt
	\begin{math}
		\|u - u_h\| \le \frac{\gamma}{\alpha} \inf_{v\in V_h} \|u - v\|.
	\end{math}
	\begin{proof}
		Klar mit \ref{3.55} und $\alpha$-$\beta$-Beziehung in \ref{3.33}.
	\end{proof}
\end{kor}

\begin{note}
	\begin{itemize}
		\item
			$\|u - u_h\|$ ist bei Galerkin-Projektion für $a(\argdot, \argdot)$ koerziv, also höchstens um einen $h$-unabhängigen Faktor $\frac{\gamma}{\alpha}$ schlechter als die Bestapproximation.
			Dies nennt man \emphdef{Quasi-Optimalität} der Galerkin-Projektion.
		\item
			Ein offensichtlich gutes Konstruktionsprinzip für $V_h$ wäre:
			Wähle $V_h$ so, dass $\inf_{v \in V_h} \|u - v\|$ klein, dann ist der Galerkin-Approximationsfehler garantiert klein.
		\item
			Formal impliziert \ref{3.56} Konvergenz der Galerkin-Projektion, falls die Bestapproximation konvergiert:
			\begin{math}[numbered] \label{eq:3.24}
				\inf_{v\in V_h} \|u - v\| &\le C h^p
				&&\implies&
				\|u - u_h\| &\le C' h^p
			\end{math}
			mit $C' := C \frac{\gamma}{\alpha}$.
		\item
			Konvergenz und Fehleranalysis ist also reduziert auf die PDE-unabhängige Frage:
			Wie gut kann $V_h$ Funktionen $u \in V$ gut approximieren?
	\end{itemize}
\end{note}

\Timestamp{2014-12-09}


\begin{note}
	\begin{itemize}
		\item
			Komplikation bei inf-sup-stabilen Problemen:
			Es kann passieren und muss verhindert werden, dass $\beta_h \to 0$ für $h \to 0$, da dann die Konvergenzordnung der Bestapproximation oder gar die Konvergenz der Petrov-Galerkin-Approximation (welche später behandelt wird) verloren geht, was auf ein \emphdef{instabiles Verfahren} führt.

			Ziel ist daher eine \emphdef{stabile Diskretisierung}, d.h. $V_h, W_h$ müssen so gewählt werden, dass $\_\beta > 0$ existiert mit $\beta_h \ge \_\beta > 0$ für alle $h$.
			In diesem Fall gilt $\inf_{v \in V_h} \sup_{w \in W_h} \frac{a(v,w)}{\|v\|\|w\|} \ge \_\beta$ und eine analoge Aussage zur Konvergenzordnung \eqref{eq:3.24} gilt.
	\end{itemize}
\end{note}

\begin{note}[Verbesserung von Céa für symmetrische Probleme]
	Falls $a(\argdot, \argdot)$ koerziv, stetig und symmetrisch, so gilt die Bestapproximationsaussage mit verbesserter Konstante $\sqrt{\frac{\gamma}{\alpha}}$:
	Mit Stetigkeit und Koerzivität folgt Normäquivalenz zur Energienorm $\|\argdot\|_a$
	\begin{math}
		\|v\|_a
		= a(v,v)
		\le \gamma \|v\|^2, &&
		\alpha \|v\|^2 \le a(v,v) = \|v\|_a^2
	\end{math}
	und folglich
	\begin{math}
		\sqrt a \|v\| \le \|v\|_a \le \sqrt{\gamma} \|v\|.
	\end{math}
	Für alle $v \in V_h$ gilt mit Galerkin-Orthogonalität und Cauchy-Schwartz gilt
	\begin{math}
		\|u-u_h\|_a^2
		&= a(u-u_h, u-u_h)
		= a(u - u_h, u - v)
		= \<u - u_h, u - v\>_a \\
		&\le \|u-u_h\|_a \|u -v\|_a,
	\end{math}
	also $\|u-u_h\|| \le \|u - v\|_a$.
	Mit Normäquivalenz also
	\begin{math}
		\|u-u_h\|
		\le \sqrt{\frac{\gamma}{\alpha}} \|u-v\|
	\end{math}
	und insbesondere für das Infimum über alle $v$:
	\begin{math}
		\|u - u_h\| \le \sqrt{\frac{\gamma}{\alpha}} \inf_{v\in V_h} \|u-v\|.
	\end{math}
\end{note}


\section{Finite Elemente} \label{sec:3.4}


Wähle das Galerkin-Verfahren mit stückweise polynomiellen, global stetigen Ansatzfunktionen, welche lokalen Träger haben.

Beispiel: $d = 1, \Omega = (0,1)$ mit äquidistantem Giltter für $n \in \N, h := \frac{1}{n+1}, x_i := i h$ für $i = 0, \dotsc, n + 1$.
Als Ansatzfunktionen wählen wir für $j = 1, \dotsc, n$ „Hütchenfunktionen“
\begin{math}
	\phi_j(x) := \begin{cases}
		\frac{1}{h} (x - x_{j-1}) & x \in [x_{j-1}, x_j] \\
		-\frac{1}{h} (x - x_{j+1} & x \in [x_j, x_{j+1}] \\
		0 & \text{sonst}
	\end{cases}.
\end{math}
Wir erhalten insbesondere $\phi_j(x_i) = \delta_{ij}$, die $\phi_j$ bilden also eine sogenannte \emphdef{nodale Basis}.
Es gilt $\supp(\phi_j) = [x_{j-1}, x_{j+1}]$, der Träger skaliert mit $h$ gegen $0$.

Als Ansatzraum wählen wir $V_h := \Span(\phi_1, \dotsc, \phi_n) \subset H_0^1(\Omega)$, dies ist gerade der Raum der linearen Splines.

Für das Poisson-Problem
\begin{math}
	-u''(x) &= f(x) && x \in (0,1) \\
	u(0) = u(1) &= 0.
\end{math}
erhalten wir in der schwachen Form
\begin{math}
	a(u,v) &= \int_0^1 u' v' \di[x],
	l(v) &= \int_0^1 f v \di[x].
\end{math}
Die Ableitungen der Ansatzfunktionen:
\begin{math}
	\phi_j'(x)
	= \begin{cases}
		\frac{1}{h} & x \in (x_{j-1}, x_j) \\
		-\frac{1}{h} & x \in (x_j, x_{j+1}) \\
		0 & \text{sonst}
	\end{cases}.
\end{math}
Damit folgt für die Matrix $A_h = (a_{ij})_{i,j=1}^n$:
\begin{math}
	i &= j: & a_{jj} &= a(\phi_j,\phi_j) = \int_\Omega (\phi_j')^2 = \int_{x_{j-1}}^{x_{j+1}} (\frac{1}{h})^2 = 2h \frac{1}{h^2} = \frac{2}{h}, \\
	i &= j+1: & a_{j+1,j} &= \int_0^1 \phi_j' \phi_{j+1} = \int_{x_j}^{x_{j+1}} - \frac{1}{h} \frac{1}{h} = - h \frac{1}{h^2} = -\frac{1}{h},
\end{math}
analog für $i = j - 1$ und für $|i-j| > 1$ folgt $a_{ij} = 0$.
Wir erhalten
\begin{math}
	A_h &= \frac{1}{h} \Matrix{2 & -1 & & \\ -1 & \ddots & \ddots & \\ 0 & \ddots & \ddots & -1 \\ & & -1 & 2}, &
	b_h &= \Vector{\int_\Omega f\phi_1 & \dots & \int_\Omega f \phi_n}.
\end{math}
$A_h$ ist eine Tridiagonalmatrix und damit sehr dünn besetzt, es ergibt sich kein Speicherproblem für große $n$.
Hier ist zufällig $A_h$ eine skalierte Version der FD-Matrix.
Die gute Approximations-Fähigkeit von Splines garantiert mit Céa eine gute Approximation der FEM-Approximation.

\begin{df}[Simplex] \label{3.57}
	Seien $a_0, \dotsc, a_s \in \R^d$ affin linear unabhängig, d.h. $a_1 - a_0, \dotsc, a_s - a_0$ linear unabhängig, insbesondere $s \le d$.
	\begin{enumerate}[i)]
		\item
			Dann nennen wir die konvexe Hülle
			\begin{math}
				T =
				\ConvexHull{a_0, \dotsc, a_s}
				:= \Set{x \in \R^d & x = \sum_{j=0}^s \lambda_j a_j, \lambda_j \ge 0, \sum_{j=0}^s \lambda_j = 1}
			\end{math}
			ein (nichtdegeneriertes) $s$-dimensionales \emphdef{Simplex} im $\R^d$.
			Die Punkte $\Set{a_j}$ heißen \emphdef{Ecken} des Simplex.
		\item
			Für $r \in \Set{0, \dotsc, s}$ sei $\Set{a_0', \dotsc, a_r'} \subset \Set{a_0, \dotsc, a_s}$.
			Dann ist $S := \ConvexHull(a_0', \dotsc, a_r')$ ein $r$-dimensionales Seitensimplex von $T$ mit Eckenmenge $\scr E(S) := \Set{a_0', \dotsc, a_r'}$.
		\item
			Falls $d = s$, $a_0 := e_0 := 0$ und $a_j := e_j$ Einheitsvektoren für $j = 1, \dotsc, d$, dann heißt $\hat T = T$ \emphdef{Einheitssimplex} oder \emphdef{Referenzelement} im $\R^d$.
	\end{enumerate}
\end{df}

\begin{ex*}
	\begin{itemize}
		\item
			Für $s = 2$, $d \ge 2$ ist $T$ ein Dreieck.
		\item
			Für $s = 3$, $d \ge 3$ ist $T$ ein Tetraeder.
		\item
			Für $s = 1$, $d \ge 1$ ist $T$ eine Strecke.
		\item
			Für $r = 1$ ist $S$ eine Kante von $T$.
		\item
			Für $r = 0$ ist $S$ eine Ecke von $T$.
	\end{itemize}
\end{ex*}

\begin{lem}[Baryzentrische Koordinaten] \label{3.58}
	Sei $T$ ein $s$-dimensionaler Simplex im $\R^d$, $x \in T$.
	Dann sind Zahlen $\Set{\lambda_j}_{j=0}^s$ mit
	\begin{itemize}
		\item
			$x = \sum_{j=0}^{s} \lambda_j a_j$,
		\item
			$\sum_{j=0}^s \lambda_j = 1$,
		\item
			$\lambda_j \ge 0$
	\end{itemize}
	eindeutig bestimmt und werden \emphdef{Baryzentrische Koordinaten} oder \emphdef{lokale Koordinaten} genannt.
	\begin{proof}
		Gesuchtes $\lambda = (\lambda_j)_{j=0}^s$ erfüllt ein LGS
		\begin{math}
			\underbrace{\Matrix{ | & & | \\ a_0 & \hdots & a_s \\ 1 & \hdots & 1}}_{M \in \R^{(d+1)\times (d+1)}}
			\Vector{\lambda_0 & \dots & \lambda_s}
			=
			\Vector{ | & x & | & 1}
		\end{math}
		Existenz einer Lösung $\lambda$ mit $\lambda_j \ge 0$ folgt aus der Definition des Simplex und $x \in T$.
		Eindeutigkeit:
		Sei $\_\lambda$ eine weiter Lösung mit $M \_\lambda = \Vector{x & 1}$, dann erfüllt $w := \lambda - \_\lambda$ das LGS $M w = \Vector{0 & 0}$.
		Zeigen: $M$ hat vollen Spaltenrang, dann ist $w = 0$, also $\lambda = \_\lambda$.
		Wir subtrahieren die erste Spalte von den übrigen:
		\begin{math}
			\_M
			= \Matrix{a_0 & a_1 - a_0 & \hdots & a_s - a_0 \\ 1 & 0 & \hdots & 0}.
		\end{math}
		Die letzten $s$ Spalten sind linear unabhängig nach Definition des Simplex und die erste Spalte enthält eine Eins in der letzten Zeile.
		Folglich ist $\rg(M) = \rg(\_M) = s + 1$.
	\end{proof}
\end{lem}

\begin{ex*}
	In einem Dreieck $\Set{a_0, a_1, a_2}$ haben wir für den Schwerpunkt
	\begin{math}
		\lambda = \Vector{\frac{1}{3} & \frac{1}{3} & \frac{1}{3}}
	\end{math} 
	Dies ist gerade der Inkreismittelpunkt, der Schnitt aller Seitenhalbierenden
	\begin{math}
		\Vector{0 & 0 & 1} + w \Big( \Vector{\frac{1}{2} & \frac{1}{2} & 0} - \Vector{0 & 0 & 1} \Big)
		= \Vector{\frac{1}{3} & \frac{1}{3} & \frac{1}{3}}
	\end{math}
	via $w = \frac{2}{3}$.
\end{ex*}

\begin{note}
	\ref{3.58} ist sehr praktisch, um zu testen, ob ein Punkt in einem Simplxe liegt, oder auf einem Seitensimplex:
	Berechne dazu $\lambda(x)$ und prüfe $\lambda_i \ge 0$.
	Die Zahl $|\Set{\lambda_i & \lambda_i \neq 0}| - 1$ ist die Dimension des Seitensimplex auf welches $x$ liegt.
\end{note}

\begin{df}[Geometrische Maße] \label{3.59}
	Für ein Simplxe $T$ ist der \emphdef{Durchmesser}
	\begin{math}
		h_T := \diam(T) := \sup_{x,y \in T} \|x - y\|.
	\end{math}
	Der \emphdef{Inkugeldurchmesser}
	\begin{math}
		\rho_T := 2 \sup \Set{R > 0 & \exists x_0 \in T : B_R(x_0) \subset T}
	\end{math}
	und
	\begin{math}
		\sigma_T := \frac{h_T}{\rho_T}.
	\end{math}
	\begin{note}
		$\sigma_T$ ist ein Maß für Degeneriertheit von $T$.
		So weisen beispielsweise sehr spitze Dreiecke großes $\sigma_T$ auf.
	\end{note}
\end{df}

Bei der Fehleranalyse und Implementierung von FEM werden Operationen häufig auf das Referenzelement durchegführt und das Ergebnis auf das gewünschte Simplex transformiert.üüm

\begin{st}[Referenzabbildung] \label{3.60}
	Sei $T$ ein $d$-dimensionales Simplex im $\R^d$ mit Ecken $\Set{a_j}_{j=0}^d$ und $\hat T$ das Referenzelement.
	\begin{enumerate}[i)]
		\item
			Dann existiert genau eine affine Abbildung $F_T: \hat T \to T$ mit $F_T(\hat x) = B\hat x + t$ und regulärer Matrix $B$, $t \in \R^d$ und $F_T(e_j) = a_j$ für $j = 0, \dotsc, d$ (mit $e_0 = 0$).
		\item
			\begin{math}
				\|B\|_2
				:= \sup_{\hat x \neq 0} \frac{\|B \hat x\|}{\|\hat x\|}
				\le \frac{h_T}{\rho_{\hat T}}
			\end{math}
		\item
			$\|B^{-1}\|_2 \le \frac{h_{\hat T}}{\rho_T}$.
		\item
			$|\det B| = \frac{|T|}{|\hat T|}$ und es existiert $c, C > 0$ unabhängig von $T$ mit
			\begin{math}
				c \rho_T^d
				\le |\det B|
				\le C h_T^d
			\end{math}
	\end{enumerate}
	\begin{proof}
		Siehe Übung.
	\end{proof}
\end{st}

\begin{df}[Triangulierung] \label{3.61}
	Sei $\Omega \subset \R^d$ offen und beschränkt mit polygonalem Rand.
	Sei $I$ eine endliche Indexmenge.
	Wir nennen $\scr T_h := \Set{T_i & i \in I}$ eine \emphdef{zulässige Triangulierung} von $\Omega$, wenn
	\begin{itemize}
		\item
			$T_i$ ist $d$-dimensionaler Simplex für alle $i \in I$,
		\item
			$\_\Omega = \bigcup_{i\in I} T_i$ („Überdeckung“),
		\item
			$\mathring T_i \cap \mathring T_j = \emptyset$ für alle $i \neq j$ („Überlappung“),
		\item
			für alle $i \neq j$ ist entweder $S := T_i \cap T_j = \emptyset$ oder $S$ $k$-dimensionaler Seitensimplex von $T_j$ und $T_i$ („Konformität“).
	\end{itemize}
	Dann definieren wir die \emphdef{globale Gitterweite} oder \emphdef{Feinheit} $h := \max_{i \in I} \Set{h_{T_i}}$, den \emphdef[minimaler Inkugelradius]{minimalen Inkugelradius} $\rho := \min_{i\in I} \Set{\rho_{T_i}}$, die \emphdef[Eckenmenge]{Ecken-} oder \emphdef[Knotenmenge]{Knotenmenge} $\scr E(\scr T_h) := \bigcup_{i \in I} \scr E(T_i)$ und das \emphdef{Maß für Degeneriertheit} $\sigma := \max_{i\in I} \sigma_{T_i}$.
	\begin{note}
		\begin{itemize}
			\item
				Eine zulässige Triangulierung hat keine „hängenden Knoten“ (siehe auch Bisektions-Übungsaufgabe).
				Dies würde der Konformität widersprechen.
			\item
				Man kann FEM auch für nicht-konforme, also nicht-zulässige Triangulierungen definieren.
				Falls $\Omega$ nicht polygonal, kann man mittels sogenannter „isoparametrischer Elemente“ den Rand approximieren.
				Man erlaubt nichtaffine Referenzabbildungen (Elemente der Triangulierungen nicht nicht-affine Bilder von Referenzsimplizes).
			\item
				Man kann FEM auch auf Vierecksgitter, allgemeinen polygonalen Triangulierungen, oder gemischten Typen aufbauen.
		\end{itemize}
	\end{note}
\end{df}

\begin{df}[Lokal polynomielle Räume] \label{3.62}
	Für $S \subset \R^d$ $s$-dimensionaler Simplex definieren den Raum der polynomiellen Funktionen bis Grad $k \in \N$ auf $S$ durch
	\begin{math}
		\P_k(S) := \Set{ p \in S \to \R & p(x) = \sum_{\beta \in \N_0^d, |\beta| \le k} a_\beta x^\beta, a_\beta \in \R },
	\end{math}
	wobei $x^\beta := x_1^{\beta_1} x_2^{\beta_2} \dotsb x_d^{\beta_d}$.
	Hiermit definieren wir global stetig, stückweise polynomielle Räume für $\scr T_h$
	\begin{math}
		P_k(\scr T_k)
		:= \Set{p \in C^0(\_\Omega) & p|_{T_i} \in \P_k(T_i), i \in I}
	\end{math}
	und Teilräume mit Nullrandwerten:
	\begin{math}
		P_{k,0}(\scr T_h)
		:= P_k(\scr T_h) \cap H_0^1(\Omega).
	\end{math}
\end{df}

\begin{lem}[Polynom in Baryzentrischen Koordinaten] \label{3.63}
	Sei $T$ ein $d$-dimensionaler Simplex.
	\begin{enumerate}[i)]
		\item
			Zu $p \in \P_k(T)$ exiestiert $\_p \in \P_k(\R^{d+1})$ der Gestalt
			\begin{math}
				\_p(\lambda) = \sum_{1 \le |\beta| \le k} d_\beta \lambda^\beta,
			\end{math}
			sodass $p(x) = \_p(\lambda(x))$ für alle $x \in T$ mit baryzentrischen Koordinaten $\lambda(x)$ aus \ref{3.58}.
		\item
			Zu $\_p \in \P_k(\R^{d+1})$ ist $\_p(\lambda(x))|_T \in \P_k(T)$.
	\end{enumerate}
	\begin{proof}
		Siehe [PDEMAS 13/14].
	\end{proof}
\end{lem}

\begin{st}[Lineares Finites Element, Courant Element] \label{3.64}
	Sei $T$ $d$-dimensionaler Simplex im $\R^d$ mit Ecken $a_0, \dotsc, a_d \in \R^d$ und $p_0, \dotsc, p_d \in \R$.
	Dann existert genau ein $p \in \P_1(T)$ mit $p(a_j) = p_j$ für $j = 0, \dotsc, d$.
	\begin{proof}
		Siehe Übung.
	\end{proof}
	\begin{note}
		Für $d = 1$ ist dies klar wegen eindeutiger Polynominterpolation (siehe Numerik 1, NLA).
		Für $d = 2$ ist dies anschaulich klar: Ebene durch drei Punkte in allgemeiner Lage.
		Für Numerik wählt man eine konkrete lokale $\Phi = \Set{\phi_0, \dotsc, \phi_d}$ von $\P_1(T)$, z.B. nodale Funktion zu den Ecken und schreibt $p \in \P_1(T)$ als Linearkombination dieser Basis.
		Die $\phi_j$ nennt man auch \emphdef{Formfunktion} (engl. “\emphdef{Shape Functions}”).
	\end{note}
\end{st}

\begin{st}[Existenz und Eindeutigkeit von $\P_1(\scr T_h)$ Interpolation] \label{3.65}
	Sei $\scr T_h$ zulässige Triangulierung mit Knoten $\scr E(\scr T_h) = \Set{v_i}_{i=1}^{n_{\scr E}}$, $n_{\scr E} := |\scr E(\scr T_h)|$.
	Sei $p_i \in \R, i = 1, \dotsc, n_{\scr E}$.
	Dann existiert genau ein $p \in \P_1(\scr T_h)$ mit $p(v_i) = p_i$ für $i = 1, \dotsc, n_{\scr E}$.
	\begin{proof}
		Lokal eindeutige Existenz ist klar nach \ref{3.64}, d.h. für alle $T \in \scr T_h$ existieren eindeutige Interpolationspolynome $p_T \in \P_1(T)$.
		Setze $p(x) : \Omega \to \R$ mit $p|_{T_i} := p_{T_i}$ für alle $T \in \scr T_h$.
		Es verbleibt globale Stetigkeit von $p$ zu zeigen:

		Seien $T, T'$ zwei Simplizes mit $S := T \cap T'$ $r$-dimensionales Seitensimplex, $r \ge 1$ ($r = 0$ trivial wegen der Interpolationsbedingung an den Ecken).
		Es existiert $\scr E(S) \subset \Set{v_i}_{i=1}^{n_{\scr E}}$, $|\scr E(S)| = r + 1$.
		Betrachte das Referenzsimplex $\hat S \subset \R^r$.
		Mit \ref{3.64} ist das Interpolationspolynom $\hat p \in \P_1(\hat S)$ durch $r + 1$ Werte eindeutig.
		Wegen Bijektion zwischen $\P_1(\hat S)$ und $\P_1(S)$ ist also das Interpolationspolynom $p|_S \in \P_1(S)$ eindeutig.
		Folglich ist $P_T|_S = p_{T'}|_S$, also ist $p$ stetig über Seitensimplizes hinweg.
	\end{proof}
\end{st}

\begin{df}[Lagrange-Basis, $k = 1$] \label{3.66}
	Sei $\scr T_h$ zulässige Triangulierung mit Knotenmenge $\scr E(\scr T_h) = \Set{v_i}_{i=1}^{n_{\scr E}}$.
	Dann existieren Funktionen $\phi_i \in \P_1(\scr T_h)$ mit $\phi_i(v_j) = \delta_{ij}$ für $i, j = 1, \dotsc, n_{\scr E}$.
	$\Set{\phi_i}_{i=1}^{n_{\scr E}}$ sind linear unabhängig und spannen $\P_1(\scr T_n)$ auf, also $\dim(\P_1(\scr T_h)) = n_{\scr E}$.

	$\phi_1, \dotsc, \phi_n$ nennen wir \emphdef{nodale Basis} oder \emphdef{Lagrange-Basis} von $\P_1(\scr T_h)$.
\end{df}

\begin{note}
	\begin{itemize}
		\item
			Man kann zeigen, dass $\P_1(\scr T_h) \subset H^1(\Omega)$ (siehe dazu [PDEMAS 13/14, Satz 4.17]) und
			\begin{math}
				\P_{1,0} (\scr T_h) = \Set{p \in \P_1(\scr T_h) & p(v_i) = 0, v_i \in \scr E(\scr T_h) \cap \Boundary \Omega }
				\subset H_0^1(\Omega).
			\end{math}
		\item
			Also ist $V_h = W_h = \P_{1,0}(\scr T_h)$ für Ritz-Galerkin für RWP mit Nullrandwerten für elliptische PDEs nach \ref{3.39} ein sinnvolle Wahl.
			Dies sind sogenannte \emphdef{Lineare Finite Elemente}.
			Wie bei FD sind Freiheitsgrade Funktionswerte an inneren Knoten.
	\end{itemize}
\end{note}

\begin{ex*}[Illustration]
	Für $n = 2$: $\phi_j(v_i) = \delta_{ij}$.
	$\phi_j$ ist eine Verallgemeinerung der Hütchenfunktion, stückweise linear und global stetig.
	\begin{math}
		\supp \phi_j = \bigcup_{i: v_j \in T_i} T_i.
	\end{math}
	\begin{itemize}
		\item
			Ein geringerer Polynomgrad ist sinnlos bei Forderung der Stetigkeit.
			\begin{math}
				\P_0(\scr T_h)
				= \Set{p: \Omega \to \R & p(x) = c, x \in \Omega, c \in \R},
			\end{math}
			also global konstant (für $\Omega$ zusammenhängend).
	\end{itemize}
\end{ex*}

\begin{df}[Lagrange-Gitter] \label{3.67}
	Sei $T$ $d$-dimensionaler Simplex mit Ecken $\scr E(T) = \Set{a_0, \dotsc, a_d}$.
	Wir definieren das \emphdef[Lagrange-Gitter]{Lagrange-Gitter der Ordnung $k$ von $T$} durch
	\begin{math}
		G_k(T)
		:= \Set{x = \sum_{j=0}^d \lambda_j a_j & \lambda_j \in \Set{\frac{i}{k} & i = 0, \dotsc, k}, \sum_{j=0}^d \lambda_j = 1}.
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				Für $k = 1$ ist $G_k(T) = \scr E(T)$, $|G_k(T)| = d + 1$.
			\item
				Für $k \ge 1$ ist $G_k(T) \supset \scr E(T)$, $|G_k(T)| = \binom{d+k}{k}$.
			\item
				Für alle $(d-1)$-dimensionalen Seitensimplizes $S \subset T$ gilt $|G_k(T) \cap S| = |G_k(S)| = \binom{d-1+k}{k}$.
			\item
				Offensichtlich gibt es eine Bijektion zwischen
				\begin{math}
					&\Set{\lambda \in \R^{d+1} & \lambda_j \in \Set{\frac{i}{k} & i = 0, \dotsc, k}, \sum_{i = 0}^d \lambda_i = 1} \\
					&\text{und} \quad
					\Set{\beta \in \N_0^d & |\beta| = k}
				\end{math}
				via $\lambda = \frac{\beta}{k}$.
		\end{itemize}
	\end{note}
\end{df}

% fixme: Zeichnungen mit $G_k(T)$
%\begin{ex*}
%	k = 1, k = 2, k = 3
%	d = 1, d = 2, d = 3
%\end{ex*}

\begin{lem}[Baryzentrisches Lagrange-Polynom] \label{3.68}
	Für $k \in \N, \beta = (\beta_l)_{l=0}^d, |\beta| = k, \lambda = (\lambda_l)_{l=0}^d \in \R^{d+1}$ definieren wir
	\begin{math}
		p_\beta(\lambda)
		:= \prod_{l=0}^d \prod_{j=0}^{\beta_l - 1} \dfrac{\lambda_l - \frac{j}{k}}{\frac{\beta_l}{k} - \frac{j}{k}}
	\end{math}
	Es gilt
	\begin{enumerate}[i)]
		\item
			$\deg p_\beta(\lambda) = k$, also $p_\beta(\lambda) \in \P_k(\R^{d+1})$,
		\item
			Für $\_\beta \in \N_0^{d+1}$ mit $|\_\beta| \le k$ gilt $p_\beta(\frac{\_\beta}{k}) = \delta_{\beta,\_\beta} := \prod_{l = 0}^d \delta_{\beta_l, \_\beta_l}$.
	\end{enumerate}
	\begin{proof}
		Setze
		\begin{math}
			p_{\beta,l}(\lambda_l) := \prod_{j=0}^{\beta_l - 1} \dfrac{\lambda_l - \frac{j}{k}}{\frac{\beta_l}{k}-\frac{j}{k}}.
		\end{math}
		\begin{enumerate}[i)]
			\item
				Es gilt $p_{\beta,l} \in \P_{\beta_l}(\R), \deg(p_{\beta_l}) = \beta_l$.
				Dann ist $\deg(p_\beta) = \sum_{l=0}^d \beta_l = k, p_\beta(\lambda) \in \P_k(\R^{d+1})$.
			\item
				Sei $\_\beta = \beta$.
				Dann ist $p_{\beta,l}(\frac{\_\beta_l}{k}) = 1$, also $p_\beta(\frac{\_\beta}{k}) = \prod_{l=0}^d 1 = 1$.
				Sei $\_\beta \neq \beta$, $|\_\beta| \le k$, dann existiert $l$ mit $\_\beta_l < \beta_l$.
				Es folgt $p_{\beta, l}(\frac{\_\beta_l}{k}) = 0$, da $\lambda_i - \frac{j}{k} = 0$ für $j = \_\beta_l$, also $p_\beta(\frac{\_\beta}{k}) = 0$.
		\end{enumerate}
	\end{proof}
\end{lem}

\begin{st}[Allgemeines simpliziales Lagrange Element] \label{3.69}
	Sei $T$ ein $d$-dimensionaler Simplex mit Lagrange-Gitter $G_k(T) = \Set{v_1, \dotsc, v_{n_k}}$ für $k \in \N, n_k := |G_k(T)|$.
	Für $p_1, \dotsc, p_{n_k}$ existiert genau ein $p \in \P_k(T)$ mit $p(v_i) = p_i$ für $i = 1, \dotsc, n_k$.
	\begin{note}
		$d = 1$ ist klar wegen 1d-Lagrange-Interpolation (Numerik 1).
	\end{note}
	\begin{proof}
		Siehe Übung.
	\end{proof}
\end{st}

\begin{st}[Existenz und Eindeutigkeit der $\P_k(\scr T_h)$ Interpolation] \label{3.70}
	Sei $\scr T_h$ zulässige Triangulierung von $\Omega \subset \R^d, k \in \N$.
	Die Vereinigung aller Lagrange-Gitter $G_k(\scr T_h) := \bigcup_{T \in \scr T_h} G_k(T) = \Set{v_i}_{i=1}^{m_k}$.
	Seien Werte $p_i \in \R$, $i = 1, \dotsc, m_k$ gegeben.
	Dann existiert genau ein $p \in \P_k(\scr T_h)$ mit $p(v_i) = p_i$ für $i = 1, \dotsc, m_k$.
	\begin{proof}
		Verläuft analog zum Fall $k = 1$ in \ref{3.65}.
	\end{proof}
\end{st}

\begin{df}[Lagrange-Basis, $k \ge 1$] \label{3.71}
	Sei $\scr T_h$ zulässige Triangulierung mit Lagrange-Punkten $G_k(\scr T_h) = \Set{v_i}_{i=1}^{m_k}$.
	Dann existieren Funktionen $\phi_i \in \P_k(\scr T_h)$, $i = 1, \dotsc, m_k$ mit $\phi_i(v_j) = \delta_{ij}$, $i = 1, \dotsc, m_k$.

	$\Phi := \Set{\phi_1, \dotsc, \phi_{m_k}}$ ist die \emphdef{Lagrange-Basis} oder \emphdef{nodale Basis} von $\P_k(\scr T_h)$.

	$\Phi_0 := \Set{\phi_i & v_i \not\in \Boundary \Omega}$ ist nodale Basis von $\P_{k,0}(\scr T_h)$ zur Knotenmenge $G_{k,0}(\scr T_h) := G_k(\scr T_h) \setminus \Boundary \Omega$.

	Wir setzen $m_k := \dim \P_k(\scr T_h), m_{k,0} := \dim \P_{k,0}(\scr T_h)$.
\end{df}

\begin{ex*}[Illustration]
	Sei $d = 1, \Omega  = (0,1)$.
	Für $k = 1$ erhalten wir die bekannten Hütchenfunktionen.

	Für $k = 2$ gibt es zwei Arten von Basis-Funktionen (für innere Knoten und für Eckknoten).
	Zu inneren Knoten hat $\phi_j$ die Gestalt einer nach unten geöffneten Parabel mit den Nachbarknoten als Nullstellen.
	Für Eckknoten sind dies nach oben geöffnete Parabeln (veranschauliche).
\end{ex*}

\Timestamp{2014-12-16}

\begin{df}[Lagrange FEM-Approximation] \label{3.72}
	Sei ein homogenes Dirichlet-RWP für eine PDE zweiter Ordnung wie in \ref{3.39} gegegben.
	Sei $\scr T_h$ zulässige Triangulierung mit inneren Lagrange-Knoten $G_{k,0}(\scr T_h)$ und nodalen Basisfunktionen $\Set{\phi_i}_{i=1}^{m_{k,0}}$.
	Setze $V_h := \Span \Set{ \phi_i }_{i=1}^{m_{k,0}} = \P_{k,0}(\scr T_h)$.

	Dann ist $u_h \in V_h$ die Lagrange-FEM Lösung der PDE, falls
	\begin{math}
		a(u_h,v) &= l(v), && v \in V_h
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				Wohlgestelltheit folgt mit Lax-Milgram wegen (Ritz-)Galerkin-Projektion eines koerziven Problems.
		\end{itemize}
	\end{note}
\end{df}

\begin{note}[Stokes-Diskretisierung]
	\begin{itemize}
		\item
			Für das Stokes-Sattelpunkt-Problem wird das sogenannte \emphdef{Mini-Element} definiert:
			Sei $T \subset \R^d$ ein Simplex, $Q(T) := \P_1(T), V(T) := (\P_1(T) \oplus \Span(\hat B_T))^d$ mit \emphdef{Bubble-Funktion}
			\begin{math}
				\hat B_T(x) &:= \prod_{i=0}^d \lambda_i(x),
			\end{math}
			also $B_T \in H_0^1(T) \cap \P_{d+1}(T)$ mit $\lambda_i: T \to \R$ baryzentrische Koordinaten.
		\item
			Damit kann man inf-sup-Stabilität für die Diskretisierung nachweisen:
			Sei $\scr T_h$ konform,
			\begin{math}
				V_h &:= \Set{v \in C^0(\Omega), \R^d) & v|_{\Gamma} = 0 \land \forall T \in \scr T_h : v|_{T} \in V(T)}, \\
				Q_h &:= \P_1(\scr T_h) \cap L^2_0(\Omega).
			\end{math}
			Dann existiert $\_\beta > 0$ unabhängig von $h$, aber abhängig von $d$ und $\sigma$:
			\begin{math}
				\inf_{q\in Q_h} \sup_{v\in V_h} \frac{b(q,v)}{\|q\|_{L^2}\|v\|_{(H_0^1)^d}} \ge \_\beta
			\end{math}
			für $b(q,v) := \int_\Omega q \div v$.
		\item
			Analoge Aussage gilt für die \emphdef{Taylor-Hood-Diskretisierung} der Ordnung $k$:
			\begin{math}
				V_h &:= (\P_{k,0}(\scr T_h))^d,
				Q_h &:= \P_{k-1}(\scr T_h) \cap L^2_0(\Omega)
			\end{math}
			Knobelaufgabe: Stokes ist nicht stabil mit $V_h = (\P_{1,0})^d, Q_h = \P_1 \cap L^2_0$.
		\item
			Mini-Element und Taylor-Hood stellen also stabile Diskretisierungen für Stokes dar.
	\end{itemize}
\end{note}

\begin{kor}[Wohlgestelltheit, Stokes] \label{3.73}
	Seien $V_h, Q_h$ wie beim Mini-Element, oder Taylor-Hood in obiger Bemerkung.
	Dann ist die Ritz-Galerkin-Projektion der Stokes-Gleichung aus \ref{3.41},
	\begin{math}
		a(u_h,v) + b(p,v) &= f(v), && \forall v \in V_h,
		b(q, u_h) &= g(q) && \forall q \in Q_h
	\end{math}
	wohlgestellt, d.h. es existiert eine eindeutige Lösung $u_h \in V_h, p_h \in Q_h$ mit
	\begin{math}
		\Big( \|u_h\|_{(H_0^1)^d}^2 + \|p_h\|_{L^2(\Omega)}^2 \Big)^{\frac{1}{2}}
		\le \frac{1}{\beta} \big( \|f\|^2 + \|g\|^2 \big)
	\end{math}
	für ein $\beta > 0$ (unabhängig von $h$).
	\begin{proof}
		Wegen inf-sup-Stabilität von $b(\argdot, \argdot)$ folgt die Behauptung mit dem Brezzi-Theorem \ref{3.43}.
	\end{proof}
\end{kor}


\subsection*{Quadraturen/Assemblierung}

Für das Aufstellen des LGS, d.h. Berechnung von $A_h, b_h$, auch „Assemblierung“ genannt, werden Integrale
\begin{math}
	&\int_\Omega (A(x)) \Nabla \phi_i \cdot \Nabla \phi_j, &
	&\int_\Omega f \phi_i, &
	&\int_{\Boundary \Omega} g_N \phi_i
\end{math}
durch Quadraturen berechnet, bzw. approximiert.
Es genügt, Quadraturen auf dem Referenzelement $\hat T$ zu definieren, welche dann auf beliebige Simplizes transformiert und zu einer zusammengesetzten Quadratur für Gebietsintegrale kombiniert werden.

\begin{df}[Quadratur auf Referenzelement] \label{3.74}
	Sei $\hat T \subset \R^d$ das Referenzsimplex, $\hat x_1, \dotsc, \hat x_l \in \hat T$ \emphdef{Quadraturpunkte}, $\omega_1, \dotsc, \omega_l \in \R$ \emphdef{Gewichte}.
	Dann heißt
	\begin{math}
		\tilde I(g) := \sum_{i=1}^l \omega_i g(\hat x_i)
	\end{math}
	\emphdef{Quadratur} für $g \in C^0(\hat T)$.

	Sei $I(g) := \int_{\hat T} g(\hat x) \di[\hat x]$, dann heißt $\tilde I$ \emphdef{exakt} auf $\P_k(\hat T)$ oder \emphdef[Ordnung]{von Ordnung mindestens $k$}, wenn
	\begin{math}
		I(g) &= \tilde I(g), && \forall g \in \P_k(\hat T).
	\end{math}
\end{df}

\begin{ex*}
	\begin{itemize}
		\item
			Mittelpunktsintegration:
			Sei $d \in \N$, $x_S := \frac{1}{d+1} \Vector{1 & \dots & 1}$ der \emphdef{Schwerpunkt} von $\hat T$.
			Dann ist
			\begin{math}
				\tilde I(g) := |\hat T| g(x_S)
			\end{math}
			exakt auf $\P_1(\hat T)$.
		\item
			Sei $d = 2$, Kantenmittelpunkte $m_{ij} := \frac{1}{2}(e_i + e_j)$, $i,j = 0, \dotsc, 2$.
			Setze
			\begin{math}
				\tilde I(g) := \frac{1}{3} |\hat T| \sum_{i,j=0, i < j}^2 g(m_{ij}).
			\end{math}
			Diese Quadratur ist exakt auf $\P_2(\hat T)$.
		\item
			Sei $d = 2$,
			\begin{math}
				\tilde I(g) := \frac{1}{60} |\hat T| \Big( 3 \sum_{i=0}^2 g(e_i) + 8 \sum_{i,j=0, i < j}^2 g(m_{ij}) + 27 g(x_S) \Big)
			\end{math}
			ist exakt auf $\P_3(\hat T)$.
	\end{itemize}
\end{ex*}

\begin{note}[Quadraturen für Gebietsintegrale]
	\begin{itemize}
		\item
			Für $d$-dimensionales Simplex $T \subset \R^d$ mit Referenzabbildung $F_T: \hat T \to T, F_t(\hat x) = B_t \hat x + t_T$ (siehe \ref{3.60}) gilt
			\begin{math}
				\int_T g(x)
				= |\det B_T| \int_{\hat T} g(F_T(\hat x)) \di[\hat x]
				\approx |\det B_T| \tilde I(g \circ F_T)
				=: \tilde I_T(g)
			\end{math}
			$\tilde I_T$ ist exakt auf $\P_k(T)$ genau dann, wenn $\tilde I$ exakt auf $\P_k(\hat T)$ ist.
		\item
			Bei der Integration über Differentialausdrücke ist Achtung geboten:
			Transformation der Ableitungen ist notwendig:
			Es gilt $\phi \in C^1(T)$ genau dann, wenn $\hat \phi := \phi \circ F_T \in C^1(\hat T)$ und (mit $B := B_T$):
			\begin{math}
				\Nabla_{\hat x} \hat \phi(\hat x)
				= (D_{\hat x} \hat \phi(\hat x))^T
				= (D_x \phi D_{\hat x} F_T)^T
				= B^T \Nabla_x \phi,
			\end{math}
			also $\Nabla_x \phi = (B^T)^{-1} \Nabla_{\hat x} \hat \phi(\hat x)$, „Jacobian Inverse Transposed“.

			Damit gilt für die Steifigkeits-Matrix-Einträge:
			Für $i, j \in \Set{1, \dotsc, {m_{k,0}}}$:
			\begin{math}
				\int_T (\Nabla_x \phi_i)^T A \Nabla_x \phi_j
				= \int_{\hat T} (\nabla_{\hat x} \hat \phi_{\hat i}(\hat x))^T B^{-1} A (B^T)^{-1} \Nabla_{\hat x} \hat \phi_{\hat j} (\hat x) |\det B| \di[\hat x]
			\end{math}
			für geeignete $\hat i, \hat j \in \Set{1, \dotsc, n_k}$ und nodale Basis $\Set{\hat \phi_{\hat i}}_{\hat i = 1}^{n_k}$ von $\P_k(\hat T)$.
		\item
			Gebietsintegrale werden dann einfach approximiert durch zusammengesetzte Quadraturen
			\begin{math}
				\int_\Omega g(x) \di[x]
				= \sum_{T \in \scr T_h} \int_T g(x) \di[x]
				\approx \sum_{T \in \scr T_h} \tilde I_T(g)
				= \sum_{T \in \scr T_h} |\det B| \sum_{i=1}^l w_i g(F_t(\hat x_i)).
			\end{math}
		\item
			Die Ordnung der Quadratur sollte der (noch zu diskutierenden) FEM-Konvergenzordnung angepasst sein:
			sollte hoch genug sein, damit der Quadraturfehler nicht die Konvergenz der FEM (bei $h \to 0$) beeinträchtigt, andererseits nicht zu hoch, um nicht nicht zu viel Rechenzeit in die Quadratur zu verwenden.
	\end{itemize}
\end{note}

\begin{note}[Effiziente Assemblierung über lokale Beiträge]
	\begin{itemize}
		\item
			Direkte Berechnung der Steifigkeitsmatrix ist sehr teuer.
			Betrachte dazu das Poisson-Problem
			\begin{math}
				a_{ij} = \int_\Omega (\Nabla \phi_i)^T \Nabla \phi_j
				= \sum_{T \in \scr T_h} \int_T (\Nabla \phi_i)^T \Nabla \phi_{j}
			\end{math}
			für $i,j = 1, \dotsc, m_{k,0}$.
			Für $k = 1$ ist $|\scr T_h| = \LandauO(m_{k,0})$, also für die Gesamtkomplexität zur Aufstellung von $A_h$: $\LandauO(m_{k,0}^3)$.
			Dies ist impraktikabel für große $m_{k,0}$.
		\item
			Nutze stattdessen die „Lokalität“ der Basisfunktionen und eine globale Indexabbildung.
		\item
			Die globale Indexabbildung beschreibt den Zusammenhang zwischen lokalen und globalen Indizes und stellt eine entsprechende Abbildung sicher:
			Sei $n_k := \dim \P_k(\hat T)$ mit lokaler Basis $\Set{\hat \phi_{\hat i}}_{\hat i = 1}^{n_k}$ von $\P_k(\hat T)$.
			Sei $\hat g: \scr T_h \times \Set{1, \dotsc, n_k} \to \Set{1, \dotsc, m_k}$ derart, dass für die globale Basis $\Set{\phi_i}_{i=1}^{m_k}$ von $\P_k(\scr T_h)$ gilt
			\begin{math}
				\hat \phi_{\hat i}(\hat x) &= \phi_i(F_T(\hat x)), &
				i = \hat g(T, \hat i)
			\end{math}
			für $T \in \scr T_h, \hat i \in \Set{1, \dotsc, n_k}$.
			Hierbei ist $\hat i$ der \emphdef[lokaler Index]{lokale Index}, $i$ der \emphdef[globaler Index]{globale Index} der Basisfunktionen.

			Hiermit ist die Kenntnis der $\Set{\phi_i}_{i=1}^{m_k}$ niemals explizit notwendig.
			Es genügt, eine Basis $\Set{\hat \phi_{\hat i}}$ auf dem Referenzelement festzulegen.
\Timestamp{2014-12-19}
		\item
			Umformulieren der Matrixeinträge:
			\begin{math}
				a_{ij} &:= \int\limits_{\supp(\phi_i) \cap \supp(\phi_j)} (\Nabla \phi_i)^T \Nabla \phi_j \di[x] \\
				&= \sum_{\substack{T\in \scr T_h \\ T \subset\supp(\phi_i) \cap \supp(\phi_j)}} \int_T (\Nabla \phi_i)^T \Nabla \phi_j \di[x] \\
				&= \sum_{\substack{T\in \scr T_h \\ T \subset\supp(\phi_i) \cap \supp(\phi_j)}} \underbrace{\int_{\hat T} |\det B| (\Nabla \hat \phi_{\hat i})^T B^{-1} (B^T)^{-1} \Nabla \hat \phi_{\hat j} \di[\hat x]}_{=: \hat a_{\hat i, \hat j, T}}
			\end{math}
			mit $\hat i, \hat j \in \Set{1, \dotsc, n_k}$ derart, dass $\hat g(T,\hat i) = i, \hat g(T, \hat j) = j$.
		\item
			Statt Schleife über $i,j$, führe Schleife über $T \in \scr T_h$ aus, um dann mit einer Schleife über $\hat i, \hat j$ eine lokale Steifigkeitsmatrix $A_{h, T} \in \R^{n_k \times n_k}$ zu berechnenn:
			\begin{math}
				A_{h,T} = (\hat a_{\hat i, \hat j, T})_{\hat i, \hat j = 1}^{n_k}
			\end{math}
		\item
			Assembliere die globale Steifigkeitsmatrix $A_h$ durch Addition der lokalen Beiträge auf entsprechende Einträge von $A_h$ (mit Hilfe der Index-Abbildung $\hat g$):
			\begin{algorithmic}
				\State $A_h \gets 0$
				\For{$T \in \scr T_h$}
					\State berechne $A_{h,T}$
					\For{$\hat i, \hat j = 1, \dotsc, n_k$}
						\State $(A_h)_{\hat g(T,\hat i), \hat g(T, \hat j)} \gets (A_h)_{\hat g(T,\hat i), \hat g(T, \hat j)} + (A_{h,T})_{\hat i, \hat j}$
					\EndFor
				\EndFor
			\end{algorithmic}
			Die Gesamtkomplexität ist also $\LandauO(|\scr T_h| n_k^2) = \LandauO(m_{k,0} n_k^2)$, eine wesentliche Verbesserung gegenüber $\LandauO(m_{k,0}^3)$.
		\item
			Ähnlich ist die Assemblierung der rechten Seite $b_h$ simultan mit $A_h$ möglich, d.h. ohne zusätzliche Schleife.
			Ein „einzelner Gitterdurchlauf“ genügt also zur Assemblierung des Systems $A_h, b_h$.
	\end{itemize}
\end{note}

\begin{note}[Struktur der Steifigkeitsmatrix]
	\begin{itemize}
		\item
			$A_h$ ist dünn-besetzt:
			sobald $\supp \phi_i \cap \supp \phi_j = \emptyset$, ist $(A_h)_{ij} = 0$.

			Konkreter für $k = 1$ (lineare FEM):
			Sei $r$ die maximale Kantenzahl aus einem Knoten.
			Dann gibt es höchstens $r+1$ nichtnull-Einträge in jeder Zeile von $A_h$.

			Ähnlich gilt für $k > 1$ die obere Schranke $r |G_k(T)|$ (ein Gitterpunkt mit jeweils höchstens $G_k(T)$ Basisfunktionen in höchstens $r$ Nachbarzellen).

			Dies ist wichtig für die Implementierung mittels Sparse-Matrizen:
			Es muss bei der Verfeinerung des Gitters insbesondere darauf geachtet werden, dass $r$ nicht unbegrenzt wächst.
		\item
			„\emphdef{Innere Kondensation} / \emphdef{statische Kondensation}“:
			Bei $k \ge d + 1$ gibt es Lagrange-Knoten im Inneren eines Simplex.
			Die entsprechenden Zeilen der Matrix haben nur Einträge für Knoten desselbe Simplex, nicht seiner Nachbarn.
			Das kann ausgenutzt werden, indem nach inneren Freiheitsgraden aufgelöst wird.
			Durch Zeilenumformungen entsteht ein System, das nur Unbekannte auf Seitensimplizes umfasst.
			Nach Lösen dieses Systems können die DOFs zu inneren Lagrange-Knoten aus kleinen Systemen der Größe $|G_k(T)|$ bestimmt werden.
	\end{itemize}
\end{note}

\begin{note}[Verallgemeinerungen]
	\begin{itemize}
		\item
			Allgemeine Definition:
			\begin{enumerate}[(i)]
				\item
					Sei $T \subset \R^d$ beschränkte, abgeschlossene Menge mit nicht-leerem Inneren und Lipschitz-Rand, die sogenannte Elementgeometrie.
				\item
					$\Phi = \Set{\phi_1, \dotsc, \phi_k}$ linear unabhängige Funktionen auf $T$, sogenannte \emphdef{Formfunktionen} (engl. „\emphdef{shape functions}“).
					$\scr P := \Span (\Phi)$ zugehöriger diskreter Funktionenraum mit $\dim (\scr P) = k$.
				\item
					$\scr N = \Set{N_1, \dotsc, N_k}$ eine Basis von $\scr P'$ die \emphdef{Menge der lokalen Freiheitsgrade}.
			\end{enumerate}
			Dann heit das Tripel $(T, \Phi, \scr N)$ \emphdef{Finites Element}.
		\item
			Die lokalen Freiheitsgrade $\scr N$ heißen \emphdef{nodale Variable} und $\Phi$ \emphdef{nodale Basis} falls $N_i(\phi_j) = \delta_{ij}$ für $i,j = 1, \dotsc, k$.
		\item
			Die Definition erfasst die Lagrange-FEM, ist also eine echte Verallgemeinerung:

			$T$ entspricht dem Simplex, $k := n_{\_k} = |G_{\_k}(T)|$ für Lagrange-Gitter $G_{\_k}(T) = \Set{v_i}_{i=1}^{n_{\_k}}$.
			Sei $\Phi$ eine nodale Basis von $\P_k(T)$, d.h. $\phi_j(v_i) = \delta_{ij}$.
			Setze $N_i(p) := p(v_i)$ für $p \in \P_{\_k}(T)$, $i = 1, \dotsc, k$.
			Dann ist $N_i(\phi_j) = \phi_j(v_i) = \delta_{ij}$, also $\Set{N_i}$ nodale Variablen.
		\item
			Statt Simplizes sind auch andere Geometrische Elemente möglich: Würfel, Rechtecke, etc.
			Hier verwendet man statt linearen Formfunktionen bi- oder trilineare Funktionen, z.B. $T = [0,1]^d \in \R^d$.
			Man setzt
			\begin{math}
				Q_1(T) := \bigotimes_{i=1}^d \P_1([0,1]).
			\end{math}
			Für $d = 2$ hat $p \in Q_1(T)$ also die Gestalt
			\begin{math}
				p(x_1,x_2) = a + bx_1 + cx_2 + d,
			\end{math}
			es tauchen \emph{nicht} quadratische Terme der Form $x_1^2, x_2^2$ auf.
			Für das Einheitsquadrat mit Knoten $a_0, \dotsc, a_3$ ergibt sich
			\begin{math}
				\Phi &= \Set{\phi_1, \dotsc, \phi_4}
				= \Set{ (1-x_1)(1-x_2), x_1(1-x_2), x_1, x_2, (1-x_1)x_2 } \\
				\scr N &= (N_1(p), \dotsc, n_4(p))
				= ( p(a_0), p(a_1), p(a_2), p(a_3) ).
			\end{math}
			Analog für $d = 3$, oder bi-/triquadratischen Elementen $Q_2$.
		\item
			Statt Punktauswertungen sind auch Ableitungsauswertungen möglich:
			\emphdef{kubisches Hermite Element} auf Dreieck $T \subset \R^2$ mit Ecken $a_0, a_1, a_2$ und Schwerpunkt $x_S$.
			Dann ist durch die Vorgabe von $p(a_i), \Nabla p(a_i), p(x_S)$ eindeutig ein Polynom $p \in \P_3(T)$ definiert, somit $k = 10$.
			Zu
			\begin{math}
				(N_1(p), \dotsc, N_{10}(p))
				:= \Big(
				& p(a_0), p(a_1), p(a_2), p(x_S), \\
				&\partial_{x_1} p(a_0), \dotsc, \partial_{x_1} p(a_2), \\
				& \partial_{x_2} p(a_0), \dotsc, \partial_{x_2} p(a_2) \Big)
			\end{math}
			existiert eine eindeutige Basis $\Phi = \Set{\phi_1, \dotsc, \phi_k}$ von $\P_3(T)$ mit $N_i(\phi_j) = \delta_{ij}$.
			Zusammengesetzte Funktionen aus kubische Hermite-Elemente auf zulässigen Gittern sind global $H^1$, aber nicht $H^2$.
		\item
			Ein Element, welches durch Zusammensetzen eine $H^2(\Omega)$-Funktion ergibt, ist das \emphdef{Argyris-Element} (J. Argyris, verstorben 2004) auf Dreiecken.
			Sei $T \subset \R^2$ ein Dreieck, Knoten $a_0, a_1, a_2$, Kantenmittelpunkte $m_0, m_1, m_2$.
			Dann ist durch Angable von $p(a_i), \Nabla p(a_i), \Nabla^2 p(a_i), \Nabla p(m_i) n_i, i = 0, \dotsc, 2$ eindeutig ein Polynom $p \in \P_5(T)$ definiert, wobei $n_i$ äußerer Normalenvektor ist.
	\end{itemize}
\end{note}


\section{Approximationssätze und FEM-Fehlerabschätzungen} \label{sec:3.5}


\subsection*{Interpolationsabschätzungen}

Sei $I_h: V \to V_h$ ein linearer (Interpolations-)Operator mit Approximationsgüte $\|u - I_h u\| \le C h^r$ mit möglichst großem $r$, dann folgt mit Céa (bzw. Nečas)
\begin{math}
	\|u - u_h\| \le \frac{\gamma}{\alpha} \inf_{v\in V_h} \|u - v\|
	\le \frac{\gamma}{\alpha} \|u - I_h u\|
	\le \frac{\gamma}{\alpha} C h^r.
\end{math}
Dies liefert eine Fehlerschranke, Konvergenz und Konvergenzordnung für die Galerkin-Projektion.

\begin{itemize}
	\item
		Sei $I_h$ speziell Lagrange-Interpolation, $\Omega \subset \R^d$.
		Damit $I_h: H^m(\Omega) \to \P_k(\scr T_h)$ sinnvoll definiert ist, muss $H^m(\Omega)$ Punktauswertungen erlauben, d.h. $v \in H^m(\Omega)$ muss einen stetigen Repräsentanten $\tilde v \in C^0(\Omega)$ besitzen $\|v - \tilde v\|_{H^m(\Omega)} = 0$, dann kann die Punktauswertung von $\tilde v$ als Punktauswertung von $v$ definiert werden.
		Dies ergibt eine Bedingung an $d, m$.

		Erinnerung: für $d = 1, m = 1$ hat $v \in H^1(\Omega)$ stets einen stetigen Repräsentanten.

		Allgemeiner: Falls $m - \frac{d}{p} > 0$, so hat $v \in H_p^1(\Omega)$ einen stetigen Repräsentanten.
		Man nennt $m - \frac{d}{p}$ \emphdef{Sobolev-Index}.
		Die Aussage folgt aus dem zweiten Sobolevschen Einbettungssatz, siehe z.B. [Alt].

		Sei im Folgenden $d,m$ so, dass $I_h$ Lagrange-Interpolation wohldefiniert ist.
\end{itemize}


\Timestamp{2015-01-09}

\begin{df}[gebrochene Normen] \label{3.75}
	Sei $\scr T_h$ Triangulierung von $\Omega$.
	Wir definieren gitterabhängige Normen und Räume:
	\begin{math}
		H^m(\scr T_h) := \Set{v: \Omega \to \R & \forall T \in \scr T_h : v|_T \in H^m(T) }
	\end{math}
	mit Seminorm
	\begin{math}
		|v|_{H^m(\scr T_h)} := \Big( \sum_{T\in \scr T_h} |v|_{H^m(T)}^2 \Big)^{\frac{1}{2}}
	\end{math}
	und Norm
	\begin{math}
		\|v\|_{H^m(\scr T_h)} := \Big( \sum_{T\in \scr T_h} \|v\|_{H^m(T)}^2 \Big)^{\frac{1}{2}}
	\end{math}
\end{df}

\begin{st}[lokale Interpolation] \label{3.76}
	Sei $T \subset \R^d$ $d$-dimensionales Simplex, $\sigma_T \le \sigma_{\text{max}}$, Lagrange-Interpolation $I: H^k(T) \to \P_{k-1}(T)$ wohldefiniert zu dem Lagrange-Gitter $G_{k-1}(T)$.
	Dann existiert $C = C(k,d,\sigma_{\text{max}}$ sodass
	\begin{math}
		\|v - Iv\|_{H^k(T)} \le C |v|_{H^k(T)}
	\end{math}
	für alle $v \in H^k(T)$.
	\begin{proof}
		Verfeinerungen von PDEMAS 13/14, 4.28.
	\end{proof}
\end{st}

\begin{st}[Transformationsformeln] \label{3.77}
	Sei $T \subset \R^d$ $d$-dimensionales Simplex mit Referenzabbildung $F_T(\hat x) = B\hat x + t$.
	Für $v \in H^m(T)$ ist $\hat v = v \circ F_T \in H^m(\hat T)$ und es existiert $C = C(d,m)$ mit
	\begin{math}
		|\hat v|_{H^m(\hat T)} \le C \|B\| |\det B|^{-\frac{1}{2}} |v|_{H^m(T)}
	\end{math}
	\begin{proof}
		Siehe Übung.
	\end{proof}
\end{st}

\begin{st}[Interpolations-Abschätzung] \label{3.78}
	Sei $\scr T_h$ zulässige Triangulierung von $\Omega \subset \R^d$.
	Sei $\sigma_{\text{max}} > 0, h_{\text{max}} > 0$ sodass $\forall T\in \scr T_h, \sigma_{T} \le \sigma_{\text{max}}$, $h \le h_{\text{max}}$.
	Dann existiert $C = C(\Omega, \sigma_{\text{max}}, h_{\text{max}}, k, m, d)$ mit
	\begin{math}
		\|u - I_hu\|_{H^m(\scr T_h)} \le C h^{k-m} |u|_{H^k(\Omega)}
	\end{math}
	für alle $u \in H^k(\Omega), 0 \le m \le k$ mit Lagrange-Interpolation $I_h: H^k(\Omega) \to \P_{k-1}(\scr T_h)$ zu Lagrange-Gitter $G_{k-1}(\scr T_h)$.
	\begin{proof}
		Wir zeigen zunächst für $T \in \scr T_h$ und alle $u \in H^k(T)$
		\begin{math}[numbered] \label{eq:3.25}
			\|u - I_h u\|_{H^m(T)} \le C h^{k-m} |u|_{H^k(T)}.
		\end{math}
		Sei $\hat T$ das Referenzsimplex.
		Mit Transformationsformel \ref{3.77} und lokaler Interpolationsfehlerabschätzung \ref{3.76} folgt
		\begin{math}
			|u - I_h u|_{H^m(T)}
			&\stack{\ref{3.77}}{\le} C(d,m) \|B^{-1}\|^m \underbrace{|\det B^{-1}|^{-\frac{1}{2}}}_{=|\det B|^{\frac{1}{2}}} \underbrace{|\hat u - I \hat u|_{H^m(\hat T)}}_{\le \|\hat u - I\hat u\|_{H^k(T)}} \\
			&\stack{\ref{3.76}}{\le} C(d,m,k,\sigma_{\text{max}}) \|B^{-1}\|^m |\det B|^{\frac{1}{2}} |\hat u|_{H^k(\hat T)} \\
			&\stack{\ref{3.77}}{\le} C(d,m,k,\sigma_{\text{max}})  \|B^{-1}\|^m \|B\|^k |u|_{H^k(T)} \\
			&\le C(d,m,k,\sigma_{\text{max}}) \underbrace{\|B^{-1}\|^m \|B\|^m}_{\stack{3.60}{\le} (\frac{h_T h_{\hat T}}{\rho_{\hat T} \rho_T})^m = (\sigma_T \sigma_{\hat T})^m = C(\sigma_{\text{max}}, d)} \\
			& \qquad \underbrace{\|B\|^{k-m}}_{\stack{3.60}{\le} (\frac{h_T}{\rho_{\hat T}})^{k-m} \le C(d, m) h^{k-m}} |u|_{H^k(T)} \\
			&\le C(d,m,k,\sigma_{\text{max}}) |u|_{H^k(T)} h^{k-m}.
		\end{math}
		Es folgt für die Norm
		\begin{math}
			\|u - I_h u\|_{H^m(T)}^2
			= \sum_{l=0}^m |u - I_h u|_{H^l(T)}^2
			\le \sum_{l=0}^m (C h^{k-l} |u|_{H^k(T)})^2
		\end{math}
		Mit $h^{k-l} = h^{k-m} h^{m-l} \le h^{k-m} h_{\text{max}}^{m-l} \le C(h_{\text{max}}, m, l) h^{k-m})$ folgt
		\begin{math}
			\|u - I_h u\|^2
			\le C(d, m, k, \sigma_{\text{max}}, \sigma_{\text{max}}) (h^{k-m})^2 |u|_{H^k(T)}^2.
		\end{math}
		also ist \eqref{eq:3.25} lokal gezeigt.
		Durch Summation über alle $T \in \scr T_h$ folgt die Behauptung.
	\end{proof}
	\begin{note}
		Für $d = 2, I_h: H^2(\Omega) \to \P_1(\scr T_h)$ gilt also
		\begin{math}
			\|u - I_h u\|_{H^1(\scr T_h} &\le C h |u|_{H^2(\Omega)} & &(m = 1, k=2) \\
			\|u - I_h u\|_{L^2(\Omega)} & \le C h^2 |u|_{H^2(\Omega)} & &(m = 0, k=2).
		\end{math}
		Ähnliche Aussagen sind auch für Dreiecksgitter und bilineare Elemente möglich.
	\end{note}
\end{st}

\begin{df}[Charakterisierung von Gittersequenzen] \label{3.79}
	Eine Folge $\Set{\scr T_i}_{i \in \N}$ mit $\lim_{i \to \infty} h_i = 0$ für $h_i := h(\scr T_i)$ heißt
	\begin{itemize}
		\item
			\emphdef{nicht-entartet}, falls $\sigma_{\text{max}} > 0$ existiert mit $\sigma_T := \frac{h_T}{\rho_T} < \sigma_{\text{max}}$ für alle $T \in \scr T_i, i \in \N$.
		\item
			\emphdef{quasi-uniform}, falls $\sigma_{\text{max}} > 0$ existiert mit $\frac{h_i}{\rho_T} \le \sigma_{\text{max}}$ für alle $T \in \scr T_i, i \in \N$.
	\end{itemize}
	\begin{note}
		\begin{itemize}
			\item
				quasi-unform impliziert nicht-entartet.
			\item
				Eine Sequenz kann durchaus nicht-entartet, aber trotzdem nicht quasi-uniform sein (z.B. bei geeigneter lokaler Verfeinerung).
			\item
				Quasi-Uniformität bedeutet, es existiert eine Konstante $C > 0$ mit
				\begin{math}
					h_T \le h_i \le C h_T.
				\end{math}
			\item
				In nicht-entarteten Gittern sind innere Winkel nach unten beschränkt durch $\phi_{\text{min}} > 0$.
		\end{itemize}
	\end{note}
\end{df}

\begin{kor}[Konvergenz der Interpolation] \label{3.80}
	Sei $\Set{\scr T_i}_{i \in \N}$ nicht-entartet, $h_{\text{max}} := \max_{i} h_i$, $\lim_{i \to \infty} h_i = 0$ und $I_h: H^k(\Omega) \to \P_{k-1}(\scr T_i)$ Lagrange-Interpolation.
	Dann gilt
	\begin{math}
		\lim_{i\to \infty} \|u - I_h u\|_{H^m(\scr T_i} = 0
	\end{math}
	für alle $u \in H^m(\Omega), 0 \le m \le k-1$.
	\begin{proof}
		Klar mit \ref{3.78}: das dortige $C$ ist unabhängig von $i$, $h_i^{k-m} \le h_i h_{\text{max}}^{k-m-1}$ also
		\begin{math}
			\lim_{i\to \infty} h_i^{k-m}
			= h_{\text{max}}^{k-m-1} \lim_{i\to \infty} h_i
			= 0.
		\end{math}
	\end{proof}
	\begin{note}
		Die Interpolations-Abschätzung \ref{3.78} liefert
		\begin{math}
			\|u - I_h u\|_{H^m(\scr T_h} &\le C h^{k-m} \|u\|_{H^k(\Omega)}, & & 0 \le m \le k,
		\end{math}
		also wird der Interpolations-Fehler in einer „schwächeren“ Norm gemessen und durch eine „stärkere“ Norm von $u$ abgeschätzt; man gewinnt $h$-Potenzen.

		Sogenannte \emphdef{inverse Abschätzungen} leisten das Umgekehrte, indem man $h$-Potenzen „opfert“, gelten aber nur für FEM-Funktionen (nicht für den ganzen Sobolev-Raum).
	\end{note}
\end{kor}

\begin{st}[Inverse Abschätzung] \label{3.81}
	Sei $\scr T_h$ quasi-uniforme Triangulierung, $\sigma_{\text{max}} > 0, \sigma_T \le \sigma_{\text{max}}$ für alle $T \in \scr T_h$ und $k \in \N$.
	Dann existiert $C = C(\sigma_{\text{max}}, k, m)$ mit
	\begin{math}
		\|v_h\|_{H^k(\scr T_h)} \le C h^{m-k} \|v_h\|_{H^m(\scr T_h)}
	\end{math}
	für alle $v_h \in \P_k(\scr T_h)$, $0 \le m \le k$.
	\begin{proof}
		Für $d = 1$ siehe Übung.
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Für $d = 2$ und linearen Elementen gilt also via $k = 1, m = 0$
				\begin{math}
					\|v_h\|_{H^1(\Omega)}
					\le C h^{-1} \|v_h\|_{L^2(\Omega)}
				\end{math}
				für alle $v_h \in \P_1(\scr T_h)$.
				Diese Abschätzung gilt auch für stetige stückwese bilinearen Elementen auf viereckigen Gittern.
			\item
				Genaure Betrauchtung des Beweises (siehe PDEMAS 13/14) ergibt, dass $C$ nicht nur mit $\sigma_{\text{max}}$ wächst, sondern auch mit dem Verhältnis von größtem zu kleinstem Simplexduchmesser.
				Sei $M > 0$ mit $\frac{h}{h_T} \le M$ für alle $T \in \scr T_h$.
				Dann skaliert $C$ mit $M^{k-m}$.
			\item
				Daher kann für $\Set{\scr T_i}_{i\in \N}$ quasi-uniform obiges $C$ konstant für alle $i$ gefunden werden.
			\item
				Einfaches Beispiel für $\Set{\scr T_i}_{i\in\N}$ mit $M_i := M(\scr T_i) \to \infty$, d.h $C \to \infty$ erforderlich:
				Sei $\Omega := \hat T \subset \R^2$.
				Die Verfeinerung sei durch Viertelung (des Dreiecks am Ursprung) definiert.
				Es gilt
				\begin{math}
					h = \max_{T \in \scr T_i} h_T = \frac{\sqrt 2}{2}
				\end{math}
				unabhängig von $i$.
				Für den Achsenabschnitt des kleinsten Dreiecks gilt $h_i = 2^{-i}$ in $\scr T_i$.
				Es folgt
				\begin{math}
					\frac{h}{h_T} \le 2^{i-1} =: M_i \to \infty.
				\end{math}
				Sei $v_i \in \P_i(\scr T_i)$ nodale Basisfunktion zu $\Vector{0 & 0}$.
				\begin{math}
					v_i(x,y) = 1 - \frac{x}{h_i} - \frac{y}{h_i}.
				\end{math}
				Betrachte $k = 1, m = 0$.
				\begin{math}
					\|v_i\|_{L^2}^2 = \int_0^{h_i} \int_{0}^{h_i - y} v_i(x,y)^2 \di[x] \di[y] = \frac{h_i^2}{12},
				\end{math}
				d.h. $\|v_i\|_{L^2} = \frac{h_i}{\sqrt{12}}$.
				\begin{math}
					\partial_x v_i = \partial_y v_i &= -\frac{1}{h_i},
					|v_i|_{H^1}^2 &= \frac{2}{h_i^2} |\supp v_i| = 1 \\
					\|v_i\|_{H^1} &= \sqrt{1 + \frac{h_i^2}{1,}}.
				\end{math}
				Gesucht ist $C$ sodass
				\begin{math}
					\|v_h\|_{H^1} \le C h \|v_h\|_{L^2}.
				\end{math}
				Zwangsläufig skaliert $C$ mit $\LandauO(\frac{1}{h_i})$, insbesondere $C \to \infty$.
			\item
				Falls $\frac{h}{h_{\text{min}}} \le M$, $h_{\text{min}} = \min_{T \in \scr T_i} h_T$.
				Dann ist
				\begin{math}
					h_{\text{min}} \le h \le M h_{\text{min}}.
				\end{math}
				Daher kann man in der inversen Abschätzung auch $h_{\text{min}}$ statt $h$ schreiben.
		\end{itemize}
	\end{note}
\end{st}

\section{FEM a-priori Abschätzungen}

\begin{st}[FEM a-priori Fehlerschranke in $H^1$] \label{3.82}
	Sei $a(\argdot, \argdot)$ koerziv, stetig, $l(\argdot)$ stetig auf $H_0^1(\Omega)$, $\Omega \subset \R^d$ beschränkt, polygonal berandet und $u \in H_0^1(\Omega)$ eindeutige schwache Lösung.
	Sei $\scr T_h$ zulässige Triangulirung mit $\sigma_{\text{max}} > 0, \sigma_T \le \sigma_{\text{max}}$ für alle $T \in \scr T_h, u_h \in V_h := \P_{k,0}(\scr T_h)$ Lagrange FEM-Lösung.

	Falls $s \in \N$ existiert mit
	\begin{enumerate}[i)]
		\item
			$1 \le s \le k$ und
		\item
			$u \in H^{s+1}(\Omega) \cap H_0^1(\Omega)$,
	\end{enumerate}
	so gilt die Fehlerschranke
	\begin{math}
		\|u - u_h\|_{H^1(\Omega)}
		\le C h^s \|u\|_{H^{s+1}(\Omega)},
	\end{math}
	wobei $C = C(\sigma_{\text{max}}, k, d, \Omega)$.
	\begin{proof}
		Lemma von Céa liefert
		\begin{math}
			\|u - u_h\| \le \frac{\gamma}{\alpha} \|u - I_hu\|
		\end{math}
		für Lagrange-Interpolation $I_h: H^{s+1}(\Omega) \to \P_1(\scr T_h)$.
		Die Interpolations-Abschätzung \ref{3.78} liefert mit $m = 1, k = s + 1$
		\begin{math}
			\|u - u_h\|_{H^1(\scr T_h)}
			= \|u - u_h\|_{H^m(\scr T_h)}
			\le C h^{k-m} |u|_{H^k(\Omega)}
			\le C h^s \|u\|_{H^{s+1}(\Omega)}
		\end{math}
	\end{proof}
\end{st}

\begin{kor}[Konvergenz von FEM] \label{3.83}
	Sei $\Set{\scr T_i}_{i\in \N}$ nicht-entartet mit $\lim_{i \to \infty} h_i = 0, \sigma_T \le \sigma_{\text{max}}$ für alle $T \in \scr T_i, i \in \N$ und die Voraussetzungen von \ref{3.82} für alle $\scr T_i$ erfüllt, dann gilt
	\begin{math}
		\lim_{i \to \infty} u_{h_i} = u.
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				Um $u \in H^{s+1}$ zu garantieren, wären zusätzliche Regularität von $\Boundary \Omega$ und $f \in H^{s+1}(\Omega)$ für $l(v) = \int_\Omega f v$ notwendig (Satz von Friedrichs zu $H^2$-Regularität \ref{3.30} und dortige Bemerkung).
			\item
				Für lineare FEM ($k = 1$) benötigen wir also $H^2(\Omega)$-Regularität, dann gilt \emphdef{lineare Konvergenz} in $h$ bezüglich der $H^1$-Norm:
				\begin{math}
					\|u_h\|_{H^1(\Omega)} \le \const h \|u\|_{H^2(\Omega)}
					\stack{\ref{3.29}}{\le} \const h \|f\|_{L^2(\Omega)}
				\end{math}
			\item
				Für polygonal berandete Gebiete kann also eigentlich keine $H^3$-Regularität garantiert werden, denn $\Boundary \Omega$ ist nicht $C^3$.
				Also kann man für quadratische oder kubische FEM in diesem Fall keine bessere Fehlerordnung garantieren.
				In der Praxis funktionieren quadratische und kubische Elemente aber trotzdem sehr gut und sind linearen Elementen zu bevorzugen.
		\end{itemize}
	\end{note}
\end{kor}

\Timestamp{2015-01-13}

Wegen $\|\argdot\|_{L^2} \le \|\argdot\|_{H^1}$ folgt \ref{3.82} sofort eine triviale $L^2$-Abschätzung derselben Ordnung.
Diese ist nicht optimal: man kann eine $h$-Potenz gewinnen mittels eines Dualitätsargumentes („Aubin-Nitsche-Trick“).

\begin{st}[Aubin-Nitsche] \label{3.84}
	Sei $H$ ein Hilbertraum mit Norm $\|\argdot\|_{H}$ und Skalarprodukt $\<\argdot, \argdot\>_H$.
	Sei $V \subset H$ Unterraum, der mit Skalarprodukt $\<\argdot, \argdot\>_V$ und Norm $\|\argdot\|_{V}$ Hilbertraum ist.
	Sei eine Einbettung $V \injto H$ stetig, d.h. $\|v\|_H \le C \|v\|_V$ für alle $v \in V$.
	Sei $u \in V$ Lösung der schwachen Form $a(u,v) = \<f,v\>_{H}$ für alle $v \in V$ mit $a(\argdot, \argdot)$ stetig mit Konstante $\gamma$ und koerziv auf $V$.

	Dann gilt für die Galerkin-Projektion $u_h \in V_h \subset V$
	\begin{math}
		\|u - u_h\|_{H} \le \gamma \|u - u_h\|_V \sup_{g \in H \setminus \Set 0} \Set{\frac{1}{\|g\|} \inf_{v_h \in V_h} \|\phi_g - v_h\|_{V}},
	\end{math}
	wobei zu jedem $g \in H$ die duale Lösung $\phi_g \in V$ erfüllt
	\begin{math}
		a(w,\phi_g) &= \<g, w\>_H, && \forall w \in V
	\end{math}
	\begin{proof}
		Mit Cauchy-Schwartz gilt für alle $g \in H \setminus \Set 0, w \in V$
		\begin{math}
			\<g, w\>_H &\le \|g\|_H \|w\|_H
			&&\implies&
			\|w\|_H &\ge \frac{\<g,w\>_H}{\|g\|_H},
		\end{math}
		also $\|w\|_{H} \ge \sup_{g\in H \setminus \Set 0} \frac{\<g,w\>_H}{\|g\|_H}$ und für $g = w$ gilt Gleichheit, also
		\begin{math}
			\|w\|_H = \frac{\<w,w\>_H}{\|w\|_H}
			= \sup_{g \in H\setminus \Set 0} \frac{\<g,w\>_H}{\|g\|_H}
		\end{math}

		Setze in dualem Problem $w := u - u_h$, dann gilt mit Galerkin-Orthogonalität für alle $v_h \in V_h$
		\begin{math}
			\<g, u - u_h\>_H
			= a(u - u_h, \phi_g)
			= a(u - u_h, \phi_g - v_h)
			\le \gamma \|u - u_h\|_V \|\phi_g - v_h\|_V.
		\end{math}
		Dualitätsargument liefert
		\begin{math}
			\|u - u_h\|_{H}
			= \sup_{g \in H \setminus \Set 0} \frac{\<g, u - u_h\>}{\|g\|_H}
			\le \gamma \|u-u_h\|_V \sup_{g \in H\setminus \Set 0} \frac{\|\phi_g - v_h\|_V}{\|g\|_H}.
		\end{math}
	\end{proof}
\end{st}

\begin{st}[FEM a-priori $L^2$-Abschätzung] \label{3.85}
	Unter den Vorausssetzungen von \ref{3.82} (a-priori $H^1$-Abschätzung) gilt
	\begin{math}
		\|u - u_h\|_{L^2(\Omega)}
		\le C h \|u - u_h\|_{H^1(\Omega)},
	\end{math}
	also insbesondere im Fall von $H^{s+1}(\Omega)$-Regularität
	\begin{math}
		\|u - u_h\|_{L^2(\Omega)} \le C h^{s+1} \|u\|_{H^{s+1}(\Omega)}
		\le C h^{s+1} \|f\|_{H^{s-1}(\Omega)}
	\end{math}
	\begin{note}
		\begin{itemize}
			\item
				Für lineare FEM ($k = 1, s = 1$) folgt also im Fall von $H^2(\Omega)$-Regularität
				\begin{math}
					\|u - u_h\|_{L^2(\Omega)}
					\le C h^2 \|u\|_{H^2(\Omega)}.
				\end{math}
		\end{itemize}
	\end{note}
	\begin{proof}
		Wegen $H_0^1(\Omega) \subset L^2(\Omega)$, $\|v\|_{L^2} \le \|v\|_{H^1}$ ist die Einbettung $H_0^1(\Omega) \injto L^2(\Omega)$ stetig.
		Wende also Aubin-Nitsche \ref{3.84} an mit $H := L^2(\Omega), V := H_0^1(\Omega)$.
		Zu $g \in L^2(\Omega)$ sei $\phi_g$ schwache Lösung des dualen Problems.
		Für $I_h: H^2(\Omega) \to \P_1(\scr T_h)$ Interpolations-Operator gilt via \ref{3.78} (Interpolations-Abschätzung, $k = 2, m = 1$)
		\begin{math}
			= \|\phi_g - I_h \phi_g\|_{H^1(\Omega)}
			\le C h^{2 - 1} |\phi_g |_{H^2(\Omega)}
			\le C h \|\phi_g\|_{H^2(\Omega)}
			\stack{\ref{3.29}}{\le} C h \|g\|_{L^2(\Omega)}.
		\end{math}
		Mit Aubin-Nitsche folgt
		\begin{math}
			\|u - u_h\|_{L^2}
			\le C \|u - u_h\|_{H^1} \sup_{g \in L^2 \setminus \Set 0} \underbrace{\inf_{v_h \in V_h} \frac{\|\phi_g - v_h\|_{H^1}}{\|g\|_{L^2}}}_{\le C h \frac{\|g\|_{L^2}}{\|g\|_{L^2}}}
			\le C h \|u - u_h\|_{H^1}.
		\end{math}
		Damit ist die erste Behauptung bewiesen.
		Im Fall von $H^{s+1}(\Omega)$-Regularität folgen die übrigen Ungleichungen direkt mit der a-priori-Fehlerschranke \ref{3.82}.
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				Die $H^1$ und $L^2$-Fehleraussagen können keine lokal-große Fehler ausschließen.
				Dies ist mit einer $L^\infty$-Schranke möglich.
				Man kann z.B. für $d = 2$ und $\Set{\scr T_i}_{i \in \N}$ quasi-uniform zeigen, dass unter den Voraussetzungen \ref{3.82} gilt
				\begin{math}
					\sup_{x \in \Omega} |u(x) - u_h(x)|
					\le C h \|f\|_{L^2(\Omega)}.
				\end{math}
				\begin{proof}
					Siehe Übung.
				\end{proof}
				Diese Abschätzung ist nicht scharf, man kann z.B. für $d = 2$ zeigen, dass
				\begin{math}
					\|u - u_h\|_\infty C h^2 |\log h|^{\frac{3}{2}} \|D^2 u\|_\infty
				\end{math}
				und für $d = 3$ verschwindet der $\log$-Term sogar.
		\end{itemize}
	\end{note}
\end{st}

\begin{ex*}[Numerisches Beispiel]
	\Code{RBmatlab} benötigt, siehe \url{morepas.org}, release 1.13.10.
	Auch in \ref{chap:4} und Folgevorlesung relevant.

	\begin{seg}{\Code{demos\textunderscore fem(1)}, FEM-Lösung und Visualisierung}
		Betrachte das Poisson-RWP, $\Omega := (0,1)^2$, $-\Laplace u = f$, $u = 0$ auf $\Boundary \Omega$,
		\begin{math}
			f(x) = 32(x_1 + x_2 - x_1^2 - x_2^2).
		\end{math}
		Die exakte Lösung ist $u(x) = 16 x_1(1-x_1) x_2(1-x_2)$.
		FEM-Diskretisierung auf $\P_{2,0}(\scr T_h)$, $\scr T_h$ reguläres Dreiecksgitter.
		Es wird in der Implementierung $\P_2(\scr T_h)$ statt $\P_{2,0}(\scr T_h)$ für Darstellung von $u_h$ verwendet.
		Die zu Randknoten gehörenden Zeilen/Spalten der Systemmatrix werden auf Einheitsvektoren gesetzt, die Randknoten-Einträge der rechten Seite auf $0$ gesetzt.

		Das im Programm gelöste LGS (bis auf Permutation der Zeilen/Spalten) lautet
		\begin{math}
			\Matrix{ A_h & 0 \\ 0 & I }
			\Vector{\underbar{u}_h & \underbar{u}_{h,\Boundary \Omega}}
			= \Vector{ b_h & 0 }.
		\end{math}
		Hierdurch hat $u_h$ die richtigen Randwerte für die Visualisierung.
	\end{seg}
	\begin{seg}{\Code{demos\textunderscore fem(2)}, Konvergenzstudie}
		Sei $n_x = 2^i$ die Anzahl der Intervalle in $x_1, x_2$-Richtung mit $i= 1,2, \dotsc$.
		Es wird lineare und quadratische FEM durchgeführt.
		\begin{itemize}
			\item
				$\dim V_h = m_1$, also einschließlich Randknoten
			\item
				Konvergenzordnung wie erwartet:
				Halbierung von $h$ liefert bei $V_h = \P_1(\scr T_h)$ Halbierung des $H^1$-Fehlers und etwa Viertelung des $L^2$-Fehlers.
				Bei $V_h = \P_2(\scr T_h)$ sehen wir eine Viertelung des $H^1$-Fehlers und Achtelung des $L^2$-Fehlers.
			\item
				Bei identischer Anzahl Freiheitsgrade liefert eine höhere Ordnung der FEM bessere Ergebnisse.
				Die Assemblierung des Systems ist aufwändiger, da Matrix dichter besetzt.
		\end{itemize}
	\end{seg}
\end{ex*}

\Timestamp{2015-01-16}

\section{a-posteriori Fehlerschätzer und Gitteradaptivität}

Der Lagrange-Interpolations-Operator erfordert Punktauswertungen, also mindestens $H^2(\Omega)$ für $d = 2$.
Ein sogenannter Clément-Approximationsoperator bietet Approximationsmöglichkeit für $H^1(\Omega)$-Funktionen basierend auf lokale $L^2$-Projektionen.

\begin{df}[Clément-Approximation] \label{3.86}
	Sei $\scr T_h$ zulässige Triangulierung von $\Omega$.
	Zu jedem $v_i \in \scr E(\scr T_h) \setminus \Boundary \Omega = \Set{v_j}_{j=1}^{m_{1,0}}$ definiere die Vereinigung der angrenzenden Elemente
	\begin{math}
		\omega_i := \bigcup_{v_i \in T \in \scr T_h} T.
	\end{math}
	Für jedes $T \in \scr T_h$ definiere analog das \emphdef{Patch} der Nachbarn:
	\begin{math}
		\omega_T := \bigcup_{i \in \scr E(T)} \omega_i = \bigcup_{\substack{T' \in \scr T_h \\ T \cap T' \neq \emptyset}} T'.
	\end{math}
	Sei $V_h = \P_{1,0}(\scr T_h)$ mit nodaler Basis $\Set{\phi_i}_{i=1}^{m_{1,0}}$ und definiere Clément-Operator $C_h: H^1(\Omega) \to \P_{1,0}(\scr T_h)$ durch
	\begin{math}
		C_h v &:= \sum_{i=1}^{m_{1,0}} (P_i v(v_i)) \phi_i, && v \in H^1(\Omega)
	\end{math}
	mit $P_i: L^2(\omega_i) \to \P_0(\omega_i)$ orthogonale $L^2$-Projektion auf Konstanten.
	\begin{note}
		Falls $\Set{\scr T_i}_{i\in\N}$ nicht entartet, dann ist
		\begin{math}
			|\omega_T| \le C |T| \le C h_T^d
		\end{math}
	\end{note}
\end{df}

\begin{st}[Clément Approximation-Fehler] \label{3.87}
	Sei $\scr T_h$ zulässige Triangulierung mit $\sigma_{\text{max}} > 0, \sigma_{\text{max}} \ge \sigma_T$ für alle $T \in \scr T_h$.
	Dann exisiert $C = C(d, m, \sigma_{\text{max}})$ sodass für alle $T \in \scr T_h$ und alle Seitensimplizes $S \subset \Boundary T$
	\begin{enumerate}[i)]
		\item
			$\|v - C_h v\|_{H^m(T)} \le C h_T^{1-m} \|v\|_{H^1(\omega_T)}$ für $m \in \Set{0, 1}$.
		\item
			$\|v - C_h v\|_{L^2(S)} \le C h_T^{\frac 12} \|v\|_{H^1(\omega_T)}$.
	\end{enumerate}
	\begin{proof}
		Für Teil i) siehe Übung.
		Teil ii) folgt mit Spursatz (?).
	\end{proof}
\end{st}

Die FEM-Approximaiton $u_h \in V_h$ erzeugt in die starke Form der PDE eingesetzt ein „Residuum“.
Hieraus definieren wir a-posteriori Fehlerschätzer, welcher (bis auf Konstanten) obere und untere Schranken an den Fehler darstellen.
Im Folgenden betrachten wir das homogene Dirichlét-RWP für die Poisson-Gleichung.

\begin{df}[Residuale Fehlerschätzer] \label{3.88}
	Sei $\scr T_h$ zulässige Triangulierung, $u_h \in \P_{k,0}(\scr T_h) =: V_h \subset H_0^1$ FEM-Lösung des homogenen Dirichlet RWP für die Poisson-Gleichung.
	Definiere für $T \in \scr T_h$ das \emphdef{elementbezogenene Residuum} als
	\begin{math}
		R_T := R_T(u_h) =: \Laplace u_h + f
	\end{math}
	das \emphdef{kantenbezogene Residuum} der Ableitungssprünge
	\begin{math}
		R_S := R_S(u_h) := [ \pddx[n]{u_h} ]_S := \pddx[n]{u_h}\big|_{T_1} - \ddx[n]{u_h}\big|_{T_2}
	\end{math}
	für $S \subset T_1 \cap T_2$, $T_1 \cap T_2 \neq \emptyset$, $S \in S_0$ mit
	\begin{math}
		S_0 := \Set{S & \text{$S$ Seitensimplex, $S \subset \Boundary T, T \in \scr T_h, S \not\subset \Boundary \Omega$}}
	\end{math}
	Menge der inneren Kanten.
	Definieren \emphdef[Fehlerschätzer!lokaler]{lokalen Fehlerschätzer}
	\begin{math}
		\eta_{T,R} := \Big( h_T^2 \|R_T\|_{L^2(T)}^2 + \frac{1}{2} \sum_{S \subset \Boundary T \cap S_0} h_S \|R_S\|_{L^2(S)}^2 \Big)^{\frac{1}{2}}.
	\end{math}
	und den \emphdef[Fehlerschätzer!globaler]{globalen Fehlerschätzer}
	\begin{math}
		\eta_R := \Big( \sum_{T \in \scr T_h} \eta_{T, R}^2 \Big)^{\frac 12}
		= \Big( \sum_{T \in \scr T_h} h_T^2 \|R_T\|_{L^2(T)}^2 + \sum_{s \in S_0} h_s \|R_S\|_{L^2(S)}^2 \Big)^{\frac{1}{2}}
	\end{math}
\end{df}

\begin{st}[Obere a-posteriori Fehlerschranke] \label{3.89}
	Seien die Voraussetzungen wie in \ref{3.88}.
	Es existiert $C = C(\Omega, \sigma_{\text{max}})$ mit
	\begin{math}
		\|u-u_h\|_{H^2(\Omega)} \le C \eta_R.
	\end{math}
	\begin{proof}
		Für $w \in H_0^1(\omega)$ gilt
		\begin{math}
			l(w) &:= \<\Nabla(u - u_h), \Nabla w\>_{L^2(\Omega)} \\
			&= \underbrace{\<\Nabla u, \Nabla w\>_{L^2(\Omega)}}_{=\<f,w\>_{L^2(\Omega)}} - \< \Nabla u_h, \Nabla w\>_{L^2(\Omega)} \\
			&= \sum_{T\in \scr T_h} \<f, w\>_{L^2(T)} - \sum_{T \in \scr T_h} \underbrace{\<\Nabla u_h, \Nabla w\>_{L^2(T)}}_{= \<-\Nabla u_h, w\>_{L^2(T)} + \sum_{S \subset \Boundary T} \< \pddx[n]{u_h}, w \>_{L^2(S)}} \\
			&= \sum_{T \in \scr T_h} \< \Laplace u_h + f, w\>_{L^2(T)} + \sum_{S \in S_0} \underbrace{\< [\pddx[n]{u_h}], w\>_{L^2(S)}}_{=\<R_S, w\>_{L^2(S)}} \\
			&= \sum_{T \in \scr T_h} \<R_T, w\>_{L^2(T)} + \frac{1}{2} \sum_{T \in \scr T_h} \sum_{S \subset \Boundary T} \<Rs, w\>_{L^2(S)}.
		\end{math}
		Setze $w_h := C_h w$ Clément-Approxamiton.
		Mit Galerkin-Orthogonalität ist $l(w_h) = 0$, also
		\begin{math}
			l(w)
			&= l(w - w_h) \\
			&= \sum_{T\in \scr T_h} \Big( \underbrace{\<R_T, w - w_h\>_{L^2(T)}}_{\le \|R_T\|_{L^2(T)}\|w-w_h\|_{L^2(T)}} + \frac{1}{2} \sum_{S \subset \Boundary T} \underbrace{\< R_S, w - w_h\>_{L^2(S)}}_{\le \|R_S\|_{L^2(S)}\|w-w_h\|_{L^2(S)}} \Big). \\
			&\le \sum_{T \in \scr T_h} \Big( \|R_T\|_{L^2(T)} \|w - w_h\|_{L^2(T)} + \frac{1}{2} \|R_S\|_{L^2(S)} \|w - w_h\|_{L^2(S)} \\
			&\stackrel{\text{Clément}}\le \sum_{T \in \scr T_h} \Big( C h_T \|R_T\|_{L^2(T)} + \frac{1}{2} \sum_{S \subset \Boundary T} C h_S^{\frac{1}{2}} \|R_S\|_{L^2(S)} \Big) \|w\|_{H^1(\omega_T)} \\
			&\le \bigg( \sum_{T \in \scr T_h} \underbrace{\Big( C h_T \|R_T\|_{L^2(T)} + \frac{1}{2} \sum_{S \subset \Boundary T} C h_S^{\frac{1}{2}} \|R_S\|_{L^2(S)} \Big)^2}_{\text{nutze $(a+b)^2 \le 2a^2 + 2b^2$}} \underbrace{\sum_{T \in \scr T_h} \|w\|_{H^1(\omega_T)}^2}_{\le C \|w\|_{H^1(\Omega)}^2} \bigg)^{\frac{1}{2}} \\
			&\le \bigg( \sum_{T \in \scr T_h} \Big(\underbrace{ 2 C h_T^2 \|R_T\|_{L^2(T)}^2 + C \sum_{S \subset \Boundary T} h_S \|R_S\|_{L^2(S)}^2}_{= \eta_R} \Big)^2 C \|w\|_{H^1(\Omega)}^2 \bigg)^{\frac{1}{2}} \\
			&\le C \eta_R \|w\|_{H^1(\Omega)}.
		\end{math}
		Poincaré-Friedrich und Dualitätsargument liefern die Behauptung:
		\begin{math}
			\|u - u_h\|_{H^1(\Omega)}
			&\le C  | u - u_h|_{H^1(\Omega)} \\
			&= C \sup_{w \in H_0^1} \frac{\<\Nabla(u_h - u), \Nabla w\>_{L^2}}{|w|_{H^1}} \\
			&= C \sup_{\substack{w \in H_0^1 \\ |w|_{H^1} = 1}} \underbrace{\< \Nabla (u_h - u), \Nabla w\>_{L^2(\Omega)}}_{= l(w) \le |l(w)| \le C \eta_R \|w\|_{H^1} \le C \eta_R |w|_{H^1}} \\
			&\le C \eta_R.
		\end{math}
	\end{proof}
	\begin{note}
		\begin{itemize}
			\item
				\ref{3.89} ist ein a-posteriori Fehlerschätzer, d.h. \emph{nach} der Berechnung der numerischen Lösung $u_h$ kann die Abschätzung (bis auf Konstanten) berechnet werden.
			\item
				Falls $u_h \in \P_1(\scr T_h)$ ist $\Laplace u_h = 0$, also ist $R_T$ ohne Kenntnis von $u_h$ a-priori vorberechenbarbar.
			\item
				Bei nichttrivialem $f$ ist $\|R_T\|_{L^2(T)}$ nicht exakt numerisch berechenbar.
				Daher wählt man in der Praxis numerische Approxmation $f_h \approx f$ und approximiert flächenbasierte Residuen:
				\begin{math}
					\tilde R_T &:= \Laplace u_h + f_h, \\
					\tilde \eta_{T,R} &:= \Big(h_T^2 \|\tilde R_T\|^2 + \frac{1}{2} \sum_{S \subset \Boundary T} h_S \|R_S\|_{L^2(S)}^2 \Big)^{\frac{1}{2}}, \\
					\tilde \eta_R &:= \Big( \sum_{T \in \scr T_h} h_T^2 \|\tilde R_T\|^2 + \sum_{S \in S_0}h_S \|R_S\|_{L^2(S)^2} \Big)^{\frac{1}{2}}
				\end{math}
				Die Dreiecksungleichung liefert
				\begin{math}
					\|\Laplace u_h + f\|_{L^2(T)}
					\le \|\Laplace u_h + f_h\|_{L^2(T)} + \|f_h - f\|_{L^2(T)}
				\end{math}
				und
				\begin{math}
					\|u - u_h\| \le C \tilde \eta_R + \Big( \sum_{T \in \scr T_h} h_T^2 \|f - f_h\|_{h^2(T)} \Big)^{\frac{1}{2}}.
				\end{math}
				Den letzten Term nennt man \emphdef{Datenoszillation}.
			\item
				$\eta_R$ ist (bis auf eine Konstante) obere Schranke des Fehlers, daher nennt man es \emphdef{zuverlässiger Schätzer} (engl. \emphdef{reliable estimator}).
				Man kann zeigen, dass $\eta_R$ (oder $\tilde \eta_R$) auch untere Schranke für den echten Fehler ist (bis auf Datenoszillation), daher nennt man es auch \emphdef[effizienter Schätzer]{effizienten Schätzer} (engl. \emphdef{efficient estimator}).
		\end{itemize}
	\end{note}
\end{st}

\begin{st}[Untere Schranke] \label{3.90}
	Für $S \subset \Boundary T, T \in \scr T_h$ definiere den \emphdef[Patch!der Kantennachbarn]{Patch der Kantennachbarn}:
	\begin{math}
		\omega_S &:= \bigcup_{T \in \scr T_h, S \subset \Boundary T} T, &
		\tilde \omega_T &:= \bigcup_{S \subset \Boundary T} \omega_S.
	\end{math}
	Dann existiert eine Konstante $C(\Omega, \sigma_{\text{max}})$ mit lokaler Abschätzung
	\begin{math}
		\tilde \eta_{T,R} := C \Big( \|u - u_h\|_{H^1(\tilde \omega_T)}^2 + \sum_{T' \in \omega_T} h_T^2 \|f - f_h\|_{L^2(T')}^2 \Big)^{\frac{1}{2}}.
	\end{math}
	Die Summation liefert eine globale Abschätzung
	\begin{math}
		\tilde \eta_R \le C \Big( \|u - u_h\|_{H^1(\Omega)}^2 + \sum_{T \in \scr T_h} h_T^2 \|f - f_h\|_{L^2(T)}^2 \Big)^{\frac{1}{2}}.
	\end{math}
	\begin{proof}
		Siehe Braess, Satz 8.1 % fixme ref
	\end{proof}
\end{st}

\begin{note}[Adaptive FEM]
	\begin{itemize}
		\item
			$\tilde \eta_{T, R}$ stellen berechenbare Größen dar, welche lokal äquivalent zum echten Fehler sind (abgesehen von Datenoszillation).
			Daher kann man diese Größen als Indikatoren für Gitterverfeinerung verwenden, indem Simplizes mit großem Fehler verfeinert werden.
			Mit dem verfeinerten Gitter wird eine neue FEM-Lösung berechnent.
			Dieses Vorgehen iteriert man solange, bis die gewünschte Genauigkeit erreicht wurde.
		\item
			Falls die Datenoszillation klein genug ist (d.h. Gitter ist fein genug, sodass $f$ aufgelöst wird) kann die Konvergenz von solchen Algorithmen gezeigt werden (siehe z.B. Movin, Nochetto, Siebert, 2000).
	\end{itemize}
\end{note}

% todo: Pseudocode

