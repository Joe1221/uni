\chapter{Arithmetik modulo \texorpdfstring{$n$}{n}}



\section{Struktur der Einheitengruppe \texorpdfstring{$U(\Z / n\Z)$}{U(ℤ/nℤ)}}


% St 2.1
\begin{st} \label{2.1}
	Die multiplikative Gruppe $K^*$ eines endlichen Körpers $K$ ist zyklisch.
	Allgemein gilt: Jede endliche Untergruppe von $K^*$, wobei $K$ ein beliebiger Körper, ist zyklisch.
	\begin{note}
		\ref{2.1} klärt insbesondere die Struktur von $\Z / p\Z$ mit Primzahl $p$: $U(\Z / p\Z)$ ist zyklisch von Ordnung $p - 1$.

		Zum Beweis von \ref{2.1} werden gruppentheoretische Grundlagen benötigt, welche wir im Folgenden teilweise wiederholen werden.
	\end{note}
\end{st}

\begin{df*}
	Die Ordnung von $g \in G$, $o(g)$ ist die kleinste Zahl $m \in \N$ mit $g^m = e$.
\end{df*}

% St 2.2
\begin{st} \label{2.2}
	Sei $G$ eine endliche Gruppe und $U \le G$ eine Untergruppe.
	\begin{enumerate}[a)]
		\item
			Lagrange: $|U|$ teilt $|G|$.
		\item
			Für $g \in G$ gilt $o(g) \divs |G|$.
	\end{enumerate}
\end{st}

\begin{df*}
	Wir setzen
	\[
		\pi(G) := \{ x \in \P : x \divs |G| \}.
	\]
\end{df*}

% St 2.3
\begin{st} \label{2.3}
	Sei $G$ eine endliche abelsche Gruppe und $p \in \pi(G)$, also $|G| = p^a n$ mit $(p, n) = 1$.
	Setze
	\[
		P = \{ g \in G : o(g) = p^m \text{ für ein $m \in \N_0$} \}.
	\]
	$P$ bildet eine Untergruppe der Ordnung $p^a$.

	Man nennt $P$ \emphdef{$p$-Sylowgruppe} von $G$.
	Zerlege $|G|$ in Primfaktoren
	\[
		|G| = p_1^{a_1} \dotsb p_k^{a_k}
	\]
	und $P_i$ sei die $p_i$-Sylowgruppe von $G$, dann ist $G \isomorphic P_1 \times \dotsb P_k$ ($G$ ist direktes Produkt ihrer Sylowgruppen).
	\begin{note}
		\ref{2.3} kann man leicht aus dem Hauptsatz für endlich erzeugte abelsche Gruppen herleiten.
		Trotzdem liefern wir einen direkten Beweis.
	\end{note}
	\begin{proof}
		Seien $x, y \in P$, also $o(x) = p^{m_1}, o(y) = p^{m_2}$.
		Damit ist $o(xy) = p^{\max\{m_1, m_2\}}$ (hier wird $G$ abelsch benötigt) und $P$ ist multiplikativ abgeschlossen.
		Da $P$ endlich, ist $P \le G$.
		Da $G$ abelsch, ist $P \normalsubgroup G$.
		Annahme $G / P$ hätte ein Element $xP$ der Ordnung $p$.
		Dann ist $x^p \in P$ ($x \not\in P$, da $o(x^p) = p \neq 1$).
		$x$ hat $p$-Potenzordnung, ein Widerspruch zu $x \not\in P$.
		In $G / P$ gibt es also keine Elemente der Ordnung $p$.

		Für $G = P$ ist \ref{2.3} sicherlich richtig.
		Also verwende Induktion nach $|\pi(G)|$ und Gruppenordnung.
		Wäre $p \in \pi(G / P)$, dann hätte $G / P$ nach Induktion eine nicht-triviale $p$-Sylowgruppe, $G / P$ hätte Elemente der Ordnung $p$.
		Nach obigem folgt $p \not\in \pi(G / P)$, aber $|G| = |P| \cdot |G / P|$, also $|P| = p^a$.

		Zum letzten Teil:
		Sei \oBdA $k > 1$.
		Nach den ersten Teil existiert zu jedem $p_i$ eine $p_i$-Sylowgruppe $P_i$.
		Setze $\tilde P_1 = \< P_i : i \ge 2 \> = P_2 \cdot P_3 \dotsb P_k$.
		Mit \ref{2.5} sieht man, dass $(|\tilde P_1|, |P_1|) = 1, \tilde P_1 \normalsubgroup G_1, P_1 \normalsubgroup G$.
		Damit ist nach \ref{2.4} $G \isomorphic P_1 \times \tilde P_1$ und somit $G \isomorphic P_1 \times P_2 \times \dotsb P_k$.
	\end{proof}
\end{st}

% Lem 2.4
\begin{lem} \label{2.4}
	Sind $M, N \normalsubgroup G$ und $M \cap N = 1$.
	Dann ist $M \cdot N \isomorphic M \times N$.
	\begin{proof}
		Definiere $\phi: M \times N \to M\cdot N$ durch $(m, n) \mapsto mn$.
		$\phi$ ist injektiv, denn aus $m_1 n_1 = m_2 n_2$ folgt $M \ni m_2^{-1} m_1 = n_2 n_1^{-1} \in N$, also $m_2^{-1}m_1 = 1 = n_2 n_1^{-1}$ und somit $m_1 = m_2 \land n_1 = n_2$.
		Zeige $\phi$ ist Gruppenhomomorphismus, indem wir zeigen, dass der \emphdef{Kommutator} $m n m^{-1} n^{-1} = 1$, also genau dann, wenn $m n = n m$.

		Es gilt $mn m^{-1}n^{-1} \in M, N$, also $mnm^{-1}n^{-1} = 1$.
		\begin{align*}
			\phi((m_1, n_1) \cdot (m_2, n_2))
			&= \phi(m_1m_2, n_1n_2) \\
			&= m_1 m_2 n_1 n_2 \\
			&= m_1 n_1 m_2 n_2
			= \phi(m_1, n_1) \phi(m_2, n_2).
		\end{align*}
		$\phi$ surjektiv ist eine leichte Übung.
		Damit ist $\phi$ Gruppenisomorphismus.
	\end{proof}
\end{lem}

% Lem 2.5
\begin{lem} \label{2.5}
	Sind $M, N \normalsubgroup G$, dann ist $M\cdot N \normalsubgroup G$ und es gilt
	\[
		M / (M\cap N)
		\isomorphic
		MN / N.
	\]
	Insbesondere gilt $|MN| = |M|\cdot|N| \cdot \f 1{|M \cap N|}$.
\coursetimestamp{24}{04}{2014}
	\begin{proof}
		Zeige $M\cdot N \normalsubgroup G$.
		Zunächst ist $M \cdot N \le G$, denn
		\begin{align*}
			(mn)^{-1} &= n^{-1} m^{-1}
			= \underbrace{n^{-1}m^{-1}n}_{\in M} n^{-1}
		\end{align*}
		und für $m_1n_1, m_2n_2 \in \in M\cdot N$ ist
		\[
			m_1 n_1 m_2 n_2
			= \underbrace{m_1 m_1^{-1}}_{\in M} \underbrace{m_1 n_1 m_2}_{\in N} n_2
			\in M \cdot N.
		\]
		$M \cdot N$ ist Normalteiler:
		für $g \in G$ ist
		\[
			g^{-1} mn g
			= g^{-1} m g g^{-1} n g
			\in M \cdot N.
		\]
		Definiere jetzt $\phi: M / (M \cap N) \to (M \cdot N) / N$ durch
		\[
			m(M\cap N) \mapsto mN.
		\]
		$\phi$ ist wohldefiniert, denn wenn $m_1 (M \cap N) = m_2 (M \cap N)$, dann existiert $n \in M \cap N$ mit $m_1 n = m_2$, also $m_1 N = m_2 N$.
		$\phi$ ist injektiv, denn wenn $m_1 N = m_2 N$, existiert $\tilde n \in N: m_1 \tilde n = m_2$, also $\tilde n = m_1^{-1} m_2 \in M \cap N$ und somit $m_1 M\cap N = m_1 \tilde n M\cap N = m_2 M \cap N$.
		$\phi$ ist surjektiv, denn $m_1 n_1 N = m_1 N = \phi(m_1 M\cap N)$.
		$\phi$ ist Homomorphismus, denn
		\begin{align*}
			\phi(m_1 M\cap N \cdot m_2 M \cap N)
			&= \phi((m_1m_2)M\cap N) \\
			&= (m_1 m_2) N \\
			&= m_1N \cdot m_2 N \\
			&= \phi(m_1 M\cap N)
			= \phi(m_2 M\cap N).
		\end{align*}
		Falls $|M|, |N| < \infty$, dann ist $|M / (M\cap N) | = \f {|M|}{|M\cap N|} \stack{\phi}= \f {|MN|}{|N|}$.
	\end{proof}
\end{lem}

\begin{proof}[Letzter Schritt im Beweis von \ref{2.3}]
	Zu jedem $p_i \in \pi(G)$ existiert $P_i$.
	Setze $\tilde p_1 = \< P_2, \dotsc, P_k \> = P_2 \cdots \dotsb \cdots P_k$ (mittels Induktion aus \ref{2.5}) und $|\tilde p_1| = p_2^{\alpha_2} \cdot \dotsb \cdot p_k^{\alpha_k}$, also $\tilde P_1 \cap P_1 = 1$ und $P_1 \cdot \tilde P_1 = G$.
	Mit \ref{2.4} ist $G \isomorphic P_1 \times \tilde P_1$ und per Induktion somit
	\[
		\tilde P_1 = P_2 \times \dotsb \times P_k.
	\]
\end{proof}

\begin{nt*}
	Sind $M, N$ Normalteiler von $G$, dann ist $M \cdot N$ der kleinste Normalteiler von $G$, der $M$ und $N$ enthält.
	Es gilt $M \cdot N = \<M, N\>$.
	Sind $M, N$ keine Normalteiler, so gilt das nicht.
\end{nt*}

\begin{df*}
	Eine Gruppe $G$ heißt \emphdef{$p$-Gruppe}, wenn $|G| = p^m$ ist für eine Primzahl $p$.
\end{df*}

% Lem 2.6
\begin{lem} \label{2.6}
	Sei $\phi$ die Eulersche $\phi$-Funktion.
	Eine abelsche $p$-Gruppe $G$ ist genau dann zyklisch, wenn es zu jedem Teiler $t$ von $|G|$ höchstens $\phi(t)$ Elemente der Ordnung $t$ gibt (und es gibt dann auch genau $\phi(t)$ solche Elemente).
	\begin{proof}
		Zeige zunächst die Rückrichtung.
		Die Ordnung eines Elements $g$ teilt $|G|$ nach \ref{2.2}, also haben alle Elemente von $G$ eine Ordnung der Form $p^i, 0 \le i \le m$.
		Sei $w_1$ die Anzahl der Elemente der Ordnung $p^i$ von $G$, dann ist
		sicherlich $|G| = \sum_{i=0}^m w_i$.
		Existiert ein Element der Ordnung $p^i$, so ist die Anzahl solcher Elemente einerseits nach Voraussetzung beschränkt durch $w_i \le \phi(p^i)$ (sogar gleich, warum?). % fixme: warum?
		%Beachte: ist $o(g) = p^i$, dann ist $|\<g\>| = p^i$ und $\<g\> \isomorphic (\Z / p^i \Z, +)$.
		Wir können also schreiben
		\[
			p^m = |G|
			= \sum_{i=0}^m \phi(p^i) \alpha_i
		\]
		mit $\alpha_i \in \{0, 1\}$.
		\begin{align*}
			\sum_{i=0}^m \phi(p^i) \alpha_i
			\le \sum_{i=0}^m \phi(p^i)
			&\stack{\ref{1.15}}= 1 + \sum_{i=1}^m (p-1)p^{i-1} \\
			&= 1 + (p-1) \sum_{i=1}^m p^{i-1}
			= p^m
			= |G|
		\end{align*}
		Also gilt Gleichheit und somit insbesondere $\alpha_m = 1$.
		Es gibt also Elemente der Ordnung $p^m$ (welche dann ganz $G$ ergzeugen) und somit ist $G$ zyklisch.

		Die Hinrichtung ist eine leichte Übung. \Exercise
	\end{proof}
\end{lem}

\begin{proof}[Beweis von \ref{2.1}]
	Sei $U \le K^*$ mit $|U| < \infty$.
	Nach \ref{2.3} ist $U \isomorphic P_1 \times \dotsb \times P_k$ und $P_i$ ist $p_i$-Sylowgruppe von $U$.
	Wir zeigen, dass $P_i$ zyklisch ist.

	Sei $d_i$ Teiler von $|P_i|$ und $g \in P_i$ mit $o(g) = d_i$.
	Also erfüllt $g$ die Gleichung $x^{d_i} - 1 = 0$.
	Diese Gleichung hat in $K$ höchstens $d_i$ verschiedene Lösungen.
	Ist $g$ eine Lösung, dann auch alle Potenzen von $g$.
	Die von $g$ erzeugte zyklische Gruppe $\<g\> \isomorphic \Z / d_i \Z$ stellt alle Lösungen der Gleichung.

	Es existieren also höchstens $\phi(d_i)$ Elemente der Ordnung $d_i$ in $P_i$.
	Mit \ref{2.6} ist also $P_i$ zyklisch, $P_i \isomorphic \Z / |P_i| \Z$ und
	\[
		U \isomorphic
		\Z / |P_1| \Z \times \dotsb \times \Z / |P_k| \Z
		\stack{\ref{1.14}}\isomorphic
		\Z / (|P_1| \dotsb |P_k|) \Z,
	\]
	also ist $U$ zyklisch.
\end{proof}
\begin{note}
	In einem Schiefkörper sind im Allgemeinen nicht alle endlichen Untergruppen zyklisch, z.B. in $\H^*$ gibt es die Quaternionengruppe der Ordnung $8$.
\end{note}

Unser Ziel war es, die Struktur von $U(\Z / m \Z)$ zu untersuchen.
\ref{2.1} klärt dies für den Fall $\Z / p\Z$ mit Primzahl $p$:
\[
	(\Z / p \Z)^* \isomorphic C_{p-1},
\]
wobei $C_{p-1}$ die zyklische Gruppe der Ordnung $p-1$ ist (multiplikatives Analogon zu $\Z / p \Z$.

\begin{nt*}
	Für $K = \Z / p\Z$ würde man gerne Erzeuger (auch \emphdef{Primitivwurzel} genannt) von $(\Z / p\Z)^*$ angeben können.
	Insbesondere würde man gerne die kleinsten Erzeuger $k(p)$ kennen.
\end{nt*}

\begin{ex*}
	Es gilt
	\begin{align*}
		k(3) &= 2, &
		k(5) &= 2, &
		k(7) &= 3, &
		k(11) &= 2, &
		k(5881) &= 31.
	\end{align*}
	Im Allgemeinen sind die Erzeuger unregelmäßig verteilt.
\end{ex*}

\begin{conj*}[E. Artin]
	Sei $a \in \N$ und $a$ sei kein Quadrat, dann existiert eine ungerade Primzahl $p$ für die $a \bmod p$ eine Primitivwurzel ist.
	\begin{note}
		Warum darf $a$ kein Quadrat sein?
		siehe Übung.
	\end{note}
\end{conj*}

Der nächste Schritt zur Struktur von $U(\Z / m \Z)$ ist die Betrachtung von Primzahlpotenzen $m = p^s$.

\begin{ex*}
	Es gilt
	\begin{align*}
		U(\Z / 4 \Z) &= \{ \_ 1, \_ 3 \} \isomorphic C_2 \\
		U(\Z / 8 \Z) &= \{ \_ 1, \_ 3, \_ 5, \_ 7 \} \isomorphic C_2 \times C_2
	\end{align*}
	$C_2 \times C_2$ ist nicht zyklisch.
\end{ex*}

Es wird sich zeigen, dass $U(\Z / p^s \Z)$ zyklisch ist, wenn $p$ ungerade Primzahl ist.
Zunächst ein Lemma zum Rechnen bezüglich Primzahlpotenzresten.

% Lem 2.7
\begin{lem} \label{2.7}
	Sei $p \in \P, s \in \N$ und $a, b \in \Z$.
	\begin{enumerate}[a)]
		\item
			$a \equiv b \bmod p^s \implies a^p \equiv b^p \bmod p^{s+1}$,
		\item
			$s \ge 2, p\neq 2$.
			Dann gilt
			\[
				(1 + ap)^{p^{s-2}}
				\equiv 1 + ap^{s-1} \mod p^s.
			\]
		\item
			$p \ndivs a, p \neq 2 \implies $ $(1+ap) \bmod p^s$ hat Ordnung $p^{s-1}$ in $U(\Z / p^s \Z)$.
		\item
			$s > 2 \implies 5^{2^{s-3}} \equiv 1 + 2^{s-1} \bmod 2^s$, $5 \bmod 2^s$ hat die Ordnung $2^{s-2}$.
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Wenn $a \equiv b \bmod p^s$, dann ist $a - b = k p^s$ und
				\[
					a^p
					= (b + kp^s)^p
					= b^p + \sum_{j=1}^{p-1} \binom{p}{j} b^{p-j} (kp^s)^j + (kp)^{sp}
				\]
				Da $\binom{p}{r}$ durch $p$ teilbar ist für $1 < r < p$, gilt
				\[
					\sum_{j=1}^p \binom{p}{j} b^{p-j} (kp^s)^j \equiv 0 \mod p^{s+1}
				\]
				und zusammen mit $(kp)^{sp} \equiv 0 \bmod p^{s+1}$ somit $a^p \equiv b^p \bmod p^{s+1}$.
			\item
\coursetimestamp{28}{04}{2014}
				Zeige per Induktion.
				Für $s = 2$ gilt $(1 + ap)^{p^{s-2}} = 1 + ap = 1 + ap^{2-1}$.
				Zeige jetzt die Aussage für $s + 1$ unter Voraussetzung, sie gelte für kleinere $s$.
				\[
					(1 + ap)^{p^{s-1}}
					= \Big((1 + ap)^{p^{s-2}}\Big)^p
					\stack{\text{a)}}\equiv \big(1 + ap^{s-1} \big)^p \mod p^{s+1}
				\]
				Ist $p > 2$, dann ist
				\[
					(1 + ap^{s-1})^p
					= 1 + \underbrace{\binom{p}{1} ap^{s-1}}_{= ap^s} + \underbrace{\sum_{j=2}^p \binom{p}{j} (ap^{s-1})^j}_{\text{teilbar durch $p^{s+1}$}}.
				\]
				Damit ist die Aussage für $s + 1$ gezeigt:
				\[
					(1 + ap)^{p^{s-1}}
					\equiv 1 + ap^s \mod p^{s+1}.
				\]
			\item
				Aus b) und a) folgt
				\[
					\Big( (1+ap)^{p^{s-2}} \Big)^p
					\equiv (1 + ap^{s-1})^p
					\stack{\text{Bin.}}\equiv 1 \mod p^s.
				\]
				% fixme: hier stimmt doch was nicht: mod p^{s+1} mit a) ??
				Damit hat $(1 + ap) \bmod p^s$ hat eine Ordnung, die $p^{s-1}$ teilt.
				Nach Voraussetzung gilt, dass $p \ndivs a$, also mit b) $(1 + ap)^{p^{s-2}} \equiv 1 + ap^{s-1} \not\equiv 1 \bmod p^s$, denn $p^s \ndivs ap^{s-1}$.
				Also ist die Ordnung von $(1 + ap) \bmod p^s$ gerade $p^{s-1}$.
			\item
				Analog per Induktion, beachte $s \ge 3$.
				\Exercise
		\end{enumerate}
	\end{proof}
\end{lem}

% St 2.8
\begin{st} \label{2.8}
	Sei $p \in \P$ ungerade.
	Dann ist $U(\Z / p^s \Z)$ zyklisch mit Gruppenordnung $(p-1)p^{s-1}$ für alle $s \in \N$.
	\begin{proof}
		Für $s = 1$ ist dies gerade eine Folgerung aus \ref{2.3}.
		Also existiert $g \in \Z$ mit $g^{p-1} \equiv 1 \bmod p$ und $g^i \not\equiv 1 \bmod p$ für $1 \le i \le p -1$.

		Falls $g^{p-1} \equiv 1 \bmod p^2$, dann gilt auch $(g + p)^{p-1} \equiv 1 \bmod p$ und $(g + p)^i \not\equiv 1 \bmod p$ für $1 \le i < p-1$ und
		\[
			(g + p)^{p - 1} \equiv \underbrace{g^{p-1}}_{\equiv 1 \bmod p^2} + (p-1)g^{p-2} p \mod p^2
		\]
		Also gilt $(g + p)^{p-1} \equiv 1 + ap \bmod p^2, a \not\equiv 0 \bmod p$.

		Falls $g^{p-1} \not\equiv 1 \bmod p^2$, dann ist $g^{p-1} = 1 + ap \bmod p^2$ mit $a \neq 0 \bmod p$.
		Ohne Beschränkung der Allgemeinheit kann also $g$ so gewählt werden, dass $g^{p-1} \equiv 1 \mod p, g^i \not\equiv 1 \bmod p$ für $1 \le i \le p-1$ und $g^{p-1} \equiv 1 + ap \bmod p^2$ mit $a \not\equiv 0 \bmod p$.
		Nach \ref{2.7} b) gilt jetzt
		\[
			(1 + ap)^{p^{s-2}} \equiv 1 + ap^{s-1} \bmod p^s
		\]
		für $s \ge 2, p \neq 2$ und nach \ref{2.7} c) hat $(1 + ap) \bmod p^s$ die Ordnung $p^{s-1}$ in $U(\Z / p^s \Z)$.
		Damit ist
		\[
			(g^{p-1})^{p^{s-2}}
			= g^{(p-1)p^{s-2}}
			\equiv 1 + ap^{s-1}
			\not\equiv 1 \bmod p^s.
		\]
		und $(g^{p-1})^{p^{s-1}} = g^{(p-1)p^{s-1}} \equiv 1 \bmod p^s$.
		Beachte $(p-1)p^{s-1} = \phi(p^s)$.

		Ist $d$ ein maximaler Teiler von $(p-1)p^{s-1}$, dann folgt $d = (p-1)p^{s-2}$, oder $d = m p^{s-1}$ mit maximalem Teilere $m$ von $p-1$.
		Angenommen $g^{\tilde d} \equiv 1 \bmod p^s$ und $1 \le \tilde d < (p-1)p^{s-1}$.
		Dann gilt $\tilde d \divs d$ und $g^d \equiv 1 \bmod p^s$.
		Falls $d = (p-1)p^{s-2}$, dann ergibt sich ein Widerspruch zu $g^{(p-1)p^{s-2}} \not\equiv 1 \bmod p^s$.

		Also hat $d$ die Form $d = mp^{s-1}$ und es gilt $g^{mp^{s-1}} \equiv 1 \bmod p^s$.
		Dann ist $g^{mp^{s-1}} \equiv 1 \bmod p$ und nach \ref{2.9} ist $g^m \equiv 1 \bmod p$, ein Widerspruch.

		Damit hat $g$ die ordnung $(p-1)p^{s-1}$ in $U(\Z / p^s \Z)$ und wegen $|U(\Z / p^s \Z)| = (p-1)p^{s-1}$, folgt, dann $U(\Z / p^s \Z)$ zyklisch ist.
	\end{proof}
\end{st}

% Lem 2.9
\begin{lem}[„Kleiner Fermat'scher Satz“] \label{2.9}
	Sei $p \in \P$, dann ist $a^p \equiv a \bmod p$ für beliebiges $a \in \Z$.
	\begin{proof}
		Für $a \equiv 0 \bmod p$ ist dies klar.
		Falls $a \not\equiv 0 \bmod p$, dann ist wegen $|U(\Z / p\Z)| = p - 1$ auch $a^{p-1} \equiv 1 \bmod p$ und somit $a^p \equiv a \bmod p$.
	\end{proof}
\end{lem}

% St 2.10
\begin{st} \label{2.10}
	Es gilt
	\begin{align*}
		U(\Z / 2 \Z) &\isomorphic 1, &
		U(\Z / 4 \Z) &\isomorphic C_2
	\end{align*}
	und für $s \ge 3$
	\[
		U(\Z / 2^s \Z)
		\isomorphic \< - 1 \bmod 2^s \> \times \< 5 \bmod 2^s \>
		\isomorphic C_2 \times C_{2^{s-2}}.
	\]
	\begin{note}
		Im Unterschied zu $p \neq 2$, ist $U(\Z / 2^s \Z)$ nicht zyklisch für $s \ge 3$.
		Beispielsweise ist $U(\Z / 8 \Z) \isomorphic C_2 \times C_2$, d.h. das Quadrat einer ungeraden Zahl ist stets $\equiv 1 \bmod 8$.
	\end{note}
	\begin{proof}
		Nach \ref{2.7} d) ist die Ordnung von $5 \bmod 2^s$ gerade $2^{s-2}$.
		Offensichtlich ist die Ordnung von $-1 \bmod 2^s$ gerade $2$, wenn $s \ge 2$.
		Es genügt zu zeigen, dass $-1 \bmod 2^s \not\in \< 5 \bmod 2^s \>$.
		Betrachte $\kappa: \Z / 2^s \Z \to \Z / 4 \Z$ mit $x \bmod 2^s \mapsto x \bmod 4$.
		Offensichtlich ist $\kappa$ surjektiver Ringhomomorphismus.
		Es gilt
		\begin{align*}
			\kappa(5 \bmod 2^s) &= 5 \bmod 4 = 1 \bmod 4 \\
			\kappa(-1 \bmod 2^s) &= -1 \bmod 4 = 3 \bmod 4 \\
			\kappa((5 \bmod 2)^j) &= (5 \bmod 4)^j = 1^j \bmod 4 = 1 \bmod 4
		\end{align*}
		und damit $-1 \bmod 2^s \not\in \< 5 \bmod 2^s\>$.
		Es gilt $\<-1 \bmod 2^s\> \cap \< 5 \bmod 2^s\> = 1$ und damit $U(\Z / 2^s \Z) \isomorphic \<-1 \bmod 2^s \> \times \< 5 \bmod 2^s \>$.
	\end{proof}
\end{st}

% Folg 2.11
\begin{kor} \label{2.11}
	Sei $m \in \N$ und $m = p_1^{\alpha_1} \dotsb p_k^{\alpha_k}$ die Primzahlzerlegung von $m$.
	Dann gilt
	\[
		U(\Z / m\Z) \isomorphic U(\Z / p_1^{\alpha_1}\Z) \times \dotsb \times U(\Z / p_k^{\alpha_k} \Z)
	\]
	nach \ref{1.14} b).
	Die Faktoren der rechten Seite sind nach \ref{2.8} und \ref{2.10} bekannt.
\end{kor}

\begin{ex*}
	Für $m = 8 \cdot 5 \cdot 3^2 = 360$ ergibt sich
	\begin{align*}
		U(\Z / 120 \Z)
		&\isomorphic U(\Z / 8 \Z) \times U(\Z / 5 \Z) \times U(\Z / 3^2 \Z) \\
		&\isomorphic C_2 \times C_2 \times C_4 \times C_6
	\end{align*}
\end{ex*}

% Folg 2.12
\begin{kor} \label{2.12}
	$U(\Z / m\Z)$ ist zyklisch genau dann, wenn $m \in \{1, 2, 4, 2p^k, p^k \}$ für ein $p \in \P \setminus \{2\}$.
	\begin{proof}
		Übung.
		\Exercise
	\end{proof}
\end{kor}

\section{Quadratische Reste}

Wann ist eine Kongruenz der Form
\[
	x^2 \equiv a \mod p
\]
mit $2 \neq p \in \P$ lösbar in $\Z / p\Z$ ($a \not\equiv 0 \bmod p$)?

% Def 2.13
\begin{df} \label{2.13}
	\begin{enumerate}[a)]
		\item
		Sei $b \in \Z, m \in \N$ mit $m > 1$ und $(b, m) = 1$, dann nennt man $b$ \emphdef{quadratischer Rest} modulo $m$, wenn
		\[
			x^2 \equiv b \bmod m
		\]
		eine Lösung in $U(\Z / m\Z)$ besitzt.
		\item
			Sei $p \in \P, p > 2$ und $b \in \Z$.
			Das \emphdef{Legendresymbol} von $b$ und $p$, geschrieben $\legsym bp \in \Z$, ist definiert als
			\[
				\legsym bp := \begin{cases}
					1 & \text{$b$ quadratischer Rest modulo $p$} \\
					-1 & \text{$b$ kein quadratischer Rest modulo $p$} \\
					0 & \text{$b \equiv 0 \bmod p$}
				\end{cases}.
			\]
			Wenn $(b, p) = 1$, dann tritt der Fall $\legsym bp = 0$ nicht ein.
	\end{enumerate}
\end{df}

\coursetimestamp{05}{05}{2014}

% Lem 2.14
\begin{lem} \label{2.14}
	Sei $p \in \P, p > 2$.
	Es gelten die folgenden Aussagen:
	\begin{enumerate}[a)]
		\item
			Sei $b \in \Z$ mit $(b, p) = 1$.
			Dann ist $b$ genau dann quadratischer Rest modulo $p$, wenn $b^{\f {p-1}2} \equiv 1 \bmod p$
			ist und kein quadratischer Rest, wenn $b^{\f {p-1}2} \equiv -1 \bmod p$	ist, d.h.
			\[
				\legsym bp = b^{\f {p-1}2} \mod p.
			\]
		\item
			Sei $a, b \in \Z$ mit $(a,p) = 1 = (b, p)$.
			Dann gilt
			\[
				\legsym ap \legsym bp = \legsym {ab}p.
			\]
			Mit $a = b = 1$ folgt $\legsym 1p \legsym 1p = \legsym 1p$, also $\legsym 1p = 1$.

			Das Legendresymbol liefert damit einen Gruppenhomomorphismus zwischen der multiplikativen Gruppe $(\Z / p\Z)*$ und $(\{-1,1\}, \cdot)$:
			\begin{align*}
				\kappa: (\Z / p\Z)^* &\to (\{1,-1\}, \cdot), \\
				a &\mapsto \legsym ap.
			\end{align*}
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				$U(\Z / p\Z)$ ist zyklisch von der Ordnung $p - 1$, die Quadrate bilden dann eine Untergruppe von Index 2.
				Es gilt $a^{p-1} \equiv 1 \bmod p$ für alle $a \in U(\Z / p\Z)$.
				Wegen $|Q| = \f 12 (p-1)$ ist $a^{\f {p-1}2} \equiv 1 \bmod p$ (Ordnung eines Elementes teilt Gruppenordnung) für alle $a \in Q$.
				$U := U(\Z / p \Z)$ ist zyklisch, also ist $-1 \bmod p$ die einzige Involution in $U$.
				Wenn $a^{\f{p-1}2} \not\equiv 1 \bmod p$, dann ist $a^{\f{p-2}2} \equiv -1 \bmod p$ ,denn $(a^{\f{p-1}2})^2 = a^{p-1} \equiv 1 \bmod p$.
				$Q$ ist die einzige Untergruppe von $U$ der Ordnung $\f{p-1}2$ (siehe Bemerkung).
				Ist $b$ ein Nichtquadrat, dann ist $b^{\f{p-1}2} \equiv -1 \bmod p$.
			\item
				Nach \ref{2.1} ist $U(\Z / p\Z) = (\Z / p\Z)^*$ zyklisch.
				Die Quadrate von $U(\Z / p \Z)$ bilden eine Untergruppe $Q$ von Index 2. \Exercise
				Daher ist mit $a \bmod p$ quadratisch und $b \bmod p$ quadratisch auch $ab \bmod p$ quadratisch.
				Ist $a \bmod p$ kein Quadrat und $b \bmod p$ quadratisch, dann ist $ab \mod p$ kein Quadrat.
				Wenn $a \bmod p$ und $b \bmod p$ keine Quadrate sind, so ist $ab \mod p$ ein Quadrat wegen Index 2.
				Also ist $\kappa$ ein Homomorphismus.
		\end{enumerate}
	\end{proof}
\end{lem}

\begin{nt*}
	In \ref{2.6} wurde gezeigt, dass zyklische $p$-Gruppen zu jedem Teiler der Gruppenordnung genau eine Untergruppe haben.
	Mit \ref{1.14} folgt: in einer endlichen zyklischen Gruppe $G$ gibt es zu jedem Teiler $t$ der Gruppenordnung $|G|$ genau eine Untergruppe der Ordnung $t$.
	Dies ist eine Übungsaufgabe. \Exercise
\end{nt*}

% St 2.15
\begin{st}[Quadratisches Reziprozitätsgesetz, Gauß 1796] \label{2.15}
	Seien $p$, $q$ verschiedene ungerade Primzahlen, dann gilt
	\begin{enumerate}[a)]
		\item
			$\legsym qp \legsym pq = (-1)^{\f {p-1}2 \f{q-1}2}$,
		\item
			$\legsym {-1}p = (-1)^{\f {p-1}2}$,
		\item
			$\legsym 2p = (-1)^{\f{p^2 -1}8}$.
	\end{enumerate}
	Diese Aussagen werden in der Literatur oft als erster und zweiter Ergänzungssatz bezeichnet.
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Sei $\zeta$ eine primitive $q$-te Einheitswurzel.
				Betrachte
				\[
					\tau = \sum_{1 \le a \le q-1} \underbrace{\legsym aq \zeta^a}_{\in \Z[\zeta]},
				\]
				mit $\Z[\zeta] = \{ a_0 + a_1 \zeta^1 + \dotsb + a_{q-1} \zeta^{q-1} : a_j \in \Z\}$.

				Wir nehmen nun an, dass
				\begin{equation} \label{eq:2.15_1}
					\tau^2 = \legsym {-1}q q
				\end{equation}
				gilt.
				Mit \ref{2.14} a) haben wir
				\[
					\legsym qp \equiv q^{\f {p-1}2} \mod p
				\]
				und mit \ref{2.15} b)
				\[
					\legsym {-1}q = (-1)^{\f {q-1}2}.
				\]
				Es gilt dann
				\begin{align*}
					\tau^p
					= \tau (\tau^2)^{\f{p-1}2}
					= \tau \big( \legsym {-1}q q \big)^{\f {p-1}2}
					&= \tau \big( (-1)^{\f {q-1}2} q \big)^{\f {p-1}2} \\
					&\stack{\ref{2.14}}\equiv \tau (-1)^{\f{q-1}2 \cdot \f {p-1}2} \legsym qp \mod p.
				\end{align*}
				Andererseits gilt
				\begin{align*}
					\tau^p
					&= \Big( \sum_{1 \le a \le q-1} \legsym aq \zeta^a \Big)^p \\
					&\equiv \sum_{1 \le a \le q-1} \legsym aq \zeta^{ap} \\
					&\equiv \legsym pq \sum_{1 \le a \le q-1} \legsym aq \legsym pq \zeta^{ap} \\
					&\stack{\ref{2.14} b)}\equiv \legsym pq \sum_{1 \le a \le q-1} \legsym {ap}q \zeta^{ap} \\
					&\stack{\text{s.u.}}\equiv \legsym pq \tau \mod p,
				\end{align*}
				%Es gilt $\legsym xq = \legsym {x+kp}q$, mit $p \neq q$
				denn die Multiplikation mit $p$ permutiert die Restklassen bezüglich $q$ und genauso für $\{\zeta, \dotsc, \zeta^{q-1}\} = \{\zeta^p, \dotsc, \zeta^{p(q-1)}\}$.
				Damit ist
				\[
					\tau (-1)^{\f{q-1}2 \f {p-1}2} \legsym qp
					\equiv \tau \legsym pq \mod p
				\]
				%multiplizieren mit 2 und
				zusammen mit \eqref{eq:2.15_1} folgt
				\[
					\legsym {-1}q q (-1)^{\f{q-1}2 \f {p-1}2} \legsym qp
					\equiv \legsym {-1}q q \legsym pq \mod p
				\]
				$\legsym {-1}q q$ ist invertierbar $\bmod p$, also
				\[
					(-1)^{\f {q-1}2 \f {p-1}2} \legsym qp
					\equiv \legsym pq \mod p
				\]
				und die Aussage ist gezeigt.

				Es bleibt noch \eqref{eq:2.15_1} zu zeigen.
				Wir zeigen äquivalent $\legsym {-1}q \tau^2 = q$.
				Es gilt mit $\sum_{b} \legsym bq \zeta^b = \sum_{b} \legsym {-b}q \zeta^{-b}$
				\[
					\tau^2 = \Big( \sum_{a} \legsym aq \zeta^a \Big) \Big( \sum_{b} \legsym {-b}q \zeta^{-b} \Big)
					\stackrel{\ref{1.14} b)}= \sum_{ab} \legsym {a(-b)}q \zeta^{a-b}
				\]
				und damit
				\begin{align*}
					\legsym {-1}q \tau^2
					&= \sum_{a,b} \legsym {-1}q \legsym {a(-b)}q \zeta^{a-b}
					= \sum_{a,b} \legsym {ab}q \zeta^{a-b}
				\intertext{%
					wähle $\tilde b$ mit $\tilde b b \equiv 1 \bmod q$, dann ist $\legsym {ab}q = \legsym aq \legsym bq = \legsym aq \legsym {\tilde b}q = \legsym {a\tilde b}q$ und mit $c := a\tilde b$ ist $a \equiv cb \bmod q$, also $\zeta^a = \zeta^{cb}$ es gilt weiter
				}
					&= \sum_{a,b} \legsym {a\tilde b}q \zeta^{a-b}
					\stackrel{c=a\tilde b}= \sum_{c,b} \legsym cq \zeta^{bc-b} \\
					&= \sum_{c\neq 1} \Big( \legsym cq \sum_{b} \zeta^{bc-b} \Big) + \underbrace{\sum_{b} \legsym 1q}_{=q-1}
				\intertext{%
					$\xi := \zeta^{c-1}$ ist ebenfalls eine $q$-te Einheitswurzel und daher $\sum_{b} \zeta^{(1-c)b} = \sum_{k=1}^{q-1} \xi^k = -1$.
					Zusammen mit $\sum_{c} \legsym cq = 0$ folgt schließlich
				}
					&= - \sum_{c\neq 1} \legsym cq + q-1 \\
					&= - (-1) + q - 1 \\
					&= q
				\end{align*}
			\item
				Nach \ref{2.14} a) gilt
				\[
					\legsym {-1}p \equiv (-1)^{\f{p-1}2} \mod p.
				\]
				Da $p$ ungerade folgt $\legsym {-1}p = (-1)^{\f {p-1}2}$.
			\item
				In $\Z[i] = \{ a + bi : a,b \in \Z \} \le \C$ gilt
				\[
					(1 + i)^p
					= (1 + i)(\underbrace{(1 + i)^2}_{=2i})^{\f {p-1}2}
					= (1 + i) i^{\f{p-1}2} 2^{\f{p-1}2}
				\]
				Ferner gilt $(1 + i)^p \equiv 1 + i^p \bmod p$ ($\binom{p}{j} \equiv 0 \bmod p$ für $1 \le j \le p-1$) und $\legsym 2p \equiv 2^{\f {p-1}2} \bmod p$ nach \ref{2.14} a).

				Sei $\f {p-1}2$ gerade, dann ist $p-1$ durch $4$ teilbar und $i^p = i$, also
				\[
					\legsym 2p (1+i) i^{\f {p-1}2}
					\equiv 1 + i^p
					\equiv 1 + i \mod p.
				\]
				Es gilt
				\[
					\legsym 2p (1 + i)(1 - i) (-1)^{\f {p-1}4}
					\equiv (1 +i)(1 -i) \mod p
				\]
				und mit $((-1)^{\f p4})^2 = 1$ damit $\legsym 2p \equiv (-1)^{\f{p-1}4} \bmod p$.

				Sei $\f {p-1}2$ ungerade.
				Dann gilt
				\[
					\legsym 2p (1 +i)i^{\f {p-1}2}
					\equiv 1 + i^p
					\equiv 1 -i \mod p
				\]
				und mit $1 + i$ multipliziert
				\[
					\legsym 2p 2 \underbrace{i i^{{p-1}2}}_{=i^{\f{p+1}2}}
					\equiv 2 \bmod p,
				\]
				also
				\[
					\legsym 2p \underbrace{i^{p+1}}_{= 1} \equiv \underbrace{i^{\f{p+1}2}}_{=(-1)^{\f {p+1}4}} \mod p.
				\]
				Da $p$ ungerade folgt
				$\legsym 2p = (-1)^{\f {p-1}4} \mod p$ (im Fall $\f {p-1}2$ gerade), bzw. $\legsym 2p = (-1)^{\f{p+1}4}$ (im anderen Fall).
				Ist $\f {p-1}2$ gerade, so ist $\f {p+1}2$ ungerade und somit
				\[
					(-1)^{\f{p-1}4}
					= \big((-1)^{\f{p-i}4} \big)^{\f{p+1}2}
					= (-1)^{\f{p^2-1}8}.
				\]
				Wenn $\f {p-1}2$ ungerade, dann ist
				\[
					(-1)^{\f {p+1}4}
					= \big( (-1)^{\f {p+1}4} \big)^{\f{p-1}2}
					= (-1)^{\f {p^2 - 1}8}.
				\]
		\end{enumerate}
	\end{proof}
\end{st}

\coursetimestamp{08}{05}{2014}

% Bem + Bsp 2.16
\begin{nt} \label{2.16}
	\begin{enumerate}[a)]
		\item
			Es gilt
			\[
				\legsym pq = \legsym qp
			\]
			wenn $p \equiv 1 \bmod 4$ oder $q \equiv 1 \bmod 4$.
			Außerdem
			\[
				\legsym pq = - \legsym qp
			\]
			wenn $p \equiv 3 \bmod 4$ und $q \equiv 3 \bmod 4$.
		\item
			Ist $5$ ein Quadrat in $\Z / 23\Z$?
			Wir interessieren uns also für
			\[
				\legsym 5{23}
				= \legsym {23}5
				= \legsym 35
				= -1,
			\]
			die Antwort ist also „nein“.
		\item
			Wegen $67 \equiv 3 \bmod 4, 139 \equiv 3 \bmod 4$ ist
			\begin{align*}
				\legsym{67}{139}
				&= - \legsym{139}{67}
				= - \legsym{72}{67}
				\stack{\ref{2.14}}= - \legsym{36}{67} \legsym{2}{67}
				\stack{\ref{2.14}}= - \underbrace{\legsym{6}{67} \legsym{6}{67}}_{=1} \legsym{2}{67} \\
				&= - \legsym{2}{67}
				= - (-1)^{\f{67^2-1}{8}}
				= - (-1)^{33\cdot 17}
				= 1
			\end{align*}
	\end{enumerate}
\end{nt}

Zum Abschluss dieses Kapitels noch zwei Anwendungen.

\begin{df*}
	Sei $n, m \in \N$
	Man bezeichnet die Menge aller Repräsentanten der Restklasse $n \bmod m$, d.h.
	\[
		\{ n + km : k \in \N \},
	\]
	als \emphdef[analytische Progression]{analytische Progression $n \bmod m$}.
\end{df*}

\begin{st}[Dirichlet] \label{2.17}
	In jeder arithmetischen Progression $n \bmod m$ mit $(n,m) = 1$ befinden sich unendlich viele Primzahlen.
	\begin{note}
		Der Satz gehört in die analytische Zahlentheorie, der Beweis verwendet analytische Methoden.

		Genauer kann man zeigen, dass asymptotisch
		\[
			\# \text{Primzahlen $\le x$ in $n \bmod m$}
			\sim
			\f {x}{\phi(m) \log x}.
		\]
		Bezeichne $\pi(x)$ die Anzahl der Primzahlen $\le x$, dann besagt der sogenannte Primzahlsatz, dass asymptotisch
		\[
			\pi(x) \sim \f{x}{\log x}.
		\]
		Im Augenblick müssen wir uns mit Spezialfällen dieses Satzes begnügen.
	\end{note}
	\begin{proof}[Für den Spezialfall $1 \bmod 4$]
		Angenommen, es gäbe nur endlich viele Primzahlen $p_1, \dotsc, p_k$, die $\equiv 1 \bmod 4$ sind.
		Setze
		\[
			n = (2 p_1 p_2 \dotsb p_k)^2 + 1
		\]
		Dann ist $n \equiv 1 \bmod 4$.
		Ist $q$ ein Primteiler von $n$, so ist $2(p_1\dotsb p_k)^2 + 1 \equiv 0 \bmod q$, also $-1$ ist Quadrat modulo $q$, d.h. $\legsym{-1}{q} = 1$.

		Nach dem ersten Ergänzungssatz ist $\legsym{-1}{q} = (-1)^{\f{q-1}2}$, also ist $q \equiv 1 \bmod 4$.
		Nach Konstruktion von $n$ sind alle Primteiler von $n$ kongruent zu $3 \bmod 4$.
	\end{proof}
	\begin{proof}[Für den Spezialfall $3 \bmod 4$]
		siehe Übung.
	\end{proof}
\end{st}




% St 2.18
\begin{st} \label{2.18}
	Die diophantische Gleichung $x^2 + by = a$ mit $(a,b) = 1$ ist genau dann lösbar, wenn gilt
	\begin{enumerate}[i)]
		\item
			Für jede ungerade Primzahl $p$, die $b$ teilt, ist $\legsym ap = 1$,
		\item
			falls $2$ Teiler von $b$, dann gilt
			\begin{align*}
				4 \divs b \land 8 \ndivs b & \implies a \equiv 1 \bmod 4, \\
				8 \divs b & \implies a \equiv 1 \bmod 8.
			\end{align*}
	\end{enumerate}
	\begin{proof}
		Ist $a$ ein Quadrat in $\Z / b\Z$, dann ist $a \equiv c^2 \bmod b$, also $a-c^2 = kb$ für ein $k \in \Z$.
		Damit ist $a = kb + c^2$.
		Setze $y = k$ und $x = c$.
		Sofort sieht man die Umkehrung.
		Sei nun $b = p_1^{\alpha_1} \dotsb p_r^{\alpha_r}$ die Primzahlzerlegung.
		\begin{enumerate}[1)]
			\item
				$a$ ist Quadrat in $U(\Z / b \Z)$ genau dann, wenn $a$ Quadrat in $U(\Z /p_i^{\alpha_i})$ ist.
				Dies folgt aus \ref{1.14}.
			\item
				Ist $p$ ungerade, dann ist $a$ ein Quadrat in $U(\Z / p_i^{\alpha_i} \Z)$ genau dann, wenn $a$ Quadrat in $U(\Z/p_i \Z)$ ist.

				Beweis ist Übung \Exercise: Verwende $\kappa: \Z / p^{\alpha} \Z \to \Z / p \Z$ mit $x \bmod p^\alpha \mapsto x \bmod p$.
				Betrachte $\tilde \kappa = \kappa\big|_{U(\Z / p^{\alpha} \Z)}$.
				$\ker \tilde \kappa$ hat $p$ Potenzordnung, also ungerade Ordnung.
				In endlichen abelschen Gruppen ungerader Ordnung ist jedes Element ein Quadrat.
				Also ist $u \in U(\Z / p^{\alpha} \Z)$ Quadrat, wenn $\tilde \kappa(a)$ Quadrat ist.
			\item
				Sei $2^s$ $2$-Potenzteiler von $b$ (maximale 2er-Potenz, die $b$ teilt).
				Für $s = 1$ ist in $U(\Z / 2\Z)$ also ein Quadrat.
				Für $s = 2$ ist nur $1 \bmod 4$ ein Quadrat.
				Für $s = 3$ ist nur $1 \bmod 8$ ein Quadrat.
				Für $s > 2$ ist $U(\Z / 2^s \Z) \isomorphic C_2 \times C_{2^{s-1}}$ nach \ref{2.10}.
				Betrachte
				\[
					\tilde \kappa: U(\Z / 2^s \Z) \to U(\Z / 8\Z)
				\]
				Ist $x = y^2$ in $\Z / 2^s\Z$, dann ist $\tilde \kappa(x) = \tilde \kappa(y^2) = \tilde \kappa(y) \tilde \kappa(y)$, also ist $\tilde \kappa(x)$ ein Quadrat in $U(\Z / 8\Z)$ und somit $\tilde \kappa(x) \equiv 1 \bmod 8$, also $x \in \ker \tilde \kappa$.
				Ist $x \in \ker \tilde x$, dann ist $x = \_5^i$ mit $2$ teilt $i$ und somit $x$ ein Quadrat.
				Also bildet $\ker \tilde \kappa$ alle Quadrate, also alle Elemente von $U(\Z / 2^s \Z)$, die $\equiv 1 \bmod 8$ sind.
		\end{enumerate}
	\end{proof}
\end{st}







