\chapter{Arithmetik modulo \texorpdfstring{$n$}{n}}



\section{Die Struktur der Einheitengruppe \texorpdfstring{$U(\Z / n\Z)$}{U(ℤ/nℤ)}}


\subsection{\texorpdfstring{$U(\Z / p\Z)$}{U(ℤ/pℤ)}}


% St 2.1
\begin{st} \label{2.1}
	Sei $K$ ein Körper, $U \le U(K) = K^*$ eine endliche Untergruppe der Einheitengruppe von $K$.
	Dann ist $U$ zyklisch.
	\begin{note}
		\begin{itemize}
			\item
				\ref{2.1} klärt insbesondere die Struktur von $\Z / p\Z$ mit Primzahl $p$, so ist $U(\Z / p\Z)$ zyklisch der Ordnung $p - 1$.
			\item
				In einem Schiefkörper sind im Allgemeinen nicht alle endlichen Untergruppen zyklisch, z.B. ist in $\H^*$ die Quaternionengruppe der Ordnung $8$ nicht zyklisch.
		\end{itemize}
		Zum Beweis von \ref{2.1} werden gruppentheoretische Grundlagen benötigt, welche im Folgenden teilweise wiederholt werden.
	\end{note}
	\begin{proof}
		Sei $U \le K^*$ mit $|U| < \infty$.
		Nach \ref{2.3} ist $U \isomorphic P_1 \times \dotsb \times P_k$ und $P_i$ ist $p_i$-Sylowgruppe von $U$.
		Wir zeigen, dass $P_i$ zyklisch ist.

		Sei $d_i$ Teiler von $|P_i|$ und $g \in P_i$ mit $o(g) = d_i$, also wird die Gleichung $x^{d_i} - 1 = 0$ erfüllt.
		Diese Gleichung hat im Körper $K$ höchstens $d_i$ verschiedene Lösungen.
		Ist $g$ eine Lösung, dann auch alle Potenzen von $g$.
		Die von $g$ erzeugte zyklische Gruppe $\<g\> \isomorphic \Z / d_i \Z$ stellt alle Lösungen der Gleichung.

		Es existieren also höchstens $\phi(d_i)$ Elemente der Ordnung $d_i$ in $P_i$.
		Mit \ref{2.6} ist also $P_i$ zyklisch, $P_i \isomorphic \Z / |P_i| \Z$ und
		\[
			U \isomorphic
			\Z / |P_1| \Z \times \dotsb \times \Z / |P_k| \Z
			\stack{\ref{1.14}}\isomorphic
			\Z / (|P_1| \dotsb |P_k|) \Z,
		\]
		also ist $U$ zyklisch.
	\end{proof}
\end{st}

\begin{df*}
	Sei $G$ eine endliche Gruppe.
	Die \emphdef[Ordnung (eines Elements)]{Ordnung} eines Elements $g \in G$, geschrieben $o(g)$ ist die kleinste Zahl $m \in \N$ mit $g^m = 1$.
\end{df*}

% St 2.2
\begin{st}[Lagrange] \label{2.2}
	Sei $G$ eine endliche Gruppe und $U \le G$ eine Untergruppe.
	Dann gilt $|U| \divs |G|$.

	Insbesondere gilt für jedes $g \in G$ auch $o(g) \divs |G|$.
	\begin{proof}
		Siehe Übung.
	\end{proof}
\end{st}

\begin{df*}
	Sei $G$ eine Gruppe.
	Wir definieren die Menge aller Primteiler der Gruppenordnung als
	\[
		\pi(G) := \Set{ p \in \P & p \divs |G| }.
	\]
	$G$ heißt \emphdef{$p$-Gruppe}, wenn $\pi(G) = \Set p$ ist für eine Primzahl $p$.

	Für $M, N \le G$ definieren wir das Produkt $MN := \Set{mn & m \in M, n \in N}$.
	\begin{note}
		$MN$ bildet eine Untergruppe von $G$, wenn $M$ oder $N$ Normalteiler von $G$ sind (leichte Übung).
		Insbesondere ist $MN$ eine Untergruppe von $G$, wenn $M, N$ \emphdef[kommutierende Gruppen]{kommutieren}, d.h. $\forall m \in M, n \in N : mn = nm$.
	\end{note}
\end{df*}


% St 2.3
\begin{st} \label{2.3}
	Sei $G$ endlich und abelsch, $p \in \pi(G)$ und $|G| = p^a n$ mit $(p, n) = 1$.
	Die Menge aller Elemente von $G$ mit $p$-Potenz-Ordnung, d.h.
	\[
		P = \Set{ g \in G & \exists m \in \N_0 : o(g) = p^m }
	\]
	bildet eine normale Untergruppe von $G$ der Ordnung $p^a$, die sogenannte \emphdef{$p$-Sylowgruppe} oder \emphdef{Sylow-$p$-Gruppe} von $G$.

	Sei $|G| = p_1^{a_1} \dotsb p_k^{a_k}$ die Primfaktorzerlegung der Gruppenordnung mit entsprechenden $p_i$-Sylowgruppen $P_i$ von $G$, dann ist
	\[
		G \isomorphic P_1 \times \dotsb \times P_k,
	\]
	d.h. $G$ ist direktes Produkt ihrer Sylowgruppen.
	\begin{note}
		\ref{2.3} kann man leicht aus dem Hauptsatz für endlich erzeugte abelsche Gruppen herleiten.
		Trotzdem liefern wir einen direkten Beweis.
	\end{note}
	\begin{proof}
		\begin{seg}{$P \NormalSubgroup G, |P| = p^a$}
			Seien $x, y \in P$, also $o(x) = p^{m_1}, o(y) = p^{m_2}$.
			Dann gilt $o(xy) \divs p^{\max\Set{m_1, m_2}}$ (hierzu wird $G$ abelsch benötigt).
			Also ist $P \subset G$ multiplikativ abgeschlossen und eine endliche Untergruppe von $G$.

			Da $G$ abelsch, ist $P \normalsubgroup G$ ein Normalteiler.
			Zeige, dass $G / P$ keine Elemente der Ordnung $p$ besitzt:
			Angenommen $xP \in G / P$ mit $o(xP) = p$.
			Wegen $p > 1$ ist $x \not\in P$, aber $x^p \in P$, d.h. $x^p$ und auch $x$ haben $p$-Potenzordnung, ein Widerspruch zu $x \not\in P$.
			In $G / P$ gibt es also keine Elemente der Ordnung $p$.

			Wir nutzen nun Induktion nach $|G|$ über die Primfaktorpotenzen von $|G|$.
			Für $|G| = p^a$ hat nach \ref{2.2} jedes Element von $G$ $p$-Potenz-Ordnung, also $G = P$ und die Aussage ist klar.
			Sei nun $|G| = p^a n$ und die Aussage sei für Gruppenordnung $n$ bereits bewiesen.
			Es gilt $p \not\in \pi(G/P)$, denn wäre $p \in \pi(G/P)$, dann hätte $G/P$ nach Induktionsvoraussetzung eine $p$-Sylowgruppe der Ordnung $p^s$ für ein $s \ge 1$, also besäße $G / P$ Elemente der Ordnung $p$, was den vorigen Überlegungen widerspricht.

			Wegen $p^a n = |G| = |P| \cdot |G / P|$ ist dann also $|P| = p^a$.
		\end{seg}
		\begin{seg}{$G \isomorphic P_1 \times \dotsb \times P_k$}
			Der Fall $k = 1$ ist oben bereits geklärt worden, sei also $k > 1$.
			Nach dem ersten Teil existiert zu jedem $p_i \in \pi(G)$ eine $p_i$-Sylowgruppe $P_i$.

			Setze $\tilde P_1 = \< P_i : i \ge 2 \> = P_2 P_3 \dotsb P_k$.
			Induktiv ist nach \ref{2.5} $\tilde P_1 \NormalSubgroup G$ ein Normalteiler.
			Wegen $(|\tilde P_1|, |P_1|) = 1$, also $\tilde P_1 \cap P_1 = 1$ gilt nach \ref{2.4} $G \isomorphic P_1 \times \tilde P_1$ und somit induktiv $G \isomorphic P_1 \times P_2 \times \dotsb \times P_k$.
		\end{seg}
	\end{proof}
\end{st}

\begin{df*}
	Sei $G$ eine Gruppe und $g, h \in G$.
	Wir bezeichnen das Element $[g,h] := ghg^{-1}h^{-1}$ als \emphdef{Kommutator} von $g$ und $h$.
\end{df*}

% Lem 2.4
\begin{lem} \label{2.4}
	Seien $M, N \normalsubgroup G$ und $M \cap N = 1$.
	Dann ist $M N \isomorphic M \times N$.
	\begin{proof}
		Definiere $\phi: M \times N \to M N$ durch $(m, n) \mapsto mn$.

		$\phi$ ist ein Gruppenhomomorphismus, denn für den Kommutator von $m \in M$ und $n \in N$ gilt
		\[
			M \ni mnm^{-1}n^{-1} \in N,
		\]
		also $mnm^{-1}n^{-1} = 1$, d.h. $mn = nm$ und daher für $m_1, m_2 \in M, n_1, n_2 \in N$
		\begin{align*}
			\phi((m_1, n_1) \cdot (m_2, n_2))
			&= \phi((m_1m_2, n_1n_2)) \\
			&= m_1 m_2 n_1 n_2 \\
			&= m_1 n_1 m_2 n_2
			= \phi(m_1, n_1) \phi(m_2, n_2).
		\end{align*}

		$\phi$ ist injektiv, denn aus $m_1 n_1 = m_2 n_2$ folgt $M \ni m_2^{-1} m_1 = n_2 n_1^{-1} \in N$, also $m_2^{-1}m_1 = 1 = n_2 n_1^{-1}$ und somit $m_1 = m_2, n_1 = n_2$.
		$\phi$ surjektiv ist klar, also ist $\phi$ ein Gruppenisomorphismus.
	\end{proof}
\end{lem}

% Lem 2.5
\begin{lem} \label{2.5}
	Seien $M, N \normalsubgroup G$.
	Dann ist das Produkt $M N \normalsubgroup G$ ein Normalteiler und es gilt
	\[
		M / (M\cap N)
		\isomorphic
		MN / N.
	\]
	Sind $M, N$ endlich, so gilt insbesondere $|MN| = |M|\cdot|N| \cdot \f 1{|M \cap N|}$.
\coursetimestamp{24}{04}{2014}
	\begin{proof}
		Zeige $M N \normalsubgroup G$.
		Zunächst ist $M N \le G$, denn für $m \in M, n \in N$ ist
		\begin{align*}
			(mn)^{-1} &= n^{-1} m^{-1}
			= \underbrace{n^{-1}m^{-1}n}_{\in M} n^{-1}
			\in MN
		\end{align*}
		und für $m_1n_1, m_2n_2 \in M N$ ist
		\[
			m_1 n_1 m_2 n_2
			= m_1 \underbrace{n_1 m_2 n_2}_{\in M} \cdot \underbrace{1}_{\in N}
			\in M N.
		\]
		Außerdem ist schließlich $g \in G, mn \in MN$
		\[
			g^{-1} mn g
			= \underbrace{g^{-1} m g}_{\in M} \underbrace{g^{-1} n g}_{\in N}
			\in M \cdot N.
		\]
		Definiere jetzt $\phi: M / (M \cap N) \to (M N) / N$ durch
		\[
			m(M\cap N) \mapsto mN.
		\]
		$\phi$ ist wohldefiniert, denn wenn $m_1 (M \cap N) = m_2 (M \cap N)$, dann existiert $n \in M \cap N$ mit $m_1 n = m_2$, also $m_1 N = m_2 N$.

		$\phi$ ist ein Gruppenhomomorphismus, denn
		\begin{align*}
			\phi(m_1 (M\cap N) \cdot m_2 (M \cap N))
			&= \phi(m_1m_2(M\cap N)) \\
			&= m_1 m_2 N \\
			&= m_1N \cdot m_2 N \\
			&= \phi(m_1 (M\cap N)) \cdot \phi(m_2 (M\cap N)).
		\end{align*}

		$\phi$ ist injektiv, denn wenn $m_1 N = m_2 N$, existiert $\tilde n \in N$ mit $m_1 \tilde n = m_2$, also $\tilde n = m_1^{-1} m_2 \in M \cap N$ und somit $m_1 M\cap N = m_1 \tilde n M\cap N = m_2 M \cap N$.

		$\phi$ ist surjektiv, denn $m_1 n_1 N = m_1 N = \phi(m_1 M\cap N)$.

		Falls $|M|, |N| < \infty$, dann ist
		\[
			\f {|M|}{|M \cap N|}
			= |M / (M\cap N)|
			\stack{\phi}= |MN / N|
			=  \f {|MN|}{|N|}.
		\]
	\end{proof}
\end{lem}

\begin{nt*}
	Sind $M$ oder $N$ Normalteiler von $G$, dann ist $M N = \<M, N\>$ (leichte Übung), insbesondere ist dann $M N$ der kleinste Normalteiler von $G$, der $M$ und $N$ enthält.
	Sind $M, N$ keine Normalteiler, so gilt dies im Allgemeinen nicht.
\end{nt*}

% Lem 2.6
\begin{lem} \label{2.6}
	Sei $\phi$ die Eulersche $\phi$-Funktion.
	Eine abelsche $p$-Gruppe $G$, d.h. $|G| = p^m$ für ein $m \in \N$, ist genau dann zyklisch, wenn es in $G$ zu jedem Teiler $p^i$ von $|G|$ höchstens $\phi(p^i)$ Elemente der Ordnung $p^i$ gibt.
	In diesem Fall gibt es sogar genau $\phi(p^i)$ solche Elemente in $G$.
	\begin{proof}
		\begin{seg}{\ProofImplication*}
			Die Ordnung eines Elements teilt die Gruppenordning $p^m$ nach \ref{2.2}, also haben alle Elemente von $G$ eine Ordnung der Form $p^i, 0 \le i \le m$.
			Sei $w_i$ die Anzahl der Elemente der Ordnung $p^i$ von $G$, dann gilt
			\begin{align*}
				p^m
				= |G|
				= \sum_{i=0}^m w_i
				&\le \sum_{i=0}^m \phi(p^i) \\
				&\stack{\ref{1.15}}= 1 + \sum_{i=1}^m (p-1)p^{i-1} \\
				&= 1 + (p-1)\sum_{i=1} p^{i-1}
				= p^m
			\end{align*}
			Also gilt Gleichheit: $w_i = \phi(p^i)$ und insbesondere $w_m = \phi(p^m) = (p-1)p^{m-1} > 0$ nach \ref{1.15}.
			Es gibt also ein Element der Ordnung $p^m$, welches dann ganz $G$ erzeugt, also ist $G$ zyklisch.
		\end{seg}
		\begin{seg}{\ProofImplication}
			Sei $G = \<a\>$ zyklisch.
			Jedes Element aus $G$ ist von der Form $a^{p^{m-i} s}$ mit $(p, s) = 1$.

			Nun ist $(a^{p^{m-i} s})^{p^i} = (a^{p^m})^s = 1$.
			Falls $(a^{p^{m-i} s})^{p^j} = 1$ für $j \le i$, dann ist $1 = a^{p^{m-(i-j)} s}$, also $p^m \divs p^{m-(i-j)} s$.
			Wegen $(p, s) = 1$ folgt $p^m \divs p^{m-(i-j)}$, also $i = j$.
			Somit hat $a^{p^{m-i} s}$ die Ordnung $p^i$.

			Es gibt nun gerade $\phi(p^i)$ Elemente der Form $a^{p^{m-i} s}$ (betrachte $(a^{p^{m-i}})^s$, hier sind es gerade alle $1 \le s \le p^i$ mit $(s, p) = 1$).
		\end{seg}
	\end{proof}
\end{lem}


Unser Ziel war es, die Struktur von $U(\Z / n \Z)$ zu untersuchen.
\ref{2.1} klärt dies für den Fall $n = p$ mit Primzahl $p$:
\[
	U(\Z / p \Z) = (\Z / p \Z)^* \isomorphic C_{p-1}.
\]

\subsubsection{Primitivwurzeln}

Mit Bézout haben wir bereits mehrfach gesehen: ist $U(\Z / n \Z)$ zyklisch (z.B. wie bereits gesehen für $n$ prim, für genauere Charakterisierung siehe \ref{2.11}), so sind alle Elemente aus $\Z / n \Z$ genau dann Erzeuger von $U(\Z / n \Z)$, wenn sie teilerfremd zu $n$ sind.

\begin{df*}
	Sei $n \in \N$ mit $U(\Z / n \Z)$ zyklisch.
	Einen Erzeuger von $U(\Z / n \Z)$ nennt man \emphdef[Primitivwurzel]{Primitivwurzel modulo $n$}.
	Der kleinste Erzeuger wird auch mit $k(n)$ bezeichnet.
\end{df*}

\begin{ex*}
	Es gilt
	\begin{align*}
		k(3) &= 2, &
		k(5) &= 2, &
		k(7) &= 3, &
		k(11) &= 2, &
		k(5881) &= 31.
	\end{align*}
	Im Allgemeinen sind die Erzeuger unregelmäßig verteilt.
\end{ex*}

\begin{conj*}[E. Artin]
	Sei $a \in \N$ und $a$ sei kein Quadrat, dann existiert eine ungerade Primzahl $p$ für die $a \bmod p$ eine Primitivwurzel ist.
	\begin{note}
		Warum darf $a$ kein Quadrat sein?
		siehe Übung.
	\end{note}
\end{conj*}

\subsection{\texorpdfstring{$U(\Z / p^s \Z), p > 2$}{U(ℤ/p\textasciicircum sℤ), p>2}}

Der nächste Schritt zur Struktur von $U(\Z / m \Z)$ ist die Betrachtung von Primzahlpotenzen $m = p^s$.

\begin{ex*}
	Es gilt
	\begin{alignat*}{3}
		U(\Z / 4 \Z) &= \{ \_ 1, \_ 3 \}& & \isomorphic C_2, \\
		U(\Z / 8 \Z) &= \{ \_ 1, \_ 3, \_ 5, \_ 7 \}& & \isomorphic C_2 \times C_2,
	\end{alignat*}
	wie sich z.B. durch Nachrechnen mit einer Multiplikationstabelle ergibt.

	Zu unserer Enttäuschung sehen wir, dass $U(\Z / 8 \Z) \isomorphic C_2 \times C_2$ nicht zyklisch ist.
\end{ex*}

Es wird sich zeigen, dass $U(\Z / p^s \Z)$ zyklisch ist, wenn $p$ eine ungerade Primzahl ist.
Zunächst ein Lemma zum Rechnen bezüglich Primzahlpotenzresten:

% Lem 2.7
\begin{lem} \label{2.7}
	Sei $p \in \P, s \in \N$ und $a, b \in \Z$.
	\begin{enumerate}[a)]
		\item
			$a \equiv b \bmod p^s \implies a^p \equiv b^p \bmod p^{s+1}$,
		\item
			Sei $s \ge 2, p > 2$.
			Dann gilt
			\[
				(1 + ap)^{p^{s-2}}
				\equiv 1 + ap^{s-1} \mod p^s.
			\]
		\item
			Sei $p \ndivs a, p > 2$.
			Dann ist $o(1 + ap \bmod p^s) = p^{s-1}$ in $U(\Z / p^s \Z)$.
		\item
			Sei $s \ge 3$, dann gilt
			\[
				5^{2^{s-3}} \equiv 1 + 2^{s-1} \mod 2^s
			\]
			und $o(5 \bmod 2^s) = 2^{s-2}$.
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Wenn $a \equiv b \bmod p^s$, dann ist $a = b + k p^s$ und
				\[
					a^p
					= (b + kp^s)^p
					= b^p + \sum_{j=1}^{p-1} \binom{p}{j} b^{p-j} (kp^s)^j + (kp)^{sp}
				\]
				Nun ist $\binom{p}{r}$ durch $p$ teilbar für $1 < r < p$, also
				\[
					\sum_{j=1}^{p-1} \binom{p}{j} b^{p-j} (kp^s)^j \equiv 0 \mod p^{s+1}
				\]
				und zusammen mit $(kp)^{sp} \equiv 0 \bmod p^{s+1}$ somit $a^p \equiv b^p \bmod p^{s+1}$.
			\item
\coursetimestamp{28}{04}{2014}
				Verwende Induktion nach $s$.
				Für $s = 2$ gilt die Aussage: $(1 + ap)^{p^{2-2}} = 1 + ap = 1 + ap^{2-1}$.
				Die Aussage gelte für ein $s \in \N$, zeige selbige für $s + 1$.
				Es gilt
				\begin{align*}
					(1 + ap)^{p^{s-1}}
					&= \Big((1 + ap)^{p^{s-2}}\Big)^p \\
					&\stack{\text{a)}}\equiv \big(1 + ap^{s-1} \big)^p \mod p^{s+1} \\
					&= 1 + \underbrace{\binom{p}{1} ap^{s-1}}_{= ap^s} + \underbrace{\sum_{j=2}^p \binom{p}{j} (ap^{s-1})^j}_{\text{$p^{s+1} \divs \dotsc$ wegen $p > 2$}} \\
					&\equiv 1 + ap^s \mod p^{s+1}.
				\end{align*}
			\item
				Aus b) und a) folgt
				\begin{align*}
					(1 + ap)^{p^{s-1}}
					&= \Big( (1+ap)^{p^{s-2}} \Big)^p \\
					&\stack{b)}\equiv (1 + ap^{s-1})^p \\
					&= 1 + \underbrace{\sum_{j=1}^p (ap^{s-1})^j}_{\equiv 0 \bmod p^s}
					\equiv 1 \mod p^s.
				\end{align*}
				Damit hat $(1 + ap) \bmod p^s$ hat eine Ordnung, die $p^{s-1}$ teilt.
				Nach Voraussetzung gilt, dass $p \ndivs a$, also $p^s \ndivs ap^{s-1}$ und mit b)
				\[
					(1 + ap)^{p^{s-2}} \equiv 1 + ap^{s-1} \not\equiv 1 \bmod p^s.
				\]
				Also ist die Ordnung von $(1 + ap) \bmod p^s$ gerade $p^{s-1}$.
			\item
				Analog per Induktion (beachte $s \ge 3$), siehe Übung.
				\Exercise
		\end{enumerate}
	\end{proof}
\end{lem}

% St 2.8
\begin{st} \label{2.8}
	Sei $p \in \P$ ungerade, $s \in \N$.
	Dann ist $U(\Z / p^s \Z)$ zyklisch mit Gruppenordnung $\phi(p^s) = (p-1)p^{s-1}$.
	\begin{proof}
		Für $s = 1$ ist dies gerade \ref{2.3}.
		Also existiert $g \in \Z$ mit $g^{p-1} \equiv 1 \bmod p$ und $g^i \not\equiv 1 \bmod p$ für $1 \le i \le p -1$.
		Wir zeigen, dass $g$ so gewählt werden kann, dass zusätzlich $g^{p-1} \equiv 1 + ap \bmod p^2$ gilt für ein $a \not\equiv 0 \bmod p$.
		Dazu unterscheiden wir zwei Fälle:
		\begin{segnb}{$g^{p-1} \equiv 1 \bmod p^2$}
			In diesem Fall ist $(g + p)^{p-1} \equiv 1 \bmod p$ und $(g + p)^i \not\equiv 1 \bmod p$ für $1 \le i < p-1$ und
			\[
				(g + p)^{p - 1} \equiv \underbrace{g^{p-1}}_{\equiv 1 \bmod p^2} + \underbrace{\binom{p-1}{1}g^{p-2}}_{=: a} p \mod p^2
			\]
			Also gilt $(g + p)^{p-1} \equiv 1 + ap \bmod p^2$ mit $a \not\equiv 0 \bmod p$.
			Hier erfüllt $g + p$ also die gewünschten Eigenschaften.
		\end{segnb}
		\begin{segnb}{$g^{p-1} \not\equiv 1 \bmod p^2$}
			$g$ erfüllt dann bereits die gewünschte Eigenschaft, denn wegen $g^{p-1} \equiv 1 \bmod p$ ergibt sich die Form $g^{p-1} = 1 + ap \bmod p^2$ mit $a \not\equiv 0 \bmod p$.
		\end{segnb}
		Ohne Einschränkung wählen wir also $g \in \Z$ mit
		\begin{itemize}
			\item
				$g^{p-1} \equiv 1 \bmod p$,
			\item
				$g^i \not\equiv 1 \bmod p$ für alle $1 \le i \le p - 1$,
			\item
				$g^{p-1} \equiv 1 + ap \bmod p^2$ mit $a \not\equiv 0 \bmod p$.
		\end{itemize}
		Nach \ref{2.7} b) gilt jetzt
		\[
			(1 + ap)^{p^{s-2}} \equiv 1 + ap^{s-1} \mod p^s
		\]
		für $s \ge 2, p \neq 2$ und nach \ref{2.7} c) hat $(1 + ap) \bmod p^s$ die Ordnung $p^{s-1}$ in $U(\Z / p^s \Z)$.
		Damit ist
		\begin{itemize}[i)]
			\item
				$g^{(p-1)p^{s-1}} = (g^{p-1})^{p^{s-1}} \equiv 1 \bmod p^s$,
			\item
				$g^d \not\equiv 1 \bmod p^s$ für alle $1 \le d \le (p-1)p^{s-1}$:

				Denn angenommen $d$ sei (ohne Einschränkung) ein maximaler echter Teiler von $(p-1)p^{s-1}$ mit $g^d \equiv 1 \bmod p^s$.
				Falls $d = (p-1)p^{s-2}$ ist, dann ergibt
				\[
					g^{(p-1)p^{s-2}} = (1 + ap)^{p^{s-2}} \stackrel{\ref{2.7} c)}\equiv 1 + ap^{s-1} \not\equiv 1 \bmod p^s
				\]
				einen Widerspruch.
				Also ist $d$ von der Form $d = mp^{s-1}$, wobei $m$ ein maximaler Teiler von $p-1$ ist.
				Es gilt insbesondere $g^{mp^{s-1}} \equiv 1 \bmod p$ und nach \ref{2.9}
				\[
					1 \equiv (g^{p^{s-1}})^m \equiv g^m,
				\]
				ein Widerspruch zu $g^i \neq 1 \bmod p$ für alle $1 \le i \le p - 1$.
		\end{itemize}
		Damit hat $g$ die Ordnung $(p-1)p^{s-1}$ in $U(\Z/p^s\Z)$ und wegen $|U(\Z/p^s\Z)| = (p-1)p^{s-1}$ ist $U(\Z/p^s \Z)$ zyklisch mit Erzeuger $g$.
	\end{proof}
\end{st}

% Lem 2.9
\begin{lem}[„Kleiner Fermat'scher Satz“] \label{2.9}
	Sei $p \in \P$, dann ist $a^p \equiv a \bmod p$ für beliebiges $a \in \Z$.
	\begin{proof}
		Für $a \equiv 0 \bmod p$ ist dies klar.
		Falls $a \not\equiv 0 \bmod p$, dann ist wegen $|U(\Z / p\Z)| = p - 1$ auch $a^{p-1} \equiv 1 \bmod p$ und somit $a^p \equiv a \bmod p$.
	\end{proof}
\end{lem}

\subsection{\texorpdfstring{$U(\Z/2^s \Z)$}{U(ℤ/2\textasciicircum sℤ)}}

% St 2.10
\begin{st} \label{2.10}
	Es gilt
	\begin{align*}
		U(\Z / 2 \Z) &\isomorphic 1, &
		U(\Z / 4 \Z) &\isomorphic C_2
	\end{align*}
	und für $s \ge 3$
	\begin{align*}
		U(\Z / 2^s \Z)
		&= \< -1 \bmod 2^s \> \< 5 \bmod 2^s \> \\
		&\isomorphic \< - 1 \bmod 2^s \> \times \< 5 \bmod 2^s \> \\
		&\isomorphic C_2 \times C_{2^{s-2}}.
	\end{align*}
	\begin{note}
		Im Unterschied zu $p > 2$, ist $U(\Z / 2^s \Z)$ nicht zyklisch für $s \ge 3$.
		Wir hatten gesehen, dass $U(\Z / 8 \Z) \isomorphic C_2 \times C_2$, d.h. das Quadrat einer ungeraden Zahl ist stets $\equiv 1 \bmod 8$.
	\end{note}
	\begin{proof}
		Offenbar sind $\< -1 \bmod 2^s\>, \<5 \bmod 2^s\> \le U(\Z / 2^s \Z)$ Untergruppen und sogar Normalteiler, da $\Z$ abelsch.
		Nach \ref{2.7} d) ist $|\<5 \bmod 2^s\>| = o(5 \bmod 2^s) = 2^{s-2}$ und es gilt $|\< -1 \bmod 2^s\>| = o(-1 \bmod 2^s) = 2$ für $s \ge 2$.
		Gilt nun $\<-1 \bmod 2^s\> \cap \<5 \bmod 2^s\> = 1$, so ist mit \ref{2.5}
		\begin{align*}
			\big|\<-1 \bmod 2^s\> \<5 \bmod 2^s\> \big|
			&= |\<-1 \bmod 2^s\>| \cdot |\<5 \bmod 2^s\>| \\
			&= 2 \cdot 2^{s-2}
			= 2^{s-1}
			= \phi(2^s)
			= U(\Z / 2^s \Z),
		\end{align*}
		also $U(\Z / 2^s \Z) = \<-1 \bmod 2^s\> \<5 \bmod 2^s\>$ und mit \ref{2.4} auch
		\[
			U(\Z / 2^s \Z) \isomorphic \<-1 \bmod 2^s\> \times \<5 \bmod 2^s\>
			\isomorphic C_2 \times C_{2^{s-2}}.
		\]
		Es verbleibt $\<-1 \bmod 2^s\> \cap \<5 \bmod 2^s\> = 1$ zu zeigen.
		Zeige dazu $-1 \bmod 2^s \not\in \< 5 \bmod 2^s \>$.
		Betrachte $\kappa: \Z / 2^s \Z \to \Z / 4 \Z$ mit $x \bmod 2^s \mapsto x \bmod 4$.
		Offensichtlich ist $\kappa$ ein (sogar surjektiver) Ringhomomorphismus.
		Es gilt
		\begin{alignat*}{3}
			\kappa((5 \bmod 2^s)^j) &= (5 \bmod 4)^j = 1^j \bmod 4 &&= 1 \bmod 4, \\
			\kappa(-1 \bmod 2^s) &= -1 \bmod 4 &&= 3 \bmod 4,
		\end{alignat*}
		also $-1 \bmod 2^s \not\in \< 5 \bmod 2^s\>$.
	\end{proof}
\end{st}

% Folg 2.11
\begin{kor} \label{2.11}
	Sei $n \in \N$ mit Primfaktorzerlegung $n = p_1^{\alpha_1} \dotsb p_k^{\alpha_k}$.
	Dann ist nach \ref{1.14} b)
	\[
		U(\Z / n\Z) \isomorphic U(\Z / p_1^{\alpha_1}\Z) \times \dotsb \times U(\Z / p_k^{\alpha_k} \Z),
	\]
	wobei die Faktoren der rechten Seie durch \ref{2.8} und \ref{2.10} folgendermaßen gegeben sind:
	\[
		U(\Z / p_i^{\alpha_i} \Z)
		\isomorphic \begin{cases}
			1 & p_i = 2, \alpha_i = 1 \\
			C_2 \times C_{2^{\alpha_i - 2}} & p_i = 2, \alpha_i \ge 2 \\
			C_{(p_i-1)p_i^{\alpha_i - 1}} & p_i > 2
		\end{cases}.
	\]
\end{kor}

\begin{ex*}
	Für $n = 8 \cdot 5 \cdot 3^2 = 360$ ergibt sich
	\begin{align*}
		U(\Z / 360 \Z)
		&\isomorphic U(\Z / 8 \Z) \times U(\Z / 5 \Z) \times U(\Z / 3^2 \Z) \\
		&\isomorphic C_2 \times C_2 \times C_4 \times C_6 \\
		&\isomorphic \underbrace{C_2 \times C_2 \times C_2 \times  C_4}_{=P_2} \times \underbrace{C_3}_{=P_3},
	\end{align*}
	wobei $P_2, P_3$ die $2$-, bzw. $3$-Sylowgruppe ist.
\end{ex*}

% Folg 2.12
\begin{kor} \label{2.12}
	$U(\Z / n\Z)$ ist zyklisch genau dann, wenn $n \in \{1, 2, 4, 2p^k, p^k \}$ für eine ungerade Primzahl $p \in \P$.
	\begin{proof}
		Siehe Übung.
		\Exercise
	\end{proof}
\end{kor}

\section{Quadratische Reste}

Wann ist eine Kongruenz der Form
\[
	x^2 \equiv a \mod p
\]
mit $2 \neq p \in \P$ lösbar in $\Z / p\Z$ ($a \not\equiv 0 \bmod p$)?

% Def 2.13
\begin{df} \label{2.13}
	\begin{enumerate}[a)]
		\item
		Sei $b \in \Z, m \in \N$ mit $m > 1$ und $(b, m) = 1$, dann nennt man $b$ \emphdef{quadratischer Rest} modulo $m$, wenn
		\[
			x^2 \equiv b \bmod m
		\]
		eine Lösung in $U(\Z / m\Z)$ besitzt.
		\item
			Sei $p \in \P, p > 2$ und $b \in \Z$.
			Das \emphdef{Legendresymbol} von $b$ und $p$, geschrieben $\legsym bp \in \Z$, ist definiert als
			\[
				\legsym bp := \begin{cases}
					1 & \text{$b$ quadratischer Rest modulo $p$} \\
					-1 & \text{$b$ kein quadratischer Rest modulo $p$} \\
					0 & \text{$b \equiv 0 \bmod p$}
				\end{cases}.
			\]
			Wenn $(b, p) = 1$, dann tritt der Fall $\legsym bp = 0$ nicht ein.
	\end{enumerate}
\end{df}

\coursetimestamp{05}{05}{2014}

% Lem 2.14
\begin{lem} \label{2.14}
	Sei $p \in \P, p > 2$.
	Es gelten die folgenden Aussagen:
	\begin{enumerate}[a)]
		\item
			Sei $b \in \Z$ mit $(b, p) = 1$.
			Dann ist $b$ genau dann quadratischer Rest modulo $p$, wenn $b^{\f {p-1}2} \equiv 1 \bmod p$
			ist und kein quadratischer Rest, wenn $b^{\f {p-1}2} \equiv -1 \bmod p$	ist, d.h.
			\[
				\legsym bp = b^{\f {p-1}2} \mod p.
			\]
		\item
			Sei $a, b \in \Z$ mit $(a,p) = 1 = (b, p)$.
			Dann gilt
			\[
				\legsym ap \legsym bp = \legsym {ab}p.
			\]
			Mit $a = b = 1$ folgt $\legsym 1p \legsym 1p = \legsym 1p$, also $\legsym 1p = 1$.

			Das Legendresymbol liefert damit einen Gruppenhomomorphismus zwischen der multiplikativen Gruppe $(\Z / p\Z)*$ und $(\{-1,1\}, \cdot)$:
			\begin{align*}
				\kappa: (\Z / p\Z)^* &\to (\{1,-1\}, \cdot), \\
				a &\mapsto \legsym ap.
			\end{align*}
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				$U(\Z / p\Z)$ ist zyklisch von der Ordnung $p - 1$, die Quadrate bilden dann eine Untergruppe von Index 2.
				Es gilt $a^{p-1} \equiv 1 \bmod p$ für alle $a \in U(\Z / p\Z)$.
				Wegen $|Q| = \f 12 (p-1)$ ist $a^{\f {p-1}2} \equiv 1 \bmod p$ (Ordnung eines Elementes teilt Gruppenordnung) für alle $a \in Q$.
				$U := U(\Z / p \Z)$ ist zyklisch, also ist $-1 \bmod p$ die einzige Involution in $U$.
				Wenn $a^{\f{p-1}2} \not\equiv 1 \bmod p$, dann ist $a^{\f{p-2}2} \equiv -1 \bmod p$ ,denn $(a^{\f{p-1}2})^2 = a^{p-1} \equiv 1 \bmod p$.
				$Q$ ist die einzige Untergruppe von $U$ der Ordnung $\f{p-1}2$ (siehe Bemerkung).
				Ist $b$ ein Nichtquadrat, dann ist $b^{\f{p-1}2} \equiv -1 \bmod p$.
			\item
				Nach \ref{2.1} ist $U(\Z / p\Z) = (\Z / p\Z)^*$ zyklisch.
				Die Quadrate von $U(\Z / p \Z)$ bilden eine Untergruppe $Q$ von Index 2. \Exercise
				Daher ist mit $a \bmod p$ quadratisch und $b \bmod p$ quadratisch auch $ab \bmod p$ quadratisch.
				Ist $a \bmod p$ kein Quadrat und $b \bmod p$ quadratisch, dann ist $ab \mod p$ kein Quadrat.
				Wenn $a \bmod p$ und $b \bmod p$ keine Quadrate sind, so ist $ab \mod p$ ein Quadrat wegen Index 2.
				Also ist $\kappa$ ein Homomorphismus.
		\end{enumerate}
	\end{proof}
\end{lem}

\begin{nt*}
	In \ref{2.6} wurde gezeigt, dass zyklische $p$-Gruppen zu jedem Teiler der Gruppenordnung genau eine Untergruppe haben.
	Mit \ref{1.14} folgt: in einer endlichen zyklischen Gruppe $G$ gibt es zu jedem Teiler $t$ der Gruppenordnung $|G|$ genau eine Untergruppe der Ordnung $t$.
	Dies ist eine Übungsaufgabe. \Exercise
\end{nt*}

% St 2.15
\begin{st}[Quadratisches Reziprozitätsgesetz, Gauß 1796] \label{2.15}
	Seien $p$, $q$ verschiedene ungerade Primzahlen, dann gilt
	\begin{enumerate}[a)]
		\item
			$\legsym qp \legsym pq = (-1)^{\f {p-1}2 \f{q-1}2}$,
		\item
			$\legsym {-1}p = (-1)^{\f {p-1}2}$,
		\item
			$\legsym 2p = (-1)^{\f{p^2 -1}8}$.
	\end{enumerate}
	Diese Aussagen werden in der Literatur oft als erster und zweiter Ergänzungssatz bezeichnet.
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Sei $\zeta$ eine primitive $q$-te Einheitswurzel.
				Betrachte
				\[
					\tau = \sum_{1 \le a \le q-1} \underbrace{\legsym aq \zeta^a}_{\in \Z[\zeta]},
				\]
				mit $\Z[\zeta] = \{ a_0 + a_1 \zeta^1 + \dotsb + a_{q-1} \zeta^{q-1} : a_j \in \Z\}$.

				Wir nehmen nun an, dass
				\begin{equation} \label{eq:2.15_1}
					\tau^2 = \legsym {-1}q q
				\end{equation}
				gilt.
				Mit \ref{2.14} a) haben wir
				\[
					\legsym qp \equiv q^{\f {p-1}2} \mod p
				\]
				und mit \ref{2.15} b)
				\[
					\legsym {-1}q = (-1)^{\f {q-1}2}.
				\]
				Es gilt dann
				\begin{align*}
					\tau^p
					= \tau (\tau^2)^{\f{p-1}2}
					= \tau \big( \legsym {-1}q q \big)^{\f {p-1}2}
					&= \tau \big( (-1)^{\f {q-1}2} q \big)^{\f {p-1}2} \\
					&\stack{\ref{2.14}}\equiv \tau (-1)^{\f{q-1}2 \cdot \f {p-1}2} \legsym qp \mod p.
				\end{align*}
				Andererseits gilt
				\begin{align*}
					\tau^p
					&= \Big( \sum_{1 \le a \le q-1} \legsym aq \zeta^a \Big)^p \\
					&\equiv \sum_{1 \le a \le q-1} \legsym aq \zeta^{ap} \\
					&\equiv \legsym pq \sum_{1 \le a \le q-1} \legsym aq \legsym pq \zeta^{ap} \\
					&\stack{\ref{2.14} b)}\equiv \legsym pq \sum_{1 \le a \le q-1} \legsym {ap}q \zeta^{ap} \\
					&\stack{\text{s.u.}}\equiv \legsym pq \tau \mod p,
				\end{align*}
				%Es gilt $\legsym xq = \legsym {x+kp}q$, mit $p \neq q$
				denn die Multiplikation mit $p$ permutiert die Restklassen bezüglich $q$ und genauso für $\{\zeta, \dotsc, \zeta^{q-1}\} = \{\zeta^p, \dotsc, \zeta^{p(q-1)}\}$.
				Damit ist
				\[
					\tau (-1)^{\f{q-1}2 \f {p-1}2} \legsym qp
					\equiv \tau \legsym pq \mod p
				\]
				%multiplizieren mit 2 und
				zusammen mit \eqref{eq:2.15_1} folgt
				\[
					\legsym {-1}q q (-1)^{\f{q-1}2 \f {p-1}2} \legsym qp
					\equiv \legsym {-1}q q \legsym pq \mod p
				\]
				$\legsym {-1}q q$ ist invertierbar $\bmod p$, also
				\[
					(-1)^{\f {q-1}2 \f {p-1}2} \legsym qp
					\equiv \legsym pq \mod p
				\]
				und die Aussage ist gezeigt.

				Es bleibt noch \eqref{eq:2.15_1} zu zeigen.
				Wir zeigen äquivalent $\legsym {-1}q \tau^2 = q$.
				Es gilt mit $\sum_{b} \legsym bq \zeta^b = \sum_{b} \legsym {-b}q \zeta^{-b}$
				\[
					\tau^2 = \Big( \sum_{a} \legsym aq \zeta^a \Big) \Big( \sum_{b} \legsym {-b}q \zeta^{-b} \Big)
					\stackrel{\ref{1.14} b)}= \sum_{ab} \legsym {a(-b)}q \zeta^{a-b}
				\]
				und damit
				\begin{align*}
					\legsym {-1}q \tau^2
					&= \sum_{a,b} \legsym {-1}q \legsym {a(-b)}q \zeta^{a-b}
					= \sum_{a,b} \legsym {ab}q \zeta^{a-b}
				\intertext{%
					wähle $\tilde b$ mit $\tilde b b \equiv 1 \bmod q$, dann ist $\legsym {ab}q = \legsym aq \legsym bq = \legsym aq \legsym {\tilde b}q = \legsym {a\tilde b}q$ und mit $c := a\tilde b$ ist $a \equiv cb \bmod q$, also $\zeta^a = \zeta^{cb}$ es gilt weiter
				}
					&= \sum_{a,b} \legsym {a\tilde b}q \zeta^{a-b}
					\stackrel{c=a\tilde b}= \sum_{c,b} \legsym cq \zeta^{bc-b} \\
					&= \sum_{c\neq 1} \Big( \legsym cq \sum_{b} \zeta^{bc-b} \Big) + \underbrace{\sum_{b} \legsym 1q}_{=q-1}
				\intertext{%
					$\xi := \zeta^{c-1}$ ist ebenfalls eine $q$-te Einheitswurzel und daher $\sum_{b} \zeta^{(1-c)b} = \sum_{k=1}^{q-1} \xi^k = -1$.
					Zusammen mit $\sum_{c} \legsym cq = 0$ folgt schließlich
				}
					&= - \sum_{c\neq 1} \legsym cq + q-1 \\
					&= - (-1) + q - 1 \\
					&= q
				\end{align*}
			\item
				Nach \ref{2.14} a) gilt
				\[
					\legsym {-1}p \equiv (-1)^{\f{p-1}2} \mod p.
				\]
				Da $p$ ungerade folgt $\legsym {-1}p = (-1)^{\f {p-1}2}$.
			\item
				In $\Z[i] = \{ a + bi : a,b \in \Z \} \le \C$ gilt
				\[
					(1 + i)^p
					= (1 + i)(\underbrace{(1 + i)^2}_{=2i})^{\f {p-1}2}
					= (1 + i) i^{\f{p-1}2} 2^{\f{p-1}2}
				\]
				Ferner gilt $(1 + i)^p \equiv 1 + i^p \bmod p$ ($\binom{p}{j} \equiv 0 \bmod p$ für $1 \le j \le p-1$) und $\legsym 2p \equiv 2^{\f {p-1}2} \bmod p$ nach \ref{2.14} a).

				Sei $\f {p-1}2$ gerade, dann ist $p-1$ durch $4$ teilbar und $i^p = i$, also
				\[
					\legsym 2p (1+i) i^{\f {p-1}2}
					\equiv 1 + i^p
					\equiv 1 + i \mod p.
				\]
				Es gilt
				\[
					\legsym 2p (1 + i)(1 - i) (-1)^{\f {p-1}4}
					\equiv (1 +i)(1 -i) \mod p
				\]
				und mit $((-1)^{\f p4})^2 = 1$ damit $\legsym 2p \equiv (-1)^{\f{p-1}4} \bmod p$.

				Sei $\f {p-1}2$ ungerade.
				Dann gilt
				\[
					\legsym 2p (1 +i)i^{\f {p-1}2}
					\equiv 1 + i^p
					\equiv 1 -i \mod p
				\]
				und mit $1 + i$ multipliziert
				\[
					\legsym 2p 2 \underbrace{i i^{{p-1}2}}_{=i^{\f{p+1}2}}
					\equiv 2 \bmod p,
				\]
				also
				\[
					\legsym 2p \underbrace{i^{p+1}}_{= 1} \equiv \underbrace{i^{\f{p+1}2}}_{=(-1)^{\f {p+1}4}} \mod p.
				\]
				Da $p$ ungerade folgt
				$\legsym 2p = (-1)^{\f {p-1}4} \mod p$ (im Fall $\f {p-1}2$ gerade), bzw. $\legsym 2p = (-1)^{\f{p+1}4}$ (im anderen Fall).
				Ist $\f {p-1}2$ gerade, so ist $\f {p+1}2$ ungerade und somit
				\[
					(-1)^{\f{p-1}4}
					= \big((-1)^{\f{p-i}4} \big)^{\f{p+1}2}
					= (-1)^{\f{p^2-1}8}.
				\]
				Wenn $\f {p-1}2$ ungerade, dann ist
				\[
					(-1)^{\f {p+1}4}
					= \big( (-1)^{\f {p+1}4} \big)^{\f{p-1}2}
					= (-1)^{\f {p^2 - 1}8}.
				\]
		\end{enumerate}
	\end{proof}
\end{st}

\coursetimestamp{08}{05}{2014}

% Bem + Bsp 2.16
\begin{nt} \label{2.16}
	\begin{enumerate}[a)]
		\item
			Es gilt
			\[
				\legsym pq = \legsym qp
			\]
			wenn $p \equiv 1 \bmod 4$ oder $q \equiv 1 \bmod 4$.
			Außerdem
			\[
				\legsym pq = - \legsym qp
			\]
			wenn $p \equiv 3 \bmod 4$ und $q \equiv 3 \bmod 4$.
		\item
			Ist $5$ ein Quadrat in $\Z / 23\Z$?
			Wir interessieren uns also für
			\[
				\legsym 5{23}
				= \legsym {23}5
				= \legsym 35
				= -1,
			\]
			die Antwort ist also „nein“.
		\item
			Wegen $67 \equiv 3 \bmod 4, 139 \equiv 3 \bmod 4$ ist
			\begin{align*}
				\legsym{67}{139}
				&= - \legsym{139}{67}
				= - \legsym{72}{67}
				\stack{\ref{2.14}}= - \legsym{36}{67} \legsym{2}{67}
				\stack{\ref{2.14}}= - \underbrace{\legsym{6}{67} \legsym{6}{67}}_{=1} \legsym{2}{67} \\
				&= - \legsym{2}{67}
				= - (-1)^{\f{67^2-1}{8}}
				= - (-1)^{33\cdot 17}
				= 1
			\end{align*}
	\end{enumerate}
\end{nt}

Zum Abschluss dieses Kapitels noch zwei Anwendungen.

\begin{df*}
	Sei $n, m \in \N$
	Man bezeichnet die Menge aller Repräsentanten der Restklasse $n \bmod m$, d.h.
	\[
		\{ n + km : k \in \N \},
	\]
	als \emphdef[analytische Progression]{analytische Progression $n \bmod m$}.
\end{df*}

\begin{st}[Dirichlet] \label{2.17}
	In jeder arithmetischen Progression $n \bmod m$ mit $(n,m) = 1$ befinden sich unendlich viele Primzahlen.
	\begin{note}
		Der Satz gehört in die analytische Zahlentheorie, der Beweis verwendet analytische Methoden.

		Genauer kann man zeigen, dass asymptotisch
		\[
			\# \text{Primzahlen $\le x$ in $n \bmod m$}
			\sim
			\f {x}{\phi(m) \log x}.
		\]
		Bezeichne $\pi(x)$ die Anzahl der Primzahlen $\le x$, dann besagt der sogenannte Primzahlsatz, dass asymptotisch
		\[
			\pi(x) \sim \f{x}{\log x}.
		\]
		Im Augenblick müssen wir uns mit Spezialfällen dieses Satzes begnügen.
	\end{note}
	\begin{proof}[Für den Spezialfall $1 \bmod 4$]
		Angenommen, es gäbe nur endlich viele Primzahlen $p_1, \dotsc, p_k$, die $\equiv 1 \bmod 4$ sind.
		Setze
		\[
			n = (2 p_1 p_2 \dotsb p_k)^2 + 1
		\]
		Dann ist $n \equiv 1 \bmod 4$.
		Ist $q$ ein Primteiler von $n$, so ist $2(p_1\dotsb p_k)^2 + 1 \equiv 0 \bmod q$, also $-1$ ist Quadrat modulo $q$, d.h. $\legsym{-1}{q} = 1$.

		Nach dem ersten Ergänzungssatz ist $\legsym{-1}{q} = (-1)^{\f{q-1}2}$, also ist $q \equiv 1 \bmod 4$.
		Nach Konstruktion von $n$ sind alle Primteiler von $n$ kongruent zu $3 \bmod 4$.
	\end{proof}
	\begin{proof}[Für den Spezialfall $3 \bmod 4$]
		siehe Übung.
	\end{proof}
\end{st}




% St 2.18
\begin{st} \label{2.18}
	Die diophantische Gleichung $x^2 + by = a$ mit $(a,b) = 1$ ist genau dann lösbar, wenn gilt
	\begin{enumerate}[i)]
		\item
			Für jede ungerade Primzahl $p$, die $b$ teilt, ist $\legsym ap = 1$,
		\item
			falls $2$ Teiler von $b$, dann gilt
			\begin{align*}
				4 \divs b \land 8 \ndivs b & \implies a \equiv 1 \bmod 4, \\
				8 \divs b & \implies a \equiv 1 \bmod 8.
			\end{align*}
	\end{enumerate}
	\begin{proof}
		Ist $a$ ein Quadrat in $\Z / b\Z$, dann ist $a \equiv c^2 \bmod b$, also $a-c^2 = kb$ für ein $k \in \Z$.
		Damit ist $a = kb + c^2$.
		Setze $y = k$ und $x = c$.
		Sofort sieht man die Umkehrung.
		Sei nun $b = p_1^{\alpha_1} \dotsb p_r^{\alpha_r}$ die Primzahlzerlegung.
		\begin{enumerate}[1)]
			\item
				$a$ ist Quadrat in $U(\Z / b \Z)$ genau dann, wenn $a$ Quadrat in $U(\Z /p_i^{\alpha_i})$ ist.
				Dies folgt aus \ref{1.14}.
			\item
				Ist $p$ ungerade, dann ist $a$ ein Quadrat in $U(\Z / p_i^{\alpha_i} \Z)$ genau dann, wenn $a$ Quadrat in $U(\Z/p_i \Z)$ ist.

				Beweis ist Übung \Exercise: Verwende $\kappa: \Z / p^{\alpha} \Z \to \Z / p \Z$ mit $x \bmod p^\alpha \mapsto x \bmod p$.
				Betrachte $\tilde \kappa = \kappa\big|_{U(\Z / p^{\alpha} \Z)}$.
				$\ker \tilde \kappa$ hat $p$ Potenzordnung, also ungerade Ordnung.
				In endlichen abelschen Gruppen ungerader Ordnung ist jedes Element ein Quadrat.
				Also ist $u \in U(\Z / p^{\alpha} \Z)$ Quadrat, wenn $\tilde \kappa(a)$ Quadrat ist.
			\item
				Sei $2^s$ $2$-Potenzteiler von $b$ (maximale 2er-Potenz, die $b$ teilt).
				Für $s = 1$ ist in $U(\Z / 2\Z)$ also ein Quadrat.
				Für $s = 2$ ist nur $1 \bmod 4$ ein Quadrat.
				Für $s = 3$ ist nur $1 \bmod 8$ ein Quadrat.
				Für $s > 2$ ist $U(\Z / 2^s \Z) \isomorphic C_2 \times C_{2^{s-1}}$ nach \ref{2.10}.
				Betrachte
				\[
					\tilde \kappa: U(\Z / 2^s \Z) \to U(\Z / 8\Z)
				\]
				Ist $x = y^2$ in $\Z / 2^s\Z$, dann ist $\tilde \kappa(x) = \tilde \kappa(y^2) = \tilde \kappa(y) \tilde \kappa(y)$, also ist $\tilde \kappa(x)$ ein Quadrat in $U(\Z / 8\Z)$ und somit $\tilde \kappa(x) \equiv 1 \bmod 8$, also $x \in \ker \tilde \kappa$.
				Ist $x \in \ker \tilde x$, dann ist $x = \_5^i$ mit $2$ teilt $i$ und somit $x$ ein Quadrat.
				Also bildet $\ker \tilde \kappa$ alle Quadrate, also alle Elemente von $U(\Z / 2^s \Z)$, die $\equiv 1 \bmod 8$ sind.
		\end{enumerate}
	\end{proof}
\end{st}







