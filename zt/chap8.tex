\chapter{Einführung in die algebraische Zahlentheorie}


\begin{df} \label{8.1}
	Sei $L / K$ eine endliche Körpererweiterung, $x \in L$.

	Wir bezeichnen mit $T_x: L \to L$ den $K$-linearen Endomorphismus $a \mapsto x a$, die Linksmultiplikation mit $x$.
	\begin{enumerate}[a)]
		\item
			Die Spur von $T_x$ nennt man die \emphdef{Spur} $\Tr_{L/K}(x)$.
		\item
			Die Determinante von $T_x$ nennt man die \emphdef{Norm} $N_{L/K}(x)$.
	\end{enumerate}
\end{df}

% Bsp + Bem
\begin{nt} \label{8.2}
	\begin{enumerate}[a)]
		\item
			Spur und Determinante von Vektorraumendomorphismen sind unabhängig von der Wahl der Basis.
		\item
			Ist
			\[
				\chi_{T_x}(t)
				= t^n - a_1 t^{n-1} + \dotsb + (-1)^n a_n
			\]
			mit $a_1 \in K$ das charakteristische Polynom von $T_x$, dann ist $\Tr_{L/K}(x) = a_1$ und $N_{L/K}(x) = a_n$.

			Ist $M_x = (m_{ij})$ die zu $T_x$ gehörige Matrix in einer Matrixdarstellung nach Wahl einer Basis, dann ist $\Tr_{L/K}(x) = \sum_{i=1}^n m_{ij}$, $n = \dim_K L$ und $N_{L/K}(x) = \det M_x$.
		\item
			Sei $L = \Q(\sqrt d)$ mit $d \in \Z$ quadratfrei.
			Wähle $\Set{1, \sqrt d}$ als $\Q$-Basis.
			Setze $x = a + b \sqrt d$ mit $a, b \in \Q$.
			Dann ist $M_x = \Matrix{a & bd \\ b & a}$ wegen $x \sqrt d = a \sqrt d + b d$.
			Also ist
			\begin{align*}
				\Tr_{L/\Q}(x) &= 2a, &
				N_{L/\Q}(x) &= a^2 - db^2.
			\end{align*}
	\end{enumerate}
\end{nt}

% Lem 8.3
\begin{lem} \label{8.3}
	\begin{enumerate}[a)]
		\item
			Die Abbildung $L \to K, x \mapsto \Tr_{L/K}(x)$ ist ein Gruppenhomomorphismus $(L, +) \to (K, +)$ und es gilt
			\[
				\Tr_{L/K}(kx) = k \Tr_{L/K}(x)
			\]
			für $k \in K$.
		\item
			Die Abbildung $L^* \to K^*, x \mapsto N_{L/K}(x)$ ist ein Gruppenhomomorphismus $(L^*, \cdot) \to (K^*, \cdot)$ zwischen den Einheitengruppen von $L$ und $K$.
	\end{enumerate}
	\begin{proof}
		Einfach nachzurechnen (Spur ist additiv, Determinante multiplikativ, \dots).
	\end{proof}
\end{lem}

% Wiederholung ... 8.4
\begin{nt}[Wiederholung von Begriffen und Sätzen aus der Algebra] \label{8.4}
	\begin{enumerate}[a)]
		\item
			Eine Körpererweiterung $L / K$ heißt \emphdef{separabel}, wenn jedes Element $x \in L$ ein Minimalpolynom $\mu_x \in K[x]$ besitzt, welches in einem algebraisch abgeschlossenen Körper $\_K$ keine mehrfachen Nullstellen hat.
		\item
			Körpererweiterungen über Körper der Charakteristik 0 sind separabel.
			Insbesondere ist $L / \Q$ mit algebraischem Zahlkörper $L$ stets separabel.
			Für algebraische Zahlkörper kann man $\_K = \C$ wählen.
		\item
			Sei $L / K$ separabel und $\dim_K L = n$.
			Dann gibt es genau $n$ verschiedene $K$-Homomorphismen $\sigma_i: L \to \_K$.
			Dabei ist ein $K$-Homomorphismus ein Körperhomomorphismus, der $K$ elementweise festlässt, d.h. $\sigma_i(k) = k$ für alle $k \in K$.
	\end{enumerate}
\end{nt}

% St 8.5
\begin{st} \label{8.5}
	Sei $L / K$ separabel, $n = \dim_K L$ und $\Hom_K(L, \_K) = \Set{\sigma_1, \dotsc, \sigma_n}$ die Menge der $K$-Homomorphismen nach $\_K$.
	Dann gilt für ein $x \in L$, dass
	\begin{enumerate}[(i)]
		\item
			$\chi_{T_x}(t) = \prod_{i=1}^n (t - \sigma_i(x))$,
		\item
			$\Tr_{L/K}(x) = \sum_{i=1}^n \sigma_i(x)$,
		\item
			$N_{L/K}(x) = \prod_{i=1}^n \sigma_i(x)$.
	\end{enumerate}
	\begin{proof}
		(ii) und (iii) folgen unmittelbar aus (i).
	\end{proof}
	\begin{note}
		Ist $L / K$ sogar galoissch, dann bilden $\Set{\sigma_1, \dotsc, \sigma_n}$ die Galoisgruppe und $\sigma_i$ sind insbesondere Körperautomorphismen von $L$.
	\end{note}
\end{st}

\coursetimestamp{10}{07}{2014}

% Folgerung 8.6
\begin{kor} \label{8.6}
	Sei $L / K$ eine Körpererweiterung, $A$ der Ring der ganzen Zahlen in $K$ und $B$ der ganzzahlige Abschluss von $A$ in $L$.
	In diesem Fall gilt
	\[
		\Tr_{L/K}(B) \subset A.
	\]
	Insbesondere gilt dies für Zahlkörper $K = \Q$, $A = \Z$.
	\begin{proof}
		Sei $b \in B$. Dann ist $b^n + k_1 b^{n-1} + \dotsb + k_n = 0$ mit $k_i \in A$.
		Sicherlich ist $\Tr_{L/K}(b) \in K$.
		$\sigma_j(b)$ ist auch ganz über $K$ für jeden Index $j$, denn weil $\sigma_j$ ein $K$-Homomorphismus ist, gilt
		\begin{align*}
			\sigma_j(0)
			= 0
			&= \sigma_j(b^n + k_1b^{n-1} + \dotsb + k_n) \\
			&= \sigma_j(b)^n + k_1 \sigma_j(b)^{n-1} + \dotsb + k_n.
		\end{align*}
		Nach \ref{8.5} gilt
		\[
			\Tr_{L/K}(b)
			= \underbrace{\sum_{i=1}^n \underbrace{\sigma_i(b)}_{\text{ganz}}}_{\text{ganz}}
			\in A.
		\]
	\end{proof}
\end{kor}

% Def 8.7
\begin{df} \label{8.7}
	Sei $L/K$ separabel, $S = \Set{\alpha_1, \dotsc, \alpha_n}$ eine $K$-Basis von $L$ und $\Hom_{K}(L, \_K) = \Set{ \sigma_1, \dotsc, \sigma_n}$.
	Dann heißt
	\[
		d(S) = \det((\sigma_i(\alpha_j))^2)
	\]
	\emphdef{Diskriminante} von $S$.
\end{df}

% Lem 8.8
\begin{lem} \label{8.8}
	Sei $L/K$ separabel und $S = \Set{\alpha_1, \dotsc, \alpha_n}$ eine $K$-Basis von $L$.
	\begin{enumerate}[a)]
		\item
			Dann gilt $d(S) = \det T$ mit $T = (t_{ij})$ und $t_{ij} = \Tr_{L/K}(\alpha_i\alpha_j)$.
		\item
			Ist $S = \Set{1, \theta, \dotsc, \theta^{n-1}}$, dann ist
			\[
				d(S) = \prod_{i<j} (\sigma_i(\theta) - \sigma_j(\theta))^2.
			\]
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Schreibe mit \ref{8.5} (ii)
				\begin{align*}
					\Tr_{L/K}(\alpha_i \alpha_j)
					= \sum_{k=1}^n \sigma_k (\alpha_i \alpha_j)
					= \sum_{k=1}^n \sigma_k(\alpha_i) \sigma_k(\alpha_j).
				\end{align*}
				Setze $B = (b_{ij})$ mit $b_{ij} = \sigma_i(\alpha_j)$.
				Dann ist $BB^t = T$ mit $T = (\Tr_{L/K}(\alpha_i \alpha_j))$.
				Es folgt
				\[
					d(S) = \det(B^2)
					= \det(B)\det(B^t)
					= \det T.
				\]
			\item
				Nach Definition und mit Multiplikativität ist
				\[
					d(S) = \det \Matrix{
						1 & \sigma_1(\theta) & \cdots & \sigma_1(\theta)^{n-1} \\
						\vdots & \vdots & \ddots & \vdots \\
						1 & \sigma_n(\theta) & \cdots & \sigma_n(\theta)^{n-1}
					}^2.
				\]
				Dies ist eine Vandermonde-Matrix, für die sich die Determinante genau wie in der Behauptung ergibt.
		\end{enumerate}
	\end{proof}
\end{lem}

% Lem 8.9
\begin{lem} \label{8.9}
	Sei $L / K$ eine Körpererweiterung, $\dim_K L = n$, $A$ ganz abgeschlossen in $K$ und $B$ der ganze Abschluss von $A$ in $L$.
	Sei $S = \Set{\beta_1, \dotsc, \beta_n}$ eine in $B$ gelegene $K$-Basis von $L$.
	Sei $d = d(S)$ die Diskriminante von $S$.
	Dann gilt
	\[
		d B \subset \< \beta_1, \dotsc, \beta_n\>_A.
	\]
	\begin{proof}
		Sei $\beta \in B$, dann ist $\beta = b_1 \beta_1 + \dotsb + b_n \beta_n$ mit $b_j \in K$.
		Es genügt zu zeigen, dass $db_j \in A$ für $1 \le j \le n$, d.h. $d \beta \in \< \beta_1, \dotsc, \beta_n\>_A$.
		Für $1 \le i \le n$ gilt
		\[
			\Tr_{L/K}(\beta_i\beta)
			\stack{\ref{8.3}a)}= \sum_{j} \Tr_{L/K} (\beta_i b_j \beta_j)
			= \sum_{j} b_j \Tr_{L/K}(\beta_i \beta_j).
		\]
		Betrachte das lineare Gleichungssystem der Form
		\[
			\Tr_{L/K}(\beta_i\beta) = \sum_{j=1}^n \Tr_{L/K}(\beta_i\beta_j) x_j
		\]
		für $1 \le j \le n$.
		Die $b_j$ sind nach vorigem Lösungen dieses Gleichungssystems.
		Nach der Cramerschen Regel sind die $b_j$ Quotienten eines in $A$ gelegenen Zählers, da die Koeffizienten $\Tr_{L/K}(\beta_i\beta_j) \in A$ nach \ref{8.6} und $\det(\Tr_{L/K}(\beta_i\beta_j)) = d$ nach \ref{8.8}a).
		Damit ist $d\beta \in \<\beta_1, \dotsc, \beta_n\>$, denn $d \beta_j \in A$.
	\end{proof}
\end{lem}

% St 8.10
\begin{st}[Existenz von Ganzheitsbasen] \label{8.10}
	Sei $L / K$ endlich und separabel, $A$ Hauptidealbereich und ganz abgeschlossen in $K$, $B$ der ganze Abschluss von $A$ in $L$.
	Dann ist jeder endlich erzeugte $B$-Teilmodul $M$ von $L$ ($L$ kann als Einschränkung als $B$-Modul betrachtet werden) ein freier $A$-Modul ($M$ wird durch weitere Einschränkung auch als $A$-Modul betrachtet) vom Rang $n = \dim_K L$.

	Insbesondere gilt dies für $M = B$, d.h. $B$ ist ein freier $A$-Modul vom Rang $n$ und besitzt somit eine Ganzheitsbasis (siehe \ref{5.12}, \ref{5.13}).
	\begin{proof}
		Sei $\Set{\alpha_1, \dotsc, \alpha_n}$ eine $K$-Basis von $L$.
		Dann ist wegen $\alpha_i = \f{x_i}{y_i}$, $x_i \in B, y_i \in A$ (nach \ref{5.9}) liefert Durchmultiplizieren mit $y := \prod_{i=1}^n y_i$, dass $S := \Set{y\alpha_1, \dotsc, y\alpha_n}$ eine $K$-Basis von $L$, welche in $B$ liegt.

		Mit \ref{8.9} ist $d(S)B \subset \<y\alpha_1, \dotsc, y\alpha_n\>_A$.
		Sei nun $M$ ein endlich erzeugter $B$-Teilmodul von $L$ und $M = \< \gamma_1, \dotsc, \gamma_r \>_B$.
		Analog wie vorher liefert Durchmultiplizieren mit $\prod_{i=1}^r w_i$, wenn $\gamma_i = \f {\delta_i}{w_i}$, $\delta_i \in B, w_i \in A$, dass $wM = \<w\gamma_1, \dotsc, w\gamma_r\> \subset B$.

		Es ist dann $d(S) w M \subset d(S) B \subset \<y \alpha_1, \dotsc, y \alpha_n\>_A$.
		$\<y\alpha_1, \dotsc, y \alpha_n\>_A$ ist offensichtlich ein freier $A$-Modul mit Basis $\Set{y\alpha_1, \dotsc, y\alpha_n}$.
		Da $A$ eine Hauptidealbereich nach Voraussetzung, sind Teilmoduln von freien $A$-Moduln vom Rang $m$ ebenfalls frei vom Rang $\le m$.
		Damit ist auch $d(S) w M$ ein freier $A$-Modul.
		Sicherlich ist $d(S) w M \isomorphic M$ als $A$-Modul und $\Rang M = \Rang d(S) w M \le \Rang \<y\alpha_1, \dotsc, y\alpha_n \> = n$.

		Für $m \in M$ ist $Bm \subset M$ und $Bm \isomorphic B$, also $\Rang B \le \Rang M$.
		Insegamt ist also
		\[
			\Rang M \le n \le \Rang B \le \Rang M,
		\]
		d.h. $n = \Rang M = \Rang B$.
	\end{proof}
\end{st}

% Bemerkungen 8.11
\begin{nt} \label{8.11}
	\begin{enumerate}[a)]
		\item
			\ref{8.10} kann man auf Zahlkörpersituationen anwenden $K = \Q, A = \Z$, denn $\Z$ ist eine Hauptidealbereich
			Die im Beweis von \ref{8.10} verwendete Eigenschaft von freien Moduln über Hauptidealbereichen überträgt sich im Fall $A = \Z$, dazu, dass Untergruppen freier abelscher Gruppen vom Range $n$ frei sind vom Rang $\le n$.
		\item
			Die Diskriminante einer Ganzheitsbasis $B$ eines Zahlkörpers $L$ nennt man auch \emphdef{Diskriminante} von $L$.
			Diese ist unabhängig von der Wahl der Ganzheitsbasis, denn seien $\Set{\alpha_1, \dotsc, \alpha_n}$ und $\Set{\alpha_1', \dotsc, \alpha_1'}$ Ganzheitsbasen von $B$, dann ist die Transformationsmatrix $T = (t_{ij})$ mit $\alpha_i' = \sum_{j=1}^n t_{ij} \alpha_j$ und ihre Inverse ganzzahlig, d.h. $\det T = \pm 1$.
			Damit ist
			\[
				d(\Set{\alpha_1', \dotsc \alpha_n'})
				= \det((\sigma_i(\alpha_j'))^2)
				= (\det T)^2 \det(\sigma_i(\alpha_i))^2
				= d(\Set{\alpha_1, \dotsc, \alpha_n}).
			\]
		\item
			Im Allgemeinen ist es nicht leicht, Ganzheitsbasen zu bestimmen.
			Im Fall von Kreisteilungskörpern $\Q(\zeta)$, mit einer primitiven $n$-ten Einheitswurzel $\zeta$, kann man zeigen, dass $\Set{1, \zeta, \dotsc, \zeta^{\phi(n) - 1}}$ eine Ganzheitsbasis ist, d.h.
			$\Z[\zeta]$ sind die ganzen Zahlen von $\Q(\zeta)$.
	\end{enumerate}
\end{nt}

% Bemerkungen 8.12
\begin{nt} \label{8.12}
	Wir haben gesehen, dass in den ganzen Zahlen quadratischer Zahlkörper die Eindeutigkeit der Zerlegung in Primelemente in der Regel nicht gegeben ist.

	E. Kummer hat postuliert:
	Sei $L$ ein algebraischer Zahlkörper, $B$ die ganzen Zahlen von $L$, dann sollte es einen Bereich $\hat B$ geben, so dass in $\hat B$ eine eindeutige Primfaktorzerlegung via „idealer Primzahlen“ möglich ist.

	Präziser sollte folgendes gelten:
	Sei $\mathfrak a$ eine ideale Zahl, dann soll sie mit $a, b, \lambda \in B$ folgende Teilbarkeitsregeln erfüllen
	\begin{enumerate}[{Postulat P}1,leftmargin=6em]
		\item
			\begin{enumerate}[(i)]
				\item
					$\mathfrak a$ „teile“ $a$ und $\mathfrak a$ „teile“ $b$, dann auch $\mathfrak a$ teile $a \pm b$,
				\item
					$\mathfrak a$ „teile“ $a$, dann auch $\mathfrak a$ „teile“ $\lambda a$.
			\end{enumerate}
		\item
			$\Set{\mathfrak a} = \Set{ a \in B & a \text{ „teile“ } \mathfrak a}$.
	\end{enumerate}
	R. Dedekind hat „ideale Zahlen“ eingeführt als Ideale mit „teile“ als Inklusion und idealen Primzahlen als Primidealen.
\end{nt}

% Wiederholung
\begin{df*}
	Sei $R$ ein kommutativer Ring.
	Ein Ideal $I \IdealOf R$ heißt \emphdef{Primideal}, wenn für Ideale $A$ und $B$ gilt
	\[
		I \supset A B \implies I \supset A \lor I \supset B
	\]
	(analog zu $p \divs ab \implies p\divs a \lor p \divs b$).
\end{df*}

% Lemma 8.13
\begin{lem} \label{8.13}
	Sei $R$ ein kommutativer Ring, $I \IdealOf R$ ein Ideal.
	\begin{enumerate}[a)]
		\item
			$I$ ist Primideal genau dann, wenn $R / I$ Integritätsbereich ist,
		\item
			$I$ ist maximales Ideal genau dann, wenn $R / I$ ein Körper ist.
	\end{enumerate}
	Insbesondere ist jedes maximale Ideal ein Primideal.
\end{lem}

\begin{nt} \label{8.14}
	\begin{itemize}
		\item
			In $\Z$ sind die Primideale von der Form $p\Z$ für eine Primzahl $p \in Z$, oder das Nullideal.
% fixme:
%		\item
%			In $\R$ nicht-triviale Primideale sind maximal, es existiert ein Primideal, welches nicht maximal ist, in jedem Integritätsbereich ist das Nullideal ein Primideal.
	\end{itemize}
\end{nt}

\coursetimestamp{14}{07}{2014}

% St 8.15
\begin{st} \label{8.15}
	Der Ring $B$ der ganzen Zahlen eines algebraischen Zahlkörpers $L$ ist
	\begin{enumerate}[a)]
		\item
			noethersch,
		\item
			ganz abgeschlossen in $L$,
		\item
			nicht-triviale Primideale sind maximal.
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Nach \ref{8.10} ist $B$ ein freier $\Z$-Modul vom Rang $n = \dim_\Q L$.
				Jedes Ideal von $B$ ist ein freier $\Z$-Modul endlichen Ranges, insbesondere als $\Z$-Modul endlich erzeugt.
				$B \supset \Z$, also sind alle Ideale von $B$ endlich erzeugt als $B$-Moduln und $B$ ist noethersch.
			\item
				folgt aus \ref{5.9}, $B$ ist der ganze Abschluss von $\Z$ in $L$.
			\item
				Sei $P$ ein Primideal von $B$.
				\begin{seg}{$P \cap \Z$ ist ein Primideal von $Z$}
					Zeige $P \cap \Z = p\Z$ oder $P = 0 = P \cap \Z$.

					Seien dazu $b,c \in \Z$ mit $(b + P \cap \Z)(c + P \cap \Z) = 0$, dann ist $bc \in P \cap \Z$.
					Es folgt $(b + P)(c + P) = 0$ in $B / P$.
					Da $P$ Primideal, ist $B / P$ Integritätsbereich nach \ref{8.13} a), also $b + P = 0$ oder $c + P = 0$, d.h. $b \in \P \lor c \in P$.
					Wegen $b,c \in \Z$ also $b \in P \cap \Z \lor c \in Z \cap \Z$, d.h. $b + P\cap\Z = 0$ oder $c + P\cap \Z = 0$.
					Somit ist $\Z / P \cap \Z$ ein Integritäsbereich und nach \ref{8.13} ein Primideal.
					Beachte $P \neq 0 \implies P \cap \Z \neq 0$ (betrachte einen Koeffizient des Minimalpolynoms von $b \in P$).
					Für $P = 0$ ist die Behauptung klar.
				\end{seg}
				$K = \Set{z + P & z \in \Z} \subset B / P$ ist ein zu $\Z / p \Z$ isomorpher Teilring, d.h. $B / P \supset K \isomorphic \Z / p \Z$ für $P \neq 0$.
				$B$ entsteht aus $\Z$ durch Adjungieren endlich vieler Elemente $y_i$, die jeweils eine normierte Gleichung der Form
				\[
					y_i^m + a_i y_i^{m-1} + \dotsb + a_m = 0
				\]
				mit $a_i \in \Z$ erfüllen.
				Modulo $P$ ist dies eine Gleichung mit $a_i + P \in K$, $y_i + P$ ist daher algebraisch über $K$ und $B / P$ entsteht aus $K$ durch Adjunktion endlich vieler algebraischer Elemente.
				\[
					\_{y_i}^m + \_{a_1}\_{y_i}^{m-1} + \dotsb + \_{a_m} = 0,
				\]
				also
				\[
					1 = - \f 1{\_{a_m}}(\underbrace{\_{y_i}^m + \_{a_1}\_{y_i}^{m-1} + \dotsb + \_{a_{m-1}}\_{y_i}}_{\_{y_i} x}),
				\]
				d.h. $\_{y_i}$ ist invertierbar in $B / P$, d.h. $B/P$ ein Körper und nach \ref{8.13} ein maximales Ideal.
		\end{enumerate}
	\end{proof}
\end{st}

\begin{nt*}
	Es gilt, dass endliche Integritätsbereiche Körper sind.
	Der Satz geht auf Wedderburn zurück. % fixme: ref
\end{nt*}

% Def 8.16
\begin{df} \label{8.16}
	Ein Integritätsbereich $R$ heißt \emphdef{Dedekindring}, wenn $R$ noethersch und ganz abgeschlossen in $\Quot(R)$ ist und jedes nicht-triviale Primideal maximal ist.
\end{df}

% Hauptsatz 8.17
\begin{st}[Hauptsatz, Eindeutigkeit der Primidealzerlegung] \label{8.17}
	Sei $R$ ein Dedekindring.
	Dann lässt sich jedes von $0$ und $R$ verschiedene Ideal $I$ bis auf die Reihenfolge eindeutig als Produkt von Primidealen schreiben, d.h.
	\[
		I = P_1^{\nu_1} \dotsb P_r^{\nu_r}
	\]
	(gleiche Primideale in Potenzen zusammengefasst).
	\begin{note}
		Dieser Satz ist das Gegenstück zum Hauptsatz der elementaren Zahlentheorie.
	\end{note}
	\begin{proof}
		\begin{seg}{Existenz der Zerlegung in Primideale}
			Da $R$ noethersch ist, gibt es Ideale, die maximal sind mit der Eigenschaft, keine Primidealzerlegung zu besitzen (und $\neq 0, R$ zu sein), falls es überhaupt solche gibt.

			Sei $M$ ein solches maximales Ideal und $\hat M$ sei ein maximales Ideal von $R$, welches $M$ enthält (gibt es, da $R$ noethersch ist)
			Beachte $\hat M$ ist ein Primideal, also $M \neq \hat M$.
			Es ist $R \subset \hat M^{-1} = \Set{ k \in  & k \hat M \subset R }$ und daher
			\[
				M \subset M M^{-1} \subset \hat M \hat M^{-1} \subset R.
			\]
			Nach \ref{8.19} gilt $M \subsetneq M \hat M^{-1}$ und $\hat M \subsetneq \hat M \hat M^{-1}$.
			Es folgt $\hat M \hat M^{-1} = R$, da $\hat M$ maximales Ideal ist (siehe auch \ref{8.20}).

			Wir behaupten $M \hat M^{-1} \neq \hat M \hat M^{-1} = R$, denn
			$(M \hat M^{-1}) \hat M$ besteht aus endlichen Summen der Form $\sum m_1 m_2 m_3$ mit $m_1 \in M, m_2 \in \hat M^{-1}, m_3 \in \hat M$.
			Da in diesen Ausdrücken die Klammerung irrelevant ist, folgt $(M \hat M^{-1}) \hat M = M (\hat M^{-1} \hat M)$.
			Angenommen $M \hat M^{-1} = \hat M \hat M^{-1}$, dann ist mit $\hat M \hat M^{-1} = R$
			\[
				(M \hat M^{-1}) \hat M
				= (\hat M \hat M^{-1}) \hat M
				= M (\hat M^{-1} \hat M)
				= M R
				= M
				= R \hat M
				= \hat M
			\]
			Es folgt $M = \hat M$, ein Widerspruch.

			$M \hat M^{-1}$ ist Ideal nach \ref{8.20} und nach der Behauptung $\neq R$ und $M \subsetneq M \hat M^{-1}$ nach \ref{8.19}.
			$M$ ist maximal ohne Primidealzerlegung, d.h. $M \hat M^{-1} = P_1 \dotsb P_r$ mit $P_i$ Primideal.
			Multiplikation von rechts mit $\hat M$ ergibt $M = P_1 \dotsb P_r \hat M$.
			$\hat M$ ist prim, da maximales Ideal, also hat $M$ doch eine Primidealzerlegung und existiert daher nicht.
		\end{seg}
	\end{proof}
\end{st}

% Lem 8.18
\begin{lem} \label{8.18}
	Sei $R$ ein Dedekindring, $I \neq 0$ ein Ideal von $R$.
	Dann existieren Primideale $P_i \neq 0$ mit
	\[
		I \supset P_1 P_2 \dotsb P_r.
	\]
	\begin{proof}
		Sei $\scr M$ die Menge der Ideale ungleich 0, die nicht diese Eigenschaft besitzen.
		Angenommen $\scr M \neq 0$.
		Ordne $\scr M$ durch Inklusion.
		Da $R$ noethersch ist, brechen aufsteigende Ketten von Idealen ab, bzw. $\scr M$ besitzt ein maximales Element (siehe \ref{4.6}).
		Sei $M$ ein maximales Element, welche kein Primideal ist (sonst sind wir fertig).
		Da $R/M$ kein Integritätsbereich nach \ref{8.13}, existieren $r_1, r_2 \in R$ mit $r_1, r_2 \in I$, aber $r_1, r_2 \not\in I$.
		Setze $M_1 := M + Rr_1, M_2 := M + Rr_2$, dann ist $M \subsetneq M_1, M_2$, aber $M_1 M_2 \subset M$.
		Da $M$ maximal ist, gilt $M_1 \subset P_1 \dotsb P_r$, $M_2 \supset Q_1 \dotsb Q_s$ mit $P_i, Q_j$ Primidealen.
		Es folgt
		\[
			M \supset M_1 M_2 \supset P_1 \dotsb P_r Q_1 \dotsb Q_s.
		\]
	\end{proof}
\end{lem}

% Lem 8.19
\begin{lem} \label{8.19}
	Sei $R$ ein Dedekindring, $P$ ein Primideal von $R$ und $K = \Quot(R)$.
	Setze $P^{-1} = \Set{k \in K & k P \subset R}$, dann ist für jedes Ideal $I \neq 0$
	\[
		I P^{-1} =
		\Set{ \sum_{i=1}^n a_i x_i & n \in \N, a_i \in I, x_i \in P^{-1} }
		\neq I.
	\]
	\begin{proof}
		Sei \oBdA $P \neq 0$, $a \in P, a \neq 0$.
		Nach \ref{8.18} gibt es Primideale $P_1, \dotsc, P_r$ mit
		\[
			P_1 \dotsb P_r \subset R_a \subset P
		\]
		und alle $P_i \neq 0$.
		Wähle $r$ minimal.
		Da $P$ Primideal, existiert $P_i$ mit $P_i \subset P$.
		Sei \oBdA $i = 1$, also $P_1 \subset P$.
		Da $R$ Dedekindring ist und $P_1 \neq 0$, ist $P_1$ maximal und somit $P_1 = P$.

		Wegen $P_2 \dotsb P_r \not\subset Ra$ (wegen Minimalität von $r$) folgt, dass es $b \in P_2 \dotsb P_r$ mit $b \in Ra$, also $a^{-1}b \not\in R$.
		$P_1 = P$, also $b P \subset Ra$, also ist $a^{-1}b P \subset R$ und daher $a^{-1} b \in P^{-1}$.
		Es folgt $P^{-1} \neq R$.

		Angenommen $r = 1$, adnn ist $P_1 \subset P_a \subset P$ und $P_1 = P$, also $Ra = P$ und $PP^{-1} = R$, also $P^{-1} \neq R$.

		Angenommen es existiert ein Ideal $I \neq 0$ mit $I P^{-1} = I$.
		$I$ ist endlich erzeugter $R$-Modul, da $R$ noethersch.
		Sei also $I = \<\alpha_1, \dotsc, \alpha_n\>$.
		Dann gilt für jedes $x \in P^{-1}$, dass
		\[
			x \alpha_i = \sum_{j} a_{ij} \alpha_j
		\]
		mit $a_{ij} \in R$.
		Definiere die Matrix $B = (b_{ij})$ mit $b_{ij} := x \delta_{ij} - a_{ij}$.
		Es errechnet sich
		\[
			B \Vector{\alpha_1 & \alpha_2 & \dots & \alpha_n} = 0,
		\]
		aber $\Vector{\alpha_1 & \dots & \alpha_n} \neq 0$, d.h. $\det B = 0$.
		Setze $\tilde b_{ij} = t \delta_{ij} - a_{ij} \in R[t]$ und betrachte $\det \tilde B_{ij}$ für $\tilde B = (\tilde b_{ij})$.
		$x$ ist eine Nullstelle von $\det \tilde B$ und daher ganz über $R$.
		Da $R$ ganz abgeschlossen in $K$, ist $x \in R$.
		Es folgt $P^{-1} \subset R$, ein Widerspruch zu oben.
	\end{proof}
\end{lem}

\begin{lem} \label{8.20}
	Voraussetzungen wie im Beweis von \ref{8.17}.
	Sei $I$ ein Ideal, dann ist $I \hat M^{-1}$ ebenfalls ein Ideal für $I \subset \hat M$.
	\begin{proof}
		Übung.
	\end{proof}
\end{lem}
