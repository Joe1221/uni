\label{chap:6}
\chapter{Kettenbrüche}

\coursetimestamp{23}{06}{2014}

% 6.1 (Endliche Kettenbrüche)
\begin{ex}[Endliche Kettenbrüche]
	Für $a, b \in \Z$ ergibt sich der Euklidische Algorithmus durch
	\begin{align*}
		a &= v_0 b + r_1 \\
		b &= v_1 r_1 + r_2 \\
		r_1 &= v_2 r_2 + r_3 \\
		\vdots \; &= \quad \vdots \\
		r_{n-2} &= r_{n-1} v_{n-1} + r_n \\
		r_{n-1} &= v_n r_n
	\end{align*}
	Umschreiben und ineinander Einsetzen ergibt
	\begin{align*}
		\begin{aligned}
			\f ab &= v_0 + \f {r_1}b \\
			\f b{r_1} &= v_1 + \f {r_2}{r_1} \\
			\f {r_1}{r_2} &= v_2 + \f{r_3}{r_2} \\
			\vdots &\;= \quad \vdots \\
			\f {r_{n-2}}{r_{n-1}} &= v_{n-1} + \f{r_n}{r_{n-1}} \\
			\f {r_{n-1}}{r_n} &= v_n
		\end{aligned}
		\quad\leadsto\quad
		\begin{aligned}
			\f ab
			&= v_0 + \dfrac 1{v_1 + \f{r_2}{r_1}} \\
			&= v_0 + \dfrac 1{v_1 + \f 1{v_2 + \f {r_3}{r_2}}} \\
			&= \dotso
		\end{aligned}
	\end{align*}
	Schließlich erhält man
	\[
		\dfrac ab
		= v_0 + \dfrac 1{v_1 + \dfrac 1{v_2 + \dfrac 1{\ddots + \dfrac 1{v_{n-2} + \dfrac 1{v_{n-1} + \dfrac 1{v_n}}}}} }.
	\]
	Diesen Kettenbruch nennt man die \emphdef{Kettenbruchentwicklung} von $\f ab \in \Q$.
	Wir nutzen die Schreibweise
	\[
		\f ab = [v_0, v_1, v_2, \dotsc, v_n]
	\]

	Allgemeiner bezeichnet man mit
	\[
		[x_0, x_1, \dotsc, x_n],
	\]
	wobei $x_i \in \R$, $x_0 \ge 0$ und $x_i > 0$ für $i \ge 1$, einen Bruch der Form
	\[
		x_0 + \dfrac 1{x_1 + \dfrac 1{x_2 + \dfrac 1{\ddots + \dfrac 1{x_{n-1} + \dfrac 1{x_n}}}}}
	\]
	als \emphdef{endlicher Kettenbruch}.
\end{ex}

% Ex 6.2
\begin{ex} \label{6.2}
	\begin{enumerate}[a)]
		\item
			Betrachte den euklidischen Algorithmus zu $a = 15, b = 4$:
			\begin{align*}
				15 &= 3 \cdot 4 + 3 \\
				4 &= 1 \cdot 3 + 1 \\
				3 &= 3 \cdot 1,
			\end{align*}
			also
			\[
				\f {15}{4} = [3, 1, 3] = 3 + \f {1}{1 + \f{1}{3}}.
			\]
		\item
			Ähnlich wie oben ergibt sich
			\[
				\f {64}9 = [2, 4, 1, 5].
			\]
	\end{enumerate}
\end{ex}

% 6.3 (Unendliche Kettenbrüche)
\begin{nt}[Unendliche Kettenbrüche] \label{6.3}
	Man kann analog für irrationale Zahlen Kettenbruchentwicklungen folgender Art definieren.
	Wir schreiben $\ceil{a}$ für die größte ganze Zahl, die $\le \alpha \in \R$ ist, z.B. $\ceil{\sqrt 2} = 1$.

	Sei $\alpha \in \R^+ \setminus \Q$.
	Dann schreibe
	\[
		\alpha = a_0 + \f 1{\f 1{\alpha - a_0}}
	\]
	mit $a_0 = \ceil{\alpha}$.
	Aus $\alpha - a_0 < 1$ folgt $\alpha_1 = \f 1{\alpha - a_0} > 1$, setze $a_1 := \ceil{\alpha_1}$.
	Dann ist
	\[
		\alpha = a_0 + \dfrac 1{a_1 + \frac 1{\frac 1{\alpha_1 - a_1}}}.
	\]
	Iteriert man diesen Prozess, entsteht ein unendlicher Kettenbruch, dessen Einträge $a_i \in \N$ für $i \ge 1$ und $a_0 \in \N_0$.
	Würde diese Iteration abbrechen, dann wäre $\alpha \in \Q$.
	Wir schreiben
	\[
		[a_0, a_1, a_2, \dotsc].
	\]
	Allgemein kann man
	\[
		[x_0, x_1, x_2, \dotsc]
	\]
	mit $x_i \in \R^+$ für $i \ge 1$ und $x_0 \in \R_0^+$ definieren.
\end{nt}

% Bsp 6.4
\begin{ex} \label{6.4}
	\begin{enumerate}[a)]
		\item
			Sei $\alpha := \pi$, dann ergibt sich
			\[
				\pi = [3, 7, 15, 1, \dotsc].
			\]
			Man erhält als Näherungsbrüche
			\[
				[3] = 3, [3, 7] = \f {22}7, [3, 7, 15] = \f {333}{106}, [3, 7, 15, 1] = \f {355}{113},
			\]
			mit
			\[
				3 < \f {333}{106} < \pi  < \f {355}{113} < \f {22}{7}.
			\]
		\item
			Sei $\alpha := \sqrt 2$, dann ergibt sich
			\begin{align*}
				\sqrt 2
				&= 1 + (\sqrt 2 - 1)
				= 1 + \f 1{\f 1{\sqrt 2 - 1}}
				= 1 + \f 1{\sqrt 2 + 1} \\
				&= 1 + \f 1{2 + \sqrt 2 - 1}
				= 1 + \f 1{2 + \f 1{\f 1{\sqrt 2 - 1}}}
				= 1 + \f 1{2 + \f 1{2 + \f 1{2 + \sqrt 2 - 1}}} \\
				&= \dotsc
				= [1, 2, 2, 2, \dotsc]
			\end{align*}
			Wir schreiben auch
			\[
				\sqrt 2 = [1, \_2],
			\]
			$\sqrt 2$ besitzt also eine periodische Kettenbruchentwicklung.
		\item
			$\alpha := \f 12 (\sqrt 5 - 1)$ hat die periodische Kettenbruchentwicklung $[0, \_1]$.
			$\beta := \f 12 (\sqrt 5 + 1)$ hat die periodische Kettenbruchentwicklung $[1, \_1]$.

			Dies sind die Nullstellen von $x^2 - x - 1 = 0$.
			Die Kettenbruchentwicklung erkennt man leicht an $\beta = 1 + \f 1{\beta}$.
	\end{enumerate}
\end{ex}

% Lem 6.5
\begin{lem} \label{6.5}
	Für Kettenbrüche gilt
	\begin{enumerate}[a)]
		\item
			Es gilt
			\[
				[x_0, \dotsc, x_{n-1}, x_n + \f 1{x_{n+1}}]
				= [x_0, \dotsc, x_n, x_{n+1}].
			\]
		\item
			Zu einem gegebenen Kettenbruch $[x_0, \dotsc, x_n]$ setze
			\begin{align*}
				P_0 &:= x_0, & P_1 &:= x_1 x_0 + 1, & &\dotsc& P_k &:= x_k P_{k-1} + P_{k-2} \\
				Q_0 &:= 1, & Q_1 &:= x_1, & &\dotsc& Q_k &:= x_k Q_{k-1} + Q_{k-2}
			\end{align*}
			für $2 \le k \le n$.
			Dann gilt
			\[
				[x_0, \dotsc, x_k] = \f {P_k}{Q_k}
			\]
			für $0 \le k \le n$.
		\item
			Es gilt
			\[
				\f {P_k}{Q_k} - \f {P_{k-1}}{Q_{k-1}}
				= \f {(-1)^{k+1}}{Q_k Q_{k+1}}
			\]
			und
			\[
				\f {P_k}{Q_k} - \f {P_{k-2}}{Q_{k-2}}
				= \f {(-1)^{k+1}x_k}{Q_{k-2} Q_k}
			\]
			für $2 \le k \le n$.
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Folgt aus der Definition.
			\item
				Zeigt man per Induktion mittels a).
			\item
				In Matrixschreibweise schreibt sich b) folgendermaßen
				\[
					\Vector{P_k & Q_k} = \Matrix{P_{k-1} & P_{k-2} \\ Q_{k-1} & Q_{k-2}} \Vector{x_k & 1},
				\]
				bzw.
				\begin{align*}
					\Matrix{P_k & P_{k-1} \\ Q_k & Q_{k-1}}
					&= \Matrix{P_{k-1} & P_{k-2} \\ Q_{k-1} & Q_{k-2}} \Matrix{x_k & 1 \\ 1 & 0} \\
					&= \Matrix{P_{k-2} & P_{k-3} \\ Q_{k-2} & Q_{k-3}} \Matrix{x_{k-1} & 1 \\ 1 & 0} \Matrix{x_k & 1 \\ 1 & 0} \\
					&= \prod_{i=0}^k \Matrix{x_i & 1 \\ 1 & 0}.
				\end{align*}
				In der Determinante also
				\[
					\Matrix|{P_k & P_{k-1} \\ Q_k & Q_{k-1}} = (-1)^{k+1}.
				\]
				Für $k \ge 2$ ist
				\[
					\Matrix{P_k & P_{k-2} \\ Q_k & Q_{k-2}}
					= \Matrix{P_{k-1} & P_{k-2} \\ Q_{k-1} & Q_{k-2}} \Matrix{x_k & 0 \\ 1 & 1}
				\]
				und die Behauptung folgt ähnlich wie oben.
		\end{enumerate}
	\end{proof}
\end{lem}

% Folg 6.6
\begin{kor} \label{6.6}
	Für $0 \le k \le n$ sei $\beta_k = \f {P_k}{Q_k}$ (man nennt dies den $k$-ten Näherungsbruch des Kettenbruchs $\alpha = [a_0, a_1, \dotsc, a_n]$).
	Setze voraus, dass $a_0 \in \N_0$ und $a_i \in \N$ für $i \ge 1$.
	Dann gilt für $n$ gerade
	\begin{align*}
		\beta_0 < \beta_2 < \dotsb < \beta_n = \alpha < \beta_{n-1} < \dotsb < \beta_3 < \beta_1
	\end{align*}
	und für $n$ ungerade
	\begin{align*}
		\beta_0 < \beta_2 < \dotsb < \beta_{n-1} = \alpha < \beta_n < \dotsb < \beta_3 < \beta_1.
	\end{align*}
	\begin{proof}
		Aus den Voraussetzungen an die $a_i$ folgt, dass alle $P_k$ für $k \ge 1$ und alle $Q_k$ für $k \ge 0$ positive ganze Zahlen sind, $P_0 = a_0 \in \N_0$.
		Aus \ref{6.5} c) folgt, dass
		\[
			\beta_k - \beta_{k-2}
			= \f {(-1)^k a_k}{Q_{k-2}Q_k}
		\]
		kleiner $0$ für $k$ ungerade und größer $0$ für $k$ gerade.
		Analog $\beta_k - \beta_{k-1}$ ist kleiner $0$ für $k$ gerade und größer $0$ für $k$ ungerade.

		Für $n$ gerade gilt mit der ersten Aussage $\beta_0 < \beta_2 < \dotsb  < \beta_n = \alpha$ und $\beta_{n-1} < \beta_{n-3} < \dotsb < \beta_1$.
		Mit der zweiten AUssage schließlich $\alpha = \beta_n < \beta_{n-1}$.
		Analog umgekehrt für $n$ ungerade.
	\end{proof}
\end{kor}

% St 6.7
\begin{st} \label{6.7}
	Sei $\alpha = [a_0, a_1, \dotsc, a_n]$ ein endlicher Kettenbruch mit $a_0 \in \N_0, a_i \in \N$ für $i \ge 1$.
	Ferner sei $\beta_k = \f {P_k}{Q_k}$ der $k$-te Näherungsbruch.
	Dann gilt für $0 \le k \le n-1$, dass
	\[
		| \alpha - \beta_k | \le \f 1{Q_k Q_{k+1}} < \f 1{Q_k^2} \le \f 1{k^2},
	\]
	wobei für die mittlere Ungleichung $k \ge 1$ vorausgesetzt wird.

	Ferner gilt
	\begin{enumerate}[a)]
		\item
			$Q_k > Q_{k-1}$ für $2 \le k \le n$.
		\item
			$Q_1 \ge 1, Q_2 \ge 2, Q_3 \ge 3$ und $Q_k > k$ für $4 \le k \le n$.
	\end{enumerate}
	\begin{proof}
		Aus \ref{6.6} folgt, dass $|\alpha - \beta_k| \le |\beta_{k+1} - \beta_k|$.
		Nach \ref{6.5} b) gilt $|\beta_{k+1} - \beta_k| = \f 1{Q_k Q_{k+1}} < \f 1{Q_k^2} \le \f 1{k^2}$ mit a) und b).

		Es verbleibt, a) und b) zu zeigen.
		\begin{enumerate}[a)]
			\item
				Für $2 \le k \le n$ gilt nach Definition von $Q_k$, dass
				\[
					Q_k = a_k Q_{k-1} + Q_{k-2}
					\ge Q_{k-1} + 1.
				\]
			\item
				$Q_1 = a_1 \in \N$, also $Q_1 \ge 1$ und direkt mit a) auch $Q_2 \ge 2, Q_3 \ge 3$.
				Für $k \ge 4$ ist
				\[
					Q_k = a_k Q_{k-1} + Q_{k-2}
					\ge Q_{k-1} + 2
					\ge k - 1 + 2
					> 2.
				\]
		\end{enumerate}
	\end{proof}
\end{st}

Betrachte eine Folge $(a_i)_{i \in \N}$, mit $a_0 \in \N_0$.
$(\beta_k)_{k\in\N} = [a_0, a_1, \dotsc, a_n]$ ist eine Folge mit rationalen Koeffizienten.
Die Folge $(\beta_k)_{k \in \N}$ ist dann wegen \ref{6.7} eine Cauchyfolge, konvergiert also gegen $a \in \R$ und es gilt für $n - k$ ungerade
\begin{equation}
	\label{eq:6.8}
	|\alpha - \beta_k| \le | \beta_n - \beta_k| < \f 1{Q_k^2} \le \f 1{k^2}
	\tag{6.8}
\end{equation}
\eqref{eq:6.8} wird zum Beweis von \ref{4.20} benötigt.

\coursetimestamp{26}{06}{2014}

\begin{proof}[von \ref{4.20}]
	Betrachte die Kettenbruchentwicklung von $\sqrt d$, gemäß \ref{6.3}.
	Ist $\f {P_k}{Q_k} = \beta_k$ der $k$-te Näherungsbruch, dann gilt nach \eqref{eq:6.8}
	\[
		\l| \sqrt d - \f{P_k}{Q_k}\r| < \f 1{Q_k^2}
		\quad\iff\quad
		\l| P_k - Q_k \sqrt d\r| < \f 1{Q_k^2},
	\]
	also
	\[
		\f 1{Q_k}
		> | P_k - Q_k \sqrt d|
		> \f 1{Q_{\tilde k}}
		> | P_{\tilde k} - Q_{\tilde k} \sqrt d|
		> \dotso
	\]
	Also gibt es Folgen natürlicher Zahluen $(k_i)_{i\in\N}, (x_i)_{i\in\N}, (y_i)_{i\in\N}$ mit
	\[
		\f 1{k_1}
		> |x_1 - y_1 \sqrt d|
		> \f 1{k_2}
		> |x_2 - y_2 \sqrt d|
		> \f 1{k_3}
		> \dotso
	\]
	mit $y_n \le k_n$.
	Also ist
	\begin{align*}
		|x_n^2 - dy_n^2|
		&= |x_n - y_n \sqrt d| |x_n + y_n \sqrt d|  \\
		&< \f 1{k_n} (\f 1{k_n} + 2 y_n \sqrt d)  \\
		&\le \f 1{k_n} (\f 1{k_n} + 2k_n \sqrt d)  \\
		&< 1 + 2 \sqrt d
	\end{align*}
	Also ist $(x_n^2 - dy_n^2)_{n\in \N}$ eine Folge ganzer Zahlen, die betragsmäßig beschränkt ist.
	Es existiert $r \in \N$ mit $r = |x^2 - dy^2|$ für unendlich viele $(x,y)  \in \N \times \N$.

	Definiere $x_1^2 - dy_1^2 \sim x_2^2 - dy_2^2$, wenn $x_1^2 - dy_1^2 = x_2^2 - dy_2^2 = r$ oder $x_1^2 - dy_1^2 = x_2^2 - dy_2^2 = -r$ und $x_1 \equiv x_2 \bmod r, y_1 \equiv y_2 \bmod r$.
	$\sim$ ist eine Äquivalenzrelation mit endlich vielen Äquivalenzklassen.
	Es existiert also eine Äquivalenzklasse mit unendlich vielen Termen.
	Es existieren zwei Terme der Form $x_1^2 - dy_1^2 = x_2^2 - dy_2^2 = r$ (oder $= -r$) und $r \divs x_1 - x_2, r\divs y_1 - y_2$, \oBdA $0 < x_1 < x_2$, also auch $0 < y_1 < y_2$, da $x_1^2 - dy_1^2 = x_2^2 - dy_2^2 < x_2^2 - dy_1^2$ und somit $y_2 > y_1$.

	Betrachte nun $(x_1 + y_1 \sqrt d)(x_2 - y_2 \sqrt d) = x_1x_2 - x_1y_2 \sqrt d + y_1 x_2 \sqrt - y_1 y_2 d$.
	Es gilt $x_1 x_2 - y_1 y_2 d \equiv 0 \bmod r$, da $x_1 x_2 \equiv x^2 \bmod r$ und $y_1 y_2 \equiv y_1^2 \bmod r$, also $x_1 x_2 - y_1 y_2 d \equiv x_1^2 - dy_1^2 = \pm r \equiv 0 \bmod r$.
	Es gilt außerdem $x_1 y_2 \equiv x_2 y_1 \bmod r$, da $x_1 \equiv x_2 \bmod r$ und $y_2 \equiv y_1 \bmod r$.

	Somit sind
	\begin{align*}
		u &= \f {x_1 x_2 - y_1 y_2 d}r, &
		v &= \f {x_1 y_2 - x_2 y_1}r
	\end{align*}
	aus $\Z$.
	Wir behaupten, $(u, v)$ ist eine Lösung der Pell'schen Gleichung, d.h. es gilt $u^2 - dv^2 = 1$.
	Wegen $(x_1 + y_1 \sqrt d)(x_2 - y_2 \sqrt d) = r(u - v \sqrt d)$ und $(x_1 - y_1 \sqrt d)(x_2 + y_2 \sqrt d) = r(u + v \sqrt d)$.
	\begin{align*}
		u^2 - dv^2
		&= (u + v \sqrt d)(u - v \sqrt d) \\
		&= \f 1r (x_1 + y_2 \sqrt d)(x_2 - y_2 \sqrt d) \\
			\f 1r (x_1 - y_1 \sqrt d)(x_2 + y_2 \sqrt d)
		&= \f 1{r^2}(x_1^2 - dy_1^2)(y_2^2 - dy_2^2) \\
		&= 1
	\end{align*}
	Diese Lösung $(u,v)$ ist nicht trivial, denn aus $u = 1, v = 0$ folgt $x_1 y_2 - x_2 y_1 = rv = 0$, also $x_1 y_2 = x_2 y_2$ und aus $x_1 < x_2$ folgt $y_1 < y_2$.
	Außerdem $x_1 y_2 - y_1 y_2 d = r$, also $x_1 y_2 x_2 - d y_1 y_2^2 = y_2 r$.
	Damit ist
	\[
		y_2 r = x_2^2 y_1 - dy_1 y_2^2 = \underbrace{(x_2^2 - dy_2^2)}_{=\pm r}y_1
	\]
	also ist $y_1 = \pm y_2$ und Gleichheit, wegen $y_1, y_2 > 0$.
	Damit ist aber auch $x_1 = x_2$, ein Widerspruch dazu, dass die Ausdrücke $x_1^2 - dy_1^2, x_2^2 - dy_2^2$ verschieden waren.

	Sei nun $(\xi, \eta)$, $\xi, \eta > 0$ so, dass $\xi + \eta \sqrt d > 1$ minimal ist als reelle Zahl.
	Wir zeigen, dass alle Lösungen eine Potenz davon sind.
	$(\xi, \eta)$ ist eindeutig bestimmt, da aus $\xi + \eta \sqrt d = x_0 + y_0 \sqrt d$ folgt, dass $\xi = x_0, \eta = y_0$, da $(1, \sqrt d)$ linear unabhängig über $\Q$ ist.

	Sei $x_0 + y_0 \sqrt d$, $x_0, y_0 > 0$ eine Einheit, die keine Potenz von $\xi + \eta \sqrt d$ ist.
	Dann existiert $n \in \N$ mit $(\xi + \eta \sqrt d)^n < x_0 + y_0 \sqrt d < (\xi + \eta \sqrt d)^{n+1}$

	Es gilt
	\[
		1 = (\xi + \eta \sqrt d)^n \underbrace{(\xi - \eta \sqrt d)^n}_{> 0}
		< \underbrace{(x_0 + y_0\sqrt d)(\xi - \eta \sqrt d)^n}_{:= \tilde u = \tilde x_0 + \tilde y_0 \sqrt d}
		< \xi + \eta \sqrt d.
	\]
	Mit \ref{6.9} folgt $\tilde x_0, \tilde y_0 > 0$ und daher ein Widerspruch zur Minimalität von $(\xi, \eta)$.
\end{proof}

% Lemma 6.9
\setcounter{thm}{8}
\begin{lem} \label{6.9}
	Sei $a + b \sqrt d$ eine Einheit (d.h. $(a,b)$ eine nicht-triviale Lösung der Pell'schen Gleichung).
	Dann ist $a + b \sqrt d > 1$ genau dann, wenn $a, b$ positiv sind.
	\begin{proof}
		\begin{segnb}{\ProofImplication}
			Sei $a - b \sqrt d$ die zu $a + b \sqrt d$ inverse Einheit, also $(a + b \sqrt d)(a - b \sqrt d) = 1$.
			Wenn $a + b \sqrt d > 1$, dann ist $a - b \sqrt d < 1$, also $a + b \sqrt > a - b \sqrt d$ und $b \sqrt d > - b \sqrt d$, $b > 0$.
			Wäre $a$ negativ, dann ist $a - b \sqrt d < 0$, ein Widerspruch zu $a - b \sqrt d$ positiv und somit $a$ positiv.
		\end{segnb}
		\begin{segnb}{\ProofImplication*}
			Sei umgekehrt $a, b$ positiv, dann ist $a + b \sqrt d > a - b \sqrt d$, also $a + b \sqrt d > 1$.
		\end{segnb}
	\end{proof}
\end{lem}

% Satz 6.10
\begin{st}[Euler, Lagrange] \label{6.10}
	Die Kettenbruchentwicklung einer irrationalen Zahl $\alpha$ ist genau dann periodisch, wenn $\alpha$ algebraisch vom Grad 2 ist, d.h. $\alpha$ ist Lösung einer quadratischen Gleichung der Form $ax^2 + bx + c = 0$ mit $a, b, c \in \Z$.
	\begin{proof}
		Sei $\alpha = [\_{a_0, a_1, \dotsc, a_n}]$, also „rein“ periodisch.
		Dann ist
		\[
			\alpha = [a_0, a_1, \dotsc, a_n, \alpha],
		\]
		also nach \ref{6.5} $\alpha = \f{\alpha P_n + P_{n-1}}{\alpha Q_n + Q_{n-1}}$, bzw.
		\[
			\alpha^2 Q_n + \alpha (Q_{n-1} - P_n) - P_{n-1} = 0,
		\]
		also ist $\alpha$ algebraisch vom Grad $2$.

		Ist $\gamma$ gemischt periodischer Kettenbruch, dann ist $\gamma = [a_0, \dotsc, a_n, \_{b_1, b_2, \dotsc, b_m}]$.
		Setze $\beta = [\_{b_1, \dotsc, b_m}]$, dann ist $\beta$ algebraisch vom Grad 2.
		Es ergibt sich $\gamma = \f{\beta P_n + P_{n-1}}{\beta Q_n + Q_{n-1}}$.
		Da $\beta$ algebraisch vom Grad $2$, ist auch $\gamma$ algebraisch vom Grad 2.

		Für die andere Richtung, siehe z.B. Scheid/Frommer 1.9 % fixme: ref
	\end{proof}
\end{st}
