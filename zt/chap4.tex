\chapter{Arithmetik in quadratischen Zahlenkörpern}

% Df 4.1
\begin{df} \label{4.1}
	Seien $K, L$ Körper und $K \subset L$.
	Dann kann man $L$ als $K$-Vektorraum betrachten, wobei die Skalarmultiplikation
	\begin{align*}
		\cdot : K \times L &\to L \\
		(k,l) &\mapsto k \cdot l
	\end{align*}
	durch die Multiplikation in $L$ gegeben ist.
	Aus den Körperaxiomen folgen sofort alle Vektorraumaxiome.
\end{df}

% Df 4.2
\begin{df} \label{4.2}
	Unter einem \emphdef[quadratischer Zahlkörper]{quadratischen Zahlkörper} versteht man einen Körper $L$ mit $L \supset \Q$ und $\dim_{\Q} L = 2$.

	Allgemeiner sind \emphdef{Zahlkörper} Körper $L$ mit $L \supset \Q$ und $\dim_\Q L < \infty$.
\end{df}

% Ex 4.3
\begin{ex} \label{4.3}
	\begin{enumerate}[a)]
		\item
			Statt $L \supset \Q$ schreibt man $L / \Q$.
			$\Q[i] / \Q$ ist ein quadratischer Zahlkörper, wobei $\Q[i] = \{ q_1 + q_2 i : q_j \in \Q \}$.

			Allgemeiner ist $\Q[\sqrt d] = \{ q_1 + q_2 \sqrt d : a_j \in \Q \}$ für $d \in \Z$ ein quadratischer Zahlkörper.
			Man kann annehmen, dass $d$ quadratfrei ist.
			Außerdem ist es egal, welche Wurzel gemeint ist, da $\Q[\sqrt d] = \Q[-\sqrt d]$.
			Auch ist $\Q[i] = \Q[\sqrt{-1}]$.
		\item
			Ist $L / \Q$ quadratischer Zahlkörper, dann gibt es $\alpha \in L \setminus \Q$, sodass $\alpha$ eine Nullstelle eines Polynoms $f \in \Q[x]$ vom Grad 2 ist.
			\begin{proof}
				$1, \alpha, \alpha^2$ ist linear abhängig über $\Q$.
				Es existiert also eine nichttriviale Linearkombination $q_1 \cdot 1 + q_2 \alpha + q_3 \alpha^2 = 0$.
				$\alpha$ ist Nullstelle von $q_1 + q_2 x + q_3 x^2$.
				Beachte $q_3 \neq 0$, denn sonst wäre $\alpha \in \Q$.
			\end{proof}
			Mit der Mitternachtsformel folgt, dass jeder quadratischer Zahlkörper von der Form $\Q[\sqrt d]$ ist.

			Da $\Q[\sqrt d]$ ein Körper ist, gilt $\Q[\sqrt d] = \Q(\sqrt d)$, wobei letztere Notation für den kleinsten Körper steht, der $\Q$ und $\sqrt{d}$ enthält.
		\item
			Setze
			\[
				\alpha := \begin{cases}
					\sqrt d & d \equiv 2, 3 \bmod 4 \\
					\f{1 + \sqrt d}2 & d \equiv 1 \bmod 4
				\end{cases}.
			\]
			Im Fall $d \equiv 1 \bmod 4$ ist $\Z[\sqrt d] = \{ z_1 + z_2 \sqrt{d} : z_j \in \Z \}$ ein echter Teilring von $\Z[\alpha]$ und $\Z[\alpha] = \{z_1 + z_2 \alpha : z_j \in \Z \}$ ist ein Teilring von $\Q[\sqrt d]$.

			Setzt man $\alpha = \f{1 + \sqrt d}2$ im Fall $d \equiv 2,3 \bmod 4$, dann ist $\Z[\alpha]$ kein Teilring.
	\end{enumerate}
\end{ex}

Ziel dieses Kapitels soll die Untersuchung von $\Z[\alpha]$ sein, insbesondere daraufhin, ob es ein Hauptidealbereich ist.
Klar ist, dass $\Z[\alpha]$ als Teilring von $\Q[\sqrt{d}]$ stets ein Integritätsbereich ist.
Was kann man über das Verhältnis von prim und irreduzibel aussagen?.
Wie sehen die Einheitengruppen aus?

Es gilt stets $\Z \subset \Z[\alpha]$ und in $\Z$ sind Primzahlen prim.
Was passiert mit diesen Primzahlen in $\Z[\alpha]$?

Alle diese Fragen führen in die algebraische Zahlentheorie.

% Lem 4.4
\begin{lem} \label{4.4}
	In $\Z[i]$ sind $1, -1, i, -i$ die einzigen Einheiten.
	Es gilt: $U(\Z[i]) = \< i \> \isomorphic C_4$.
	\begin{proof}
		Sei $a + bi \in U(\Z[i])$ mit
		$(a + bi)(c + di) = 1$, wobei $a, b, c, d \in \Z$.
		Dann ist
		\[
			(ac - bd)\cdot 1 + (ad + bc) i = 1
		\]
		Da $\{1, i\}$ eine Basis von $\Q[i]$ ist, gilt $ac - bd = 1$ und $ad +  bc = 0$.
		Falls $a = 0$, dann ist $bc = 0$, dann ist $b = 0 \lor c = 0$.
		Außerdem ist $-bd = 1$, also $b,d \in \{\pm 1\}$ und somit $b \neq 0$, also $c = 0$.
		Damit ist $a + bi = i$ und $c + di = -i$, oder umgekehrt.

		Falls $a \neq 0$, dann ist $d = - \f{bc}a$ und $ac + \f{b^2 c}a = 1$, also $(a^2 + b^2)c = a$ und insbesondere $(a^2 + b^2)|c| = |c|$.
		Es gilt $|z| = |z_1 + z_2 i| = \sqrt{z_1^2 + z_2^2} \ge 1$ nur, wenn wenn $z \neq 0$.
		Also ist $b = 0$ und $|c| = 1$ und $ac = 1$
		Somit sind $1, -1$ die einzigen Einheiten dieser Art.
	\end{proof}
\end{lem}

% Df 4.5
\begin{df} \label{4.5}
	Sei $R$ ein kommutativer Ring.
	\begin{enumerate}[a)]
		\item
			$R$ heißt \emphdef{euklidisch}, wenn es eine Abbildung $\phi: \R^* \to \N_0$ gibt, mit
			\[
				\forall a, b \in R, b \neq 0 \exists q,r \in R : (a = qb + r) \land (r = 0 \lor \phi(r) < \phi(b)).
			\]
			$\phi$ nennt man \emphdef{Gradfunktion}.
			\begin{note}
				Ein Ring $R$ kann bezüglich verschiedener Gradabbildungen euklidisch sein.
			\end{note}
		\item
			Ein Integritätsbereich $R$ heißt \emphdef{faktoriell}, wenn sich jede Nichteinheit verschieden von Null als endliches Produkt von Primelementen schreiben lässt.
		\item
			$R$ heißt \emphdef{noethersch} (nach Emmy Noether, 1882-1935), wenn jedes Ideal endlich erzeugt ist.
	\end{enumerate}
\end{df}

\coursetimestamp{22}{05}{2014}

% St 4.6
\begin{st} \label{4.6}
	Sei $R$ ein kommutativer Ring.
	Dann sind die folgenden Aussagen äquivalent
	\begin{enumerate}[(i)]
		\item
			Alle Ideale sind endlich erzeugt,
		\item
			Jede bezüglich der Inklusion aufsteigende Kette von Idealen bricht ab,
		\item
			Jede nicht-leere Menge $\scr M$, bestehend aus Idealen von $R$ besitzt bezüglich der Inklusion maximale Elemente.
	\end{enumerate}
	\begin{proof}
		\begin{seg}{(i)$\implies$(ii)}
			Sei $\{I_j\}$ eine aufsteigende Kette von Idealen.
			Dann ist $I := \bigcup_{j} I_j$ ein Ideal.
			Nach Voraussetzung ist $I$ endlich erzeugt, d.h. $I = \<x_1, \dotsc, x_m\>$.
			Da $I = \bigcup_j I_j$ liegt jedes $x_i$ liegt in einem $I_{j(i)}$.
			Setze $k := \max \{j(i)\}$, dann ist $I_k \supset \{x_1, \dotsc, x_m\}$, also $I_k \supset \<x_1, \dotsc, x_m\> = I$ und somit $I = I_k$.
		\end{seg}
		\begin{seg}{(ii)$\implies$(iii)}
			Sei $I_1 \in \scr M$.
			Wenn $I_1$ nicht maximal ist, dann existiert $I_2$ mit $I_1 \subsetneq I_2$.
			Induktiv entsteht eine aufsteigende Kette von Idealen, welche nach Voraussetzung an einem $I_k$ abbricht.
			$I_k$ ist dann maximales Element v.
		\end{seg}
		\begin{seg}{(iii)$\implies$(i)}
			Sei $I$ ein beliebiges Ideal und $x_1 \in I$.
			Wenn $\<x_1\> \neq hI$, dann existiert $x_2$ mit $x_2 \not\in \<x_1\>$, aber $x_2 \in I$.
			Es entsteht eine Kette $\<x_1\> \subset \<x_1, x_2\> \subset \dotsc$, welche nach Voraussetzung ein maximales Element $\<x_1, \dotsc, x_m\> = I$ besitzt.
		\end{seg}
	\end{proof}
\end{st}

% Df 4.4
\begin{df} \label{4.7}
	Ist $\beta = r + s\sqrt a \in \Q[\sqrt a]$, dann nennt man $\beta' := r - s\sqrt a$ das \emphdef[algebraisch konjugiert]{zu $\beta$ algebraisch konjugierte Element}.

	Die Abbildung $N: \Q[\sqrt a] \to \Q$, definiert durch
	\[
		N(\beta) := \beta \beta' = r^2 - s^2 d
	\]
	nennt man die \emphdef{Normabbildung}, $N(\beta)$ die \emphdef[Norm]{Norm von $\beta$}.
	\begin{note}
		Ist $d < 0$, dann ist $N(\beta) = |\beta|^2$.
	\end{note}
\end{df}

% Lem 4.8
\begin{lem} \label{4.8}
	\begin{enumerate}[a)]
		\item
			Die Abbildung $\sigma: \Q(\sqrt a) \to \Q(\sqrt a), \beta \to \beta'$ ist ein Korperautomorphismus von $\Q(\sqrt a)$ und $\sigma\big|_{\Z[\alpha_d]} : \Z[\alpha_d] \to \Z[\alpha_d]$ ist ein Ringautomorphismus, der genau die Elemente von $\Z$ festhält.
		\item
			$\sigma$ bildet irreduzible Elemente in irreduzible Elemente und Einheiten in Einheiten ab.
		\item
			$N$ ist multiplikativ, d.h. $\forall \beta, \gamma \in \Q(\sqrt a): N(\beta \gamma) = N(\beta) N(\gamma)$.
			Ist $u \in U(\Z[\alpha_d])$, dann ist $N(u) = \pm 1$.
	\end{enumerate}
	\begin{proof}
		Siehe Übung.
	\end{proof}
\end{lem}

$\Z$ ist offensichtlich ein euklidischer Ring mit $|\argdot|$ als Gradfunktion.

% St 4.9
\begin{st} \label{4.9}
	Der Ring $\Z[\alpha_d]$ ist euklidisch für $d \in \{-11, -7, -3, -2, -1, 2, 3, 5, 13\}$.
	\begin{proof}
		\begin{segnb}{$\Z[i] = \Z[\sqrt{-1}]$}
			Als Gradabbildung wählen wir die Normabbildung $a + bi \mapsto a^2 + b^2 = |a + bi|^2$.

			Seien nun $\alpha, \beta \in \Z[i]$, $\beta \neq 0$.
			Dann sind $\gamma, \delta \in \Z[i]$ gesucht mit $\alpha = \gamma \beta + \delta$ und $\delta = 0$ oder $|\delta|^2 < |\beta|^2$.

			Es genügt ein $\gamma$ zu finden mit $| \f \alpha\beta - \gamma | < 1$, denn
			\[
				\f \alpha\beta = \gamma + \f \delta\beta
				\iff \f \alpha\beta - \gamma = \f \delta \beta,
			\]
			also $| \f \alpha \beta - \gamma | < 1 \iff |\f \delta \beta| = \f {|\delta|}{|\beta|} < 1$.
			Ist $\gamma$ gefunden, so setzt man $\delta := \alpha - \gamma \beta$.

			Identifiziere $\C$ mit $\R^2$.
			Die ganzen Gaußschen Zahlen $\Z[i]$ bilden im $\R^2$ ein Gitter.

			Die Quadrate $\{[a, a+1] \times [bi, (b+1)i]: a,b \in \Z\}$ überdecken den ganzen $\R^2$.
			Also ist $\f \alpha\beta \in [a_0, a_0 + 1] \times [b_0 i, (b_0+1)i]$ für festgelegte $a_0, b_0 \in \Z$.

			Der Abstand von $\f \alpha\beta$ von einem geeigneten Eckpunkt der Gittermasche ist $\le \f{\sqrt 2}2 < 1$.
			Dieser Eckpunkt ist das gesuchte $\gamma$.
		\end{segnb}
		\begin{segnb}{$d < 0$}
			Ist $d < 0$, dann kann man für $\Z[\alpha_d]$ völlig analog argumentieren, nur die Maschengröße ändert sich:
			Für $d = -2$ ist die Masche $1 \times \sqrt 2$ mit Diagonale $\sqrt 3$, dann ist $\f {\sqrt 3}2 < 1$.

			Für $d = -3, -7, -11$ (sind $\equiv 1 \bmod 4$) hat man $\alpha_d = \f {\sqrt{d}}2$.


			Für $d = -11$ beispielsweise mit Diagonale $(1 + \f {|d|}4) = \f {15}4$.
			Länge der Diagonalen $\sqrt{15}{4} < 2$, als $\f 12 \sqrt{15}{4} < 1$.
		\end{segnb}
		\begin{segnb}{$d > 0$}
			Alle Elemente von $R$ sind reell, Veranschauliche $\Z[\alpha_d]$ in $\R^2$ folgendermaßen:
			\begin{align*}
				\sigma: \Z[\alpha_d] &\to \R^2 \\
				\beta &\mapsto (\beta, \beta')
			\end{align*}
			Das Bild von $\sigma$ ist ein Gitter in $\R^2$, erzeugt von $(1,1)$ und $(\sqrt d, -\sqrt d)$ für $d \equiv 2,3 \bmod 4$, bzw. $(1,1)$ und $(\alpha_d, -\alpha_d)$ für $d \equiv 1 \bmod 4$.
			Verwende als Gradfunktion für $R = \Z[\alpha_d]$ dann $\phi(\beta) = |N(\beta)| = |\beta \beta'|$.
			Zu zeigen ist wie im anderen Fall, dass für alle $\tilde \beta \in \Q[\sqrt d]$ ein $q \in \Z[\alpha_d]$ existiert mit $|N(\tilde \beta - q)| < 1$.

			Rest Übung.
			Hinweis:
			\[
				\forall x,y \in \R:  |x+y| < 2 \land |x-y| < 2 \implies |xy| < 1
			\]
		\end{segnb}
	\end{proof}
\end{st}

% St 4.10
\begin{st} \label{4.10}
	\begin{enumerate}[a)]
		\item
			Euklidische Ringe sind Hauptidealringe
		\item
			Hauptidealbereiche sind faktoriell
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Sei $R$ euklidisch und $I \neq \emptyset$ ein Ideal von $R$.
				Sei $\phi$ die Gradfunktion von $R$.
				Wähle $m \in I \setminus \{0\}$ mit $\phi(m)$ minimal.
				Sei $a \in I$ beliebig, dann ist $a = qm + r$.
				Falls $r = 0$, dann ist $a \in \<m\>$.
				Falls $r \neq 0$, dann ist $\phi(r) < \phi(m)$, aber $r = a - qm \in I$, ein Widerspruch zur Minimalität von $\phi(m)$ in $I$.
				Also ist $I \subset \<m\> \subset I$ und $I$ ist Hauptideal.
			\item
				Nach \ref{4.6} sind Hauptidealbereiche noethersch und jede Menge von Hauptidealen hat maximale Elemente.
				Nach \ref{1.8} lässt sich jede Nicht-Einheit $r \neq 0$ als ein endliches Produkt von irreduziblen Elementen schreiben.
				In Hauptidealbereichen sind nach \ref{1.7} irreduzible Elemente und Primelemente die selben.
		\end{enumerate}
	\end{proof}
\end{st}

% Bsp + Bem 4.11
\begin{nt} \label{4.11}
	\begin{enumerate}[a)]
		\item
			$\Z$ und $K[x]$ mit Körper $K$ sind euklidische Ringe mit $\phi = |\argdot|$, bzw. $\phi = \deg$.
		\item
			$\Z[x]$ ist kein Hauptidealbereich, z.B. $I = \<2, x\>$ ist kein Hauptideal.
		\item
			In faktoriellen Ringen gilt die eindeutige Zerlegung von Nicht-Einheiten ungleich Null in Primelemente
			Verwende dazu \ref{1.6}.
			Irreduzible Elemente in faktoriellen Ringen lassen sich auch eindeutig in Primelemente zerlegen.
			Also sind irreduzible Element äquivalent zu Primelementen.
		\item
			Euklidisch impliziert Hauptidealbreich impliziert faktoriell.
			In der Algebra zeigt man (Satz von Gauß):
			Ist $R$ faktoriell, dann ist $R[x_1, \dotsc, x_n]$ faktoriell.

			Insbesondere folgt aus $\Z$ faktoriell auch $\Z[x]$ faktoriell, allerding ist nach b) $\Z[x]$ kein Hauptidealbereich.
			Gibt es auch Hauptidealbereiche, die nicht euklidisch sind? Ja, siehe e).
		\item
			\ref{4.9} kann man verschärfen (bekannt seit 1966, Baker, Stark, Heegner):
			$\Z[\alpha_d]$ mit $d < 0$ ist genau dann eukldisch, wenn $d = -11, -7, -3, -2, -1$.
			Man weiß, dass $\Z[\f{1 + \sqrt{19}}2]$ ein Hauptidealbereich ist, aber nach obigem nicht euklidisch.

			Für $d > 0$ weiß man nicht alle $d$ für die $\Z[\alpha_d]$ euklidisch ist.
			Für $d < 0$ und $d = -19, -43, -67, -163$ ist $\Z[\alpha_d]$ ein Hauptidealbereich.
			Insgesamnt mit den $d$ aus \ref{4.9} gibt es genau 9 negative $d$, für die $\Z[\alpha_d]$ ein Hauptidealbereich ist, in allen anderen Fällen ist $\Z[\alpha_d], d < 0$ kein Hauptidealbereich.

			Für $d > 0$ kennt man alle $d$ für die $\Z[\alpha_d]$ ein euklidischer Ring mit Normbetrag als Gradfunktion ($d \in \{2, 3, 5, 6, 7, 11, 13, 17, 19, 21, 29, 33, 37, 41, 57, 73\}$).
			Für $d = 69$ ist $\Z[\alpha_{69}]$ euklidisch mit anderer Gradfunktion (bekannt seit 1994, Clark).

			Man vermutet, dass es unendlich viele Hauptidealbereiche $\Z[\alpha_d]$ für $d > 0$ gibt.
\coursetimestamp{26}{05}{2014}
		\item
			$\Z[\sqrt{-5}]$ ist nicht faktoriell, denn $(1 + \sqrt{-5})(1 - \sqrt{-5}) = 6 = 2 \cdot 3$.
			Aber $(1 + \sqrt{-5}), (1 - \sqrt{-5}), 2, 3$ sind irreduzibel:
			Wenn $x = ab$, dann ist $N(x) = N(a)N(b)$, bzw. hier: $|x| = |a||b|$.
			Kleinste Beträge, die auftauchen können sind $0, 1, 2, \sqrt{5}, \sqrt{6}, 3$.
			Einheiten haben Norm $\pm 1$, denn $1 = N(1) = N(u u^{-1}) = N(u) N(u^{-1})$.
			Damit lassen sich $2, 3, 1 + \sqrt{-5}, 1 - \sqrt{-5}$ nicht in ein Produkt von Nichteinheiten zerlegen, also sind sie irreduzibel.
			Also ist $\Z[\sqrt{-5}]$ nicht faktoriell.
			Siehe auch Übungen.
	\end{enumerate}
\end{nt}

Was passiert mit einer Primzahl $p \in \Z$ innerhalb von $\Z[\alpha_d]$?

% St 4.12
\begin{st} \label{4.12}
	Sei $p \in \Z$ eine Primzahl, $R = \Z[\alpha_d]$ und $R$ sei faktoriell.
	Dann gibt es in $R$ eine der drei folgenden Möglichkeiten:
	\begin{enumerate}[(i)]
		\item
			$p$ ist auch in $R$ ein Primelement.
			In diesem Fall nennt man $p$ \emphdef{träge}.
		\item
			$p = \pm \pi \pi' = \pm N(\pi)$ für zwei algebraisch konjugierte Primelemente $\pi, \pi' \in R$, die sich \emph{nicht} nur um eine Einheit unterscheiden.
			Man nennt $p$ \emphdef{zerlegt}.
		\item
			$p = \eps \pi^2$ mit $\eps \in U(R)$ und $\pi$ Primelement in $R$.
			Man nennt dann $p$ \emphdef{verzweigt}.
	\end{enumerate}
	Ferner gilt, dass jedes Primelement von $R$ Teiler einer eindeutig bestimmten Primzahl $q$ von $\Z$ ist.
	\begin{proof}
		Da $R$ faktoriell, lässt sich $p$ eindeutig in ein Produkt von Primzahlen zerlegen, d.h. $p = \eps \pi_1 \pi_2 \dotsb \pi_k$ für Primelemente $\pi_i$ und Einheit $\eps$.
		Dann ist
		\[
			p^2 = N(p) = \underbrace{N(\eps)}_{=\pm 1} N(\pi_1) \dotsb N(\pi_k),
		\]
		da die Norm multiplikativ ist.
		Da $\Z$ faktoriell ist, folgt, dass $k \le 2$ ist.

		Ist $k = 1$, so ist $p$ Primelement in $\Z[\sqrt{\alpha_d}]$.
		Für $k = 2$, unterscheide zwei Fälle: $\pi_1 \not\sim \pi_2$ und $\pi_1 \sim \pi_2$ ($\sim$ steht für Assoziiertheit, d.h. unterscheiden sich nur um eine Einheit).
		Für letzteren Fall gilt $\pi \pi' = N(\pi) \in \Z$ für beliebig vorgegebenes Primelement $\pi$, also $\pi$ teilt Primzahl.
		Angenommen $\pi$ teile $q_1$ und $q_2$, dann ist $q_1 = \pi x$ und $q_2 = \pi y$ ($q_1 \neq q_2$), also
		\[
			1 = z_1 q_1 + z_2 q_2
			= z_1 \pi x + z_2 \pi y
			= \pi(z_1 x + z_2 y)
		\]
		und $\pi$ ist eine Einheit, ein Widerspruch.
	\end{proof}
\end{st}

% St 4.13
\begin{st} \label{4.13}
	In $\Z[i]$ gilt für $p \in \P$.
	\begin{enumerate}[a)]
		\item
			$2 = (1 + i)^2 (-i) = N(1 + i)$, also ist $2$ verzweigt ($-i$ ist Einheit).
		\item
			$p$ ist träge, wenn $p \equiv 3 \bmod 4$.
		\item
			$p$ ist zerlegt, wenn $p \equiv 1 \bmod 4$.
	\end{enumerate}
	\begin{proof}
		\begin{enumerate}[a)]
			\item
				Zeige: $(1 + i)$ ist irreduzibel.
				Da $|1+i|^2 = 2$ und $|a + bi|^2 = a^2 + b^2$, sieht man sofort wegen der Multiplikativität der Norm, dass $1 + i$ nicht als Produkt von mehreren Nicht-Einheiten schreiben lässt.
			\item
				$p$ ist ungerade.
				$N(p) = p^2$.
				$p = cd$ in $\Z[i]$, dann ist $N(c) = p$ und $N(d) = p$.
				Außerdem wegen $c = c_1 + c_2 i$ auch $N(c) = c_1^2 + c_2^2 = p$.
				Modulo 4 sind Quadrate $\equiv 0$ oder $\equiv 1$.
				Wenn $p \equiv 3 \bmod 4$, dann ist $p$ keine Summe von zwei Quadraten.
				Also folgt b) mit \ref{4.12}.
			\item
				Ist $p \equiv 1 \bmod 4$, dann gilt nach dem ersten Ergänzungssatz, dass
				\[
					\legsym{-1}{p} = 1,
				\]
				d.h. es existiert $u_0 \in \Z$ mit $u_0^2 \equiv -1 \bmod p$.
				Ist $p \ndivs u_0$, dann hat $u_0 x \equiv y \bmod p$ für jedes $y$ eine Lösung $x_0$.
				Seien $x_0, y_0 \in \N$ mit $u_0 x_0 \equiv y_0 \bmod p$, dann ist
				\[
					-x_0^2 \equiv (u_0 x_0)^2 \equiv (y_0)^2 \bmod p,
				\]
				also $0 \equiv x_0^2 + y_0^2 \bmod p$.
				Kann man $x_0, y_0$ so wählen, dass $0 < x_0^2 + y_0^2 < 2p$ und es folgt sofort $x_0^2 + y_0^2 = p$.
				Betrachte modulo $p$ alle Werte $u_0 x - y$ für $0 \le x \le \ceil{\sqrt{p}}$ und $0 \le y \le \ceil{\sqrt p}$.
				Die Anzahl der Werte ist damit $\le (\sqrt{p} + 1)^2 > p$.
				Damit existieren $x_1, x_2, y_1, y_2$ mit $u_0 x_1 - y_1 \equiv u_0 x_2 - y_2 \bmod p$.
				Dann ist $u_0 (x_1 - x_2) \equiv y_1 - y_2 \bmod p$ und $0 < |x_1 - x_2| < \sqrt p$ und $0 < |y_1 - y_2| < \sqrt p$.
				Setze $\tilde x_0 = x_1 - x_2$, $\tilde y_0 = y_1 - y_2$.
				Dann ist $\tilde x_0^2 + \tilde y_0^2 < 2p$.
				Also ist die Behauptung bewiesen und $p$ lässt sich als Summe von zwei Quadraten schreiben.

				Wenn $p = x_0^2 + y_0^2$, dann ist $p = (x_0 + y_0 i)(x_0 - y_0 i)$ zerlegt.
				Die Eindeutigkeit der Zerlegung folgt dann aus der Eindeutigkeit der Zerlegung in irreduzibel, da $\Z[i]$ faktoriell.
				Insbesondere kann man eine Primzahl $p \equiv 1 \bmod 4$ nur eindeutig (bis auf Multiplikation mit Einheiten) als eine Summe von zwei Quadraten schreiben.
				Dass $x_0 \pm y_0 i$ irreduzibel sind, ergibt sich aus \ref{4.12}
		\end{enumerate}
	\end{proof}
\end{st}

Der nächste Abschnitt rechtfertigt $\Z[\sqrt{\alpha_d}]$ als einen Ring ganzer Zahlen zu bezeichnen.

% Df 4.14
\begin{df} \label{4.14}
	Eine Nullstelle eines Polynoms $f \in \Z[x]$ nennt man \emphdef{algebraische Zahl}.
	Ist $f$ ein normiertes Polynom aus $\Z[x]$, d.h. mit Leitkoeffizient 1, also
	\[
		f(x) = x^n + a_{n-1} x^{n-1} + \dotsb + a_1 x + a_0
	\]
	mit $a_i \in \Z$, $n \ge 1$ und $f(\alpha) = 0$.
	Dann nennt man $\alpha$ eine \emphdef{ganze algebraische Zahl}.

	Allgemeiner: Sei $S$ ein Teilring des Ringes $R$, dann nennt man ein Element $r \in R$ \emphdef{ganz über} $S$, wenn $r$ einer normierten Gleichung der Form
	\[
		x^n + s_{n-1} x^{n-1} + \dotsc + s_1 x_0 + s_0 = 0
	\]
	mit $s_i \in S$, $n \ge 1$ genügt.
\end{df}

% Ex 4.15
\begin{ex} \label{4.15}
	\begin{enumerate}[a)]
		\item
			Ganze algebraische Zahlen, die Nullstelle eines normierten Polynoms vom Grad $2$ sind:
			\[
				f(x) = x^2 + b x + c
			\]
			mit $b, c \in \Z$.
			Lösungen sind $\f 12 (-b \pm \sqrt{b^2 - 4c})$.

			Ist $b$ gerade, dass sind die Nullstellen der Form $\alpha + \beta \sqrt d$ mit $\alpha, \beta, d \in \Z$.
			Umgekehrt ist $\alpha + \beta \sqrt d$ Nullstelle von $x^2 - 2 \alpha x + \alpha^2 + \beta^2 d$.

			Ist $b$ ungerade, dann haben Nullstellen die Form $-\f b2 \pm \f 12 \sqrt{b^2 - 4c}$, wobei $b^2 - 4c \equiv 1 \bmod 4$, also ergibt sich die Form $- \f b2 \pm \f 12 \gamma \sqrt d$ mit ungeradem $\gamma \in \Z$.
			Ist umgekehrt $x = \f{\alpha}2 + \f{\beta}2 \sqrt{d}$ mit $\alpha, \beta \in \Z$ und ungerade und $d \equiv 1 \bmod 4$.
			Setze $b = -\alpha, b^2 = 1 + 4m, c = \f {1-d\beta^2}4 + m$, dann ist $x$ eine Nullstelle von $x^2 + bx + c = 0$.

			Ganze algebraische Zahlen eines normierten Polynoms von Grad 2 sind für festes $d$ von der Form
			\[
				\alpha + \beta \sqrt d
			\]
			wenn $d \equiv 2, 3 \bmod 4$ oder
			\[
				\alpha + \beta \f{1 + \sqrt d}2
			\]
			wenn $d \equiv 1 \bmod 4$ ist.
			Man rechnet nach, dass dies eine Teilmenge von $\Q(\sqrt d)$ ist.
			Die ganzen algebraischen Zahlen bilden den Ring $\Z[\alpha_d]$ der ganzen algebraischen Zahlen in $\Q(\sqrt d)$.
\coursetimestamp{02}{06}{2014}
		\item
			Wichtige weitere Beispiele ganzer algebraischer Zahlen sind Einheitswurzeln, d.h. Nullstellen von $x^n - 1$.
	\end{enumerate}
\end{ex}

% 4.16
\begin{nt} \label{4.16}
	Wir wollen nun Einheiten von $\Z[\alpha_d]$ betrachten.
	\begin{seg}{$d \equiv 2, 3 \bmod 4$}
		$u = x + y \sqrt d$ mit $x, y \in \Z$ ist genau dann eine Einheit, wenn $|N(u)| = 1 = |x^2 - dy^2|$.

		Gesucht sind ganzzzahlige Lösungen der Gleichungen
		\begin{enumerate}[(i)]
			\item
				$x^2 - dy^2 = 1$, bzw.
			\item
				$x^2 - dy^2 = -1$,
		\end{enumerate}
		also speziellen Diophantischen Gleichungen.

		$x^2 - dy^2 = -1$ ist nicht immer ganzzahlig lösbar, z.B. für alle $d < 0$, aber auch wenn $d > 0$ ist:
		Betrachte für $d = 3$ die Gleichung $x^2 - 3y^2 = - 1$.
		Angenommen $(x_0, y_0)$ wäre eine Lösung, dann folgt unmittelbar, dass $3$ kein Teiler von $x_0$ ist.
		Setze also $x_0 = 3k \pm 1$, dann ist $x_0^2$ von der For $x_0^2 = 3n + 1$.
		Dann ist $x_0^2 + 1 = 3n + 1 + 1 = 3y_0^2$, ein Widerspruch.

		Allgemein gilt: ist $d = 4m + 3 > 0$ mit $m > 0$, so hat (ii) keine Lösungen.
	\end{seg}
	\begin{seg}{$d \equiv 1 \bmod 4$}
		Sei $u = x + y \f {1 + \sqrt d}2$ mit $x,y \in \Z$ eine Einheit.
		Dann ist $N(u) = u u' = x^2 + xy + \f 14 y^2 + \f d4 y^2$.
		Es folgt $|N(u)| = |x^2 + xy - \f {d-1}4 y^2| = 1$ und äquivalent
		\[
			4 = | 4 x^2 + 4xy + y^2 - dy^2 |
			= | (2x + y)^2 - dy^2 |.
		\]
		Gesucht sind Lösungen von Gleichungen der Form
		\begin{enumerate}[(i), start=3]
			\item
				$u^2 - dv^2 = 4$, bzw.
			\item
				$u^2 - dv^2 = -4$.
		\end{enumerate}
		Lösungen gibt es offensichtlich nur, wenn $u - v$ gerade ist.
		Sind $u$ und $v$ gerade, dann setze $\tilde u = \f u2, \tilde v = \f v2$ und die Gleichungen (iii) und (iv) gehen in (i) und (ii) über.
		Sind $u$ und $v$ beide ungerade, so kann es Lösungen nur geben, wenn $d = 8n + 5$, denn $u$ ungerade, also $u^2 \equiv 1 \bmod 8$, analog $v^2 \equiv 1 \bmod 8$, also $d = 8n + x$ mit $x \in \{1, 5\}$.
		Einsetzen liefert $dv^2 \equiv x \bmod 8$.
		Modulo $8$ erhält man aus der Gleichung $1 - x \equiv 4 \bmod 8$, bzw. $1 - x \equiv -4 \bmod 8$, also muss $d = 8n + 5$.
	\end{seg}
\end{nt}

% St 4.17
\begin{st} \label{4.17}
	Ist $d < 0$, dann ist $\Z[\alpha_d]$ endlich und es gilt
	\begin{itemize}
		\item
			für $d = -1$: $U(\Z[i]) \isomorphic C_4 = \<i\> = \{ \pm 1, \pm i \}$,
		\item
			für $d = -3$: $U(\Z[\alpha_3]) \isomorphic C_6$ und isomorph zur zyklischen Gruppe der $6$-ten Einheitswurzeln.
		\item
			für $d < -3$: $U(\Z[\alpha_d]) \isomorphic \pm 1 \isomorphic C_2$.
	\end{itemize}
	\begin{proof}
		Für $d = -3$ siehe Übungen..
		Die anderen Fälle folgen unmittelbar daraus, dass im Fall $d \not\equiv 1 \bmod 4$ $x^2 + (-d) y^2 = 1$ nur dann, wenn $y = 0$ oder $d = -1$ und dann $x = \pm 1, y = \pm 1$.
		Den Fall $d \equiv 1 \bmod 4$ folgt ähnlich mit obigen Gleichungen.
	\end{proof}
\end{st}

% Df 4.18
\begin{df} \label{4.18}
	Die diophantische Gleichung $x^2 - dy^2 = 1$ nennt man \emphdef{Pellsche Gleichung}.
\end{df}

% Bem + Bsp 4.19
\begin{nt} \label{4.19}
	\begin{enumerate}[a)]
		\item
			John Pell, 1610 - 1685, aber früher wurden Gleichungen dieser Art bereits von Brahmagupta, 1598 - 1665 behandelt, z.B. $x^2 - 92 y^2 = 1$.
			Er hat eine Lösung $x = 1151, y = 120$, die „kleinste Lösung“ gefunden.

			Brauchbare Lösungsmethoden gehen auf Lagrange und Legendre zurück.
		\item
			$x^2 - 3y^2 = 1$ hat die Lösung $(2,1)$.
			Die zugehörige Einheit von $\Z[\sqrt 3]$ ist $u = 2 + \sqrt 3$ mit $u^{-1} = 2 - \sqrt 3$.
			Auch $(-2, -1), (-2, 1), (2, -1)$ sind Lösungen der Gleichungen.
		\item
			Es interessieren im Wesentlichen die Lösungen mit $x > 0$ und $y > 0$.
			Die Lösungen $(\pm 1, 0)$ nennt man trivale Lösungen der Pell'schen Gleichung.
		\item
			Ist $(x_1, y_1)$ eine Lösung von $x^2 - dy^2 = 1$, dann ist $x_1 + y_1 \sqrt d$ eine Einheit.
			Auch eine Einheit ist
			\[
				(x_1 + y_1 \sqrt d)^2
				= x_1^2 + 2x_1 y_2 \sqrt d + y_1^2 d
				= x_1^2 + dy_1^2 + 2x_1 y_1 \sqrt d
			\]
			und liefert daher auch Lösungen von der Pellschen Gleichung.
			Für $d > 0, x_1 > 0, y_1 > 0$ ist $x_1^2 + dy_1^2 > x_1 \land 2x_1y_1 > y_1$.

			Einheiten, die von nicht trivialen Lösungen der Pellschen Gleichung stammen, haben also unendliche Ordnung.
		\item
			Etwas allgemeiner gilt für eine nicht-triviale Einheit $u_1$
			\[
				u_1 u_2 = (x_1 + y_1 \sqrt d)(x_2 + y_2 \sqrt d)
				= x_1 x_2 + dy_1 y_2 + (x_1 y_2, + y_1 x_2) \sqrt d
			\]
			und $x_1 x_2 + dy_1y_2 > \max\{x_1, x_2\}$ und $x_1y_2 + y_1 x_2 > \max \{y_1, y_2\}$.
	\end{enumerate}
\end{nt}

% St 4.20
\begin{st} \label{4.20}
	Die Pellsche Gleichung $x^2 - dy^2 = 1$ hat unendlich viele Lösungen für $d > 0$.
	Es gibt eine Lösung $(\xi, \eta)$, sodass $\xi, \eta > 0$ und
	\[
		\Set{(x_n, y_n) & x_n + y_n \sqrt d = \pm (\xi + \eta \sqrt d)^n, n \in \Z }
	\]
	die Menge alle Lösungen der Pellschen Gleichung ist.
\end{st}

% Df 4.21
\begin{df} \label{4.21}
	Die Lösung $(\xi, \eta)$ aus \ref{4.20} nennt man \emphdef{Grundlösung} der Pellschen Gleichung.
\end{df}

% Bem + Bsp 4.22
\begin{nt} \label{4.22}
	\begin{enumerate}[a)]
		\item
			Es gilt $(\xi + \eta \sqrt d)^{-1} = \xi - \eta \sqrt d$ und $\pm 1 = \pm (\xi + \eta \sqrt d)^0$.
		\item
			Die Einheiten von $\Z[\sqrt d]$ der Form $a + b \sqrt d$ mit $a, b$ Lösungen der Pellschen Gleichung bilden eine zu $C_2 \times C_\infty = \<-1\> \times \<\xi + \eta \sqrt d\>$ isomorphe Gruppe.
		\item
			$(2,1)$ ist die Grundlösung von $x^2 - 3y^2 = 1$.
			\begin{proof}
				Nach \ref{4.20} existiert eine Grundlösung $(a,b)$, also $2 + \sqrt 3 = (a + b\sqrt 3)^n$.
				Nach \ref{4.19} d) schreiben wir $(a + b \sqrt 3)^m = a_m + b_m \sqrt 3$ für $m \in \N$.
				Dann ist für $m_1 < m_2$
				\[
					a_{m_1} < a_{m_2} \land b_{m_1} < b_{m_2}.
				\]
				Es genügt also „kleinere“, mögliche Einheiten als $2 + \sqrt 3$ zu suchen.
				Es verbleibt nur $1 + \sqrt 3$, dies ist aber keine Lösung der Pellschen Gleichung.
			\end{proof}
			Um nachzuweisen, dass $(1151, 120)$ Grundlösung von $x^2 - 92y^2 = 1$ ist, muss man also zeigen, dass $a + b\sqrt{92}$ keine Lösung der Pellschen Gleichung für $0 < a < 1151 \land 0 < b < 120$ besitzt.
		\item
			Es gilt $U(\Z[\alpha_3]) = \<-1\> \times \<2 + \sqrt 3\> \isomorphic C_2 \times C_\infty$.

			Die Gleichung (ii) aus \ref{4.16} liefert keine Einheiten, da $d = 3$.
			Alle Einheiten entstammen aus Lösungen der Pellschen Gleichung.
			Nach c) ist $2 + \sqrt 3$ eine Grundeinheit (Einheit einer Grundlösung).
		\item
			\ref{4.20} beweist man mit Hilfe von Kettenbruchentwicklungen, siehe dazu Kapitel 6. % fixme: ref
			Wann kann sowas nützlich sein?
			Betrachte $x^2 - 3y^2 = 1$.
			\[
				\f{x^2}{y^2} = 3 + \f 1{y^2}
			\]
			und damit $\f xy \approx \sqrt 3$ für große $y$.
			Die Kettenbruchentwickling von $\sqrt 3$ spielt dann eine wichtige Rolle.
	\end{enumerate}
\end{nt}

% St 4.23
\begin{st} \label{4.23}
	Ist $d = t^2 + 1$ mit $k \in \N$, dann hat die Pellsche Gleichung
	\[
		x^2 - dy^2 = 1
	\]
	die Grundlösung $(2t^2 + 1, 2t)$.
	\begin{proof}
		Nach Einsetzen muss gelten $x^2 = 1 + (t^2 + 1)y^2$.
		Suche eine möglichst kleines $y$, so dass die rechte Seite $1 + (t^2 + 1)y^2$ ein Quadrat ist.
		Wäre $y$ ungerade, dann ist wegen $y^2 \equiv 1 \bmod 4$
		\[
			1 + (t^2 + 1)y^2
			\equiv 1 + t^2 + 1 \mod 4,
		\]
		also $x^2 \equiv 2 \bmod 4$ oder $x^2 \equiv 3 \bmod 4$, aber $x^2 \equiv 1 \bmod 4$ oder $x^2 \equiv 0 \bmod 4$, ein Widerspruch.
		Also ist $y$ gerade mit $y = 2m$.
		Ist $m = t$, dann ergibt sich eine Lösung:
		\[
			1 + (t^2 + 1)\cdot 4t^2
			= 4t^2 + 4t^4 + 1
			= (\underbrace{2t^2 + 1}_{=:x})^2.
		\]
		Für $1 \le m \le t$ ist
		\[
			1 + (t^2 + 1)\cdot 4m^2
			= 4m^2 t^2 + 4m^2 + 1
			= (2mt + \f mt)^2 + 1 - (\f mt)^2,
		\]
		also $t^2(1 + (t^2 + 1)m^2\cdot 4) = (2mt^2 + m)^2 + t^2 - m^2 =: R$.
		Aber
		\[
			(2mt^2 + m)^2
			\le \underbrace{(2mt^2 + m)^2 + t^2 - m^2}_{=R}
			< \underbrace{(2mt^2 + m + 1)^2}_{= (2mt + m)^2 + 2(2mt^2 + m) + 1}.
		\]
		Es folgt $t = m$, wenn $R$ ein Quadrat sein soll.
		Es gibt also keine kleinere Lösung und $(2t^2 + 1, 2t)$ ist die Grundlösung.
	\end{proof}
\end{st}
