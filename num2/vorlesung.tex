\documentclass[
	%noproofs
]{mycourse}

\title{Numerische Mathematik 2}
\author{}

\begin{document}

\maketitle
\tableofcontents

\chapter{Gewöhnliche Differentialgleichungen}


\section{Einführung und Beispiele}


\subsection{Mathematische Beispiele gewöhnlicher Differentialgleichungen}

Eine DGL ist eine Gleichung, die eine unbekannte Funktion zusammen mit ihren Ableitungen enthält.

\begin{ex} \label{1.1}
	\begin{enumerate}[a)]
		\item
			Betrachte
			\[
				y'(x) = 0
			\]
			oder kurz $y' = 0$.
			Gesucht ist
			\begin{align*}
				y: \R &\to \R \\
				x &\mapsto y(x)
			\end{align*}
			mit $y$ differenzierbar und $y'(x) = 0$ für alle $x \in \R$.
			\begin{itemize}
				\item
					Spezielle Lösungen sind z.B. $y(x)=0$, $y(x)=1$, $y(x) = 37$.
				\item
					Die \emph{allgemeine} Lösung ist $y(x) = C$, $C \in \R$, d.h. man kann zeigen, dass jede solche Funktion die DGL löst und jede Lösung in dieser Form geschrieben werden kann
			\end{itemize}
		\item
			Betrachte
			\[
				y'(x) = r y(x),
				\qquad r\in \R
			\]
			oder kurz $y' = ry$.
			\begin{itemize}
				\item
					Spezielle Lösungen sind $y(x)=e^{rx}$, $y(x)=0$, $y(x)=3e^{rx}$.
				\item
					Die \emph{allgemeine} Lösung ist $y(x) = C e^{rx}$, $C\in \R$.
			\end{itemize}
		\item
			Betrachte die DGL höherer Ordnung
			\[
				y''(x) = -y(x)
			\]
			oder kurz $y'' = -y$.
			\begin{itemize}
				\item
					Spezielle Lösungen sind $y(x) = 0$, $y(x) = \sin x$, $y(x)=\cos x$.
				\item
					Die allgemeine Lösung ist
					\[
						y(x) = C_1 \sin x + C_2 \cos x,
						\qquad C_1, C_2 \in \R
					\]
			\end{itemize}
		\item
			Betrachte das DGL-System
			\begin{align*}
				y_1''(x) &= -y_1(x) \\
				y_2''(x) &= y_3(x) \\
				y_3''(x) &= y_3(x) \\
			\end{align*}
			\begin{itemize}
				\item
					Eine spezielle Lösung ist
					\begin{align*}
						y_1(x) &= \sin x \\
						y_2(x) &= 37 \\
						y_3(x) &= 0
					\end{align*}
				\item
					Die allgemeine Lösung ist (für $C_1,C_2,C_3,C_4 \in \R$)
					\begin{align*}
						y_1(x) &= C_1 \sin x + C_2 \cos x \\
						y_2(x) &= C_3 e^x + C_4 \\
						y_3(x) &= C_3 e^x
					\end{align*}
			\end{itemize}
		\item
			Betrachte die DGL $y' = y$ für eine vektorwertige Funktion.
			Gesucht ist also
			\begin{align*}
				y: \R &\to \R^2 \\
				x &\mapsto y(x) = \begin{pmatrix}
					y_1(x) \\ y_2(x)
				\end{pmatrix}
			\end{align*}
			mit
			\begin{align*}
				\begin{pmatrix}
					y_1'(x) \\ y_2'(x)
				\end{pmatrix}
				=
				\begin{pmatrix}
					y_1(x) \\ y_2(x)
				\end{pmatrix}
			\end{align*}
			Man sieht hier sofort die Äquivalenz zu einem entsprechenden DGL-System.
	\end{enumerate}
\end{ex}

Bei \emph{gewöhnlichen} DGLs beziehen sich alle Ableitungen auf die selbe eindimensionale Variable.

\begin{ex} \label{1.2}
	Betrachte $y : \R^2 \to \R : (x_1,x_2) \mapsto y(x) = y(x_1,x_2)$ mit einer sogenannten \emph{partielle Differentialgleichung} (PDGL):
	\[
		\f{\d^2y}{\d x_1^2} + \f{\d^2 y}{\d x_2^2 }
	\]
	\begin{itemize}
		\item
			Spezielle Lösungen sind $y(x) = 0, y(x) = x_1 + x_2$.
		\item
			Allgemeine Lösungen sind schwierig.
	\end{itemize}
\end{ex}

Wir werden uns im Folgenden nur mit gewöhnlichen Differentialgleichungen beschäftigen.

\subsection{Anwendungsbeispiele für gewöhnliche Differentialgleichungen}

\subsubsection{Continuous compounding-stetige Verzinsung}

Beschreibe $y(t)$ das Sparguthaben zum Zeitpunkt $t$.

\fixme[Bild Zinsen]

Die Bank zahlt Zinsen proportional zum Guthaben und Zeitspanne
\[
	\Delta y(t) := y(t + \Delta t) - y(t) = r y(t) \Delta t
\]
mit festgelegtem Zinssatz $r$.
Für $\Delta t \to 0$ ergibt sich
\[
	\dot y (t) = ry(t),
\]
eine DGL mit der Lösung
\[
	y(t) = Ce^{rt}.
\]

\subsubsection{Populationsdynamik}

Beschreibe $y(t)$ die Anzahl von Individuen in einer Population.

\begin{description}
	\item[Model 1 (Malthus)]
		Die Population wächst mit konstanter Rate $r \in \R$.
		In einer kurzen Zeiteinheit $\Delta t$ ist
		\[
			\Delta y \approx ry \Delta t
			\quad \implies \quad
			\dot y = r y
		\]
	\item[Model 2 (Verhulst)]
		Es existiert eine Maximalbevölkerung $M > 0$.
		Die Population wächst mit von $y$ abhängiger Rate
		\[
			\begin{cases}
				\text{Wachstum mit Rate $r$} & y \ll M \\
				\text{Wachstum mit Rate $0$} & y \approx M
			\end{cases}
		\]
		Im Zeitintervall $\Delta t$ wächst die Population um $\Delta y \approx r(1-\f yM) M \Delta t$.
		Es ergibt sich die DGL
		\[
			\dot y = r \Big(1 - \f yM\Big) y = ry \underbrace{- \f rM y^2}_{\mathclap{\text{Todesrate aufgrund zu hoher Population}}}
		\]
	\item[Model 3 (Lofka-Volterra, Räuber-Beute Modell)]
		Betrachte zwei Populationen $y_1(t), y_2(t)$ (Räuber und Beutetiere), beschrieben durch folgenden DGLs:
		\begin{align*}
			\dot y_1 &= r_1 y_1 - f_1y_1y_2
			\qquad r_1,f_1 \in \R \\
			\dot y_2 &= -r_2 y_2 + f_2 y_1y_2
		\end{align*}
		\fixme[Bild Populationsentwicklung $y_1$ zu $y_2$, Kreis]
\end{description}


\subsubsection{Chemische Reaktionen}


Seien $A(t), B(t), C(t)$ Konzentrationen der Chemikalien $A,B,C$.
Betrachte die Reaktion
\[
	A \overset{k}{\longrightarrow} B.
\]
In einem kurzen Zeitinvervall $\Delta t$ wandeln sich $k A(t) \Delta t$ Moleküle von $A$ in $B$ um.
\begin{align*}
	\dot A(t) &= -k A(t) \\
	\dot B(t) &= k A(t)
\end{align*}
Betrachte die Reaktion
\[
	A + B \overset{k}{\longrightarrow} C + 2D.
\]
Diese kann durch folgende DGLs beschrieben werden:
\begin{align*}
	\dot A &= -kAB,  \\
	\dot B &= -kAB, \\
	\dot C &= kAB, \\
	\dot D &= 2kAB.
\end{align*}


\subsubsection{Newtonsche Gesetze}

\fixme[Bild]

Beschreibe $x(t)$ die Position, $v(t) = \dot x(t)$ die Geschwindigkeit und $a(t) = \dot v(t) = \ddot x(t)$ die Beschleunigung eines Teilchens im $\R^3$ zu einem Zeitpunkt $t$.

Newton: Wirkt eine Kraft $F(t)$ auf einen Körper der Masse $m$, so ist
\[
	F(t) = m a(t) = m\ddot x(t)
\]


\subsubsection{Elektrische Schaltkreise}

\fixme[Bild: Schaltkreis]

Betrachte eine RLC-Reihenschaltung.
Es lassen sich folgende Größen beschreiben:
\begin{itemize}
	\item
		Stromstärke $I_R$ durch den Widerstand
		\[
			I_R(t) = \f {U_R(t)}R
		\]
		für $R \in \R$.
	\item
		Stromstärke $I_C$ durch den Kondensator
		\[
			I_C(t) = \dot  U_C(t) C
		\]
		für $C \in \R$.
	\item
		Stromstärke $I_L$ durch die Spule
		\[
			\dot I_L(t) = \f {U_L(t)}L
		\]
		für $L \in \R$.
\end{itemize}

Die Kirchhoffschen Gesetze besagen
\begin{gather*}
	U(t) = U_R(t) + U_C(t) + U_L(t), \qquad \text{(Spannungsbilanz)} \\
	I_L(t) =  I_C(t) = I_R(t). \qquad \text{(Strombilanz)}
\end{gather*}
Es ergibt sich mit obigen Gleichungen
\begin{align*}
	U_R(t) &= RC \dot U_C(t) \\
	U_L(t) &= L \dot I_L(t) = LC \ddot U_C(t) \\
\end{align*}
also ergibt sich die DGL
\[
	U(t) = U_C(t) + RC \dot U_C(t) + LC \ddot U_C(t)
\]


\subsection{Anfangswertprobleme}


Die Lösung einer gewöhnlichen DGL ist üblicherweise nicht eindeutig bestimmt.
Die allgemeine Lösung von
\[
	\dot y(t) = ry(t)
	\qquad \text{ist} \qquad
	y(t) = Ce^{rt}
\]
mit Parameter $C \in \R$.
In vielen Anwendungen sind die Parameter eindeutig bestimmt durch die Anfangswerte von $y$.
Beispielsweise bei stetiger Verzinsung gibt $C=y(0)$ das Anfangsguthaben an.

Intuitiv erwarten wir, dass die Lösung eindeutig durch folgende Vorgaben bestimmt wird:
\begin{itemize}
	\item
		Bei der Populationsdynamik durch die anfängliche Population $y(0)$, bzw. $y_1(0)$ und $y_2(0)$.
	\item
		Bei der Chemischen Reaktion durch die anfänglichen Konzentrationen $A(0), B(0)$.
	\item
		Bei den Newtonschen Gesetzen durch die anfängliche Position $x_1(0),x_2(0),x_3(0)$, und die anfänglichen Geschwindigkeiten $v_1(0), v_2(0), v_3(0)$.
	\item
		Bei den Elektrischen Schaltkreisen durch die anfängliche Spannung $U_C(0)$ und Stromstärke $\dot U_C(0)$ am Kondensator.
\end{itemize}
Eine gewöhnliche DGL zusammen mit Anfangsbedingungen heißt \emph{Anfangswertproblem} (AWP).


\subsection{Elementare Lösungsmethoden}


\subsubsection{Raten/Wissen der Lösung}

Siehe \ref{1.1}.

\subsection{Separation der Variablen}


Für eine gewöhnliche DGL der Form
\[
	y'(x) = g(x) h(y(x))
\]
schreiben wir formal
\[
	\f {dy}{dx} = g(x) h(y)
	\qquad \leadsto \qquad
	\int \f 1{h(y)} dy = \int g(x) dx
\]

\begin{ex} \label{1.3}
	Betrachte Modell 2 aus der Populationsdynamik ($M=1=r$).
	\begin{align*}
		\f {dy}{dt} = \dot y(t) = (1-y)y
		\qquad \leadsto \qquad
		\int \f 1{(1-y)y} dy = \int 1 dt = t + \const
	\end{align*}
	Für einen Startwert $y(0) > 1$ erwarten wir $y(t) \ge 1$ für $t \ge 0$.
	Sei nun $y(0) > 1$.

	Es ergibt sich durch Partialbruchzerlegung
	\begin{align*}
		\int \f 1{(1-y)y} dy 
		= \int \f 1y dy + \int \f1{1-y} dy
		= - \ln (y-1) + \ln(y) + \const
		= \ln \f {y}{y-1} + \const
	\end{align*}
	Also 
	\begin{align*}
		\ln \f {y}{y-1} &= t + \const \\
		\implies \qquad	\f y{y-1} &= C e^t \qquad C \ge 0 \\
		\implies \qquad y(t) &= \f {Ce^t}{Ce^t - 1}
	\end{align*}
	Das Vorgehen war \emph{formal} und beweist weder, dass dies eine Lösung ist, noch, dass alle Lösungen so aussehen.
	Erst Einsetzen von $y(t)$ in die DGL beweist, dass dies eine Lösung (für jedes $C>0$) ist.

	$C$ kann aus Anfangswerten bestimmt werden:
	\[
		y_0 := y(0) = \f C{C-1}
		\quad \implies \quad
		C = \f {y_0}{y_0-1}
	\]
\end{ex}

\subsubsection{Variation der Konstanten}

Betrachte eine lineare inhomogene DGL
\[
	y'(x) = ry(x) + z(x).
\]
Die allgemeine Lösung der \emph{homogenen Gleichung} $y'(x) = ry(x)$ ist $y(x) = Ce^{rx}$.

Ansatz: Ersetze zur Lösung der inhomogenen Gleichung die Konstante $C$ durch eine Funktion $C(x)$:
\[
	y(x) = C(x) e^{rx}
\]
Löst $y$ die DGL, so ist
\[
	rC(x)e^{rx} + C'(x)e^{rx} = y'(x) = ry(x) + z(x) = rC(x)e^{rx} + z(x)
\]
also $C'(x) e^{rx} = z(x)$ und damit
\[
	C'(x) = z(x) e^{-rx}
\]
Integration liefert $C(x)$ und Nachprüfen zeigt, dass die so gefundene Funktion tatsächlich die DGL löst.



\section{Theorie gewöhnlicher Differentialgleichungen}



\subsection{Eine allgemeine Form}


\begin{ex} \label{1.4}
	Die DGL $y'' = -y$ kann in ein System erster Ordnung transformiert werden.
	Setze dazu
	\begin{align*}
		u = \begin{pmatrix}
			u_1(x) \\ u_2(x)
		\end{pmatrix} = \begin{pmatrix}
			y(x) \\ y'(x)
		\end{pmatrix}
	\end{align*}
	Die DGL lässt sich jetzt schreiben als
	\begin{align*}
		u'(x) =
		\begin{pmatrix}
			y'(x) \\ y''(x)
		\end{pmatrix}
		= \begin{pmatrix}
			y'(x) \\ -y(x)
		\end{pmatrix}
		= \begin{pmatrix}
			u_2(x) \\ -u_1(x)
		\end{pmatrix}
		=: f(x, u(x))
	\end{align*}
\end{ex}


Von nun an betrachten wir das AWP in der folgenden allgemeinen Form:
\[
	y'(x) = f(x,y(x))
	\qquad y(x_0) = y_0
\]
wobei $x \in [x_0,\infty) \subset \R$, $y(x) = (y_1(x)),\dotsc,y_d(x))^T \in \R^d$ vektorwertig, $d \in \N$ und $f : \R^{d+1} \to \R^d$ mit
\[
	f(x,y) = \begin{pmatrix}
		f_1(x,y_1,\dotsc, y_d) \\
		\vdots \\
		f_d(x,y_1,\dotsc, y_d)
	\end{pmatrix}
\]
Die DGl $y' = f(x,y(x))$ ist äquivalent zum DGL-System
\begin{align*}
	y_1.(x) &= f_1(x,y_1(x),\dotsc,y_d(x)) \\
	\vdots \quad &= \qquad \vdots \\
	y_d.(x) &= f_d(x,y_1(x),\dotsc,y_d(x)) \\
\end{align*}
Geichungen höherer Ordnung (also solche, die $y'', y''', \dotsc$ enthalten), können in diese Form transformiert werden, indem $y$ und seine Ableitungen (zis zur zweithöchsten Ordnung in einer vektorwertigen Hilfsfunktion $u=(u_1,u_2,\dotsc)$ zusammengefasst werden:
\begin{align*}
	u_1(x) &= y(x) \\
	u_2(x) &= y'(x) \\
	u_3(x) &= y''(x) \\
	\vdots \quad&= \qquad \vdots
\end{align*}


\subsection{Existenz, Eindeutigkeit und Stabilität}


Ein Problem heißt \emph{wohlgestellt} (nach Hadamard), wenn
\begin{enumerate}[a)]
	\item
		eine Lösung existiert (Existenz)
	\item
		die Lösung eindeutig ist (Eindeutigkeit)
	\item
		die Lösung stetig von den Eingabeparametern abhängt (Stabilität)
\end{enumerate}
Für das AWP $y'(x) = f(x,y(x))$, $y(x_0) = y_0$ bedeutet Wohlgestelltheit, dass eine eindeutige Lösung $y(x)$ existiert und diese stetig von den Anfangswerten $y_0$ (und evtl in $f$ vorhandenen Parametern) abhängt.


\subsubsection{Existenz und Eindeutigkeit}


\begin{st}[Picard-Lindelöfscher Existenz und Eindeutigkeitssatz] \label{1.5}
	Seien $x_0, x_{\text{end}} \in \R$ mit $x_0 < x_{\text{end}}$ und $y_0 \in \R^d$.
	Für
	\begin{align*}
		f: [x_0, x_{\text{end}}] \times \R^d &\to \R^d \\
		(x,y) & \mapsto f(x,y)
	\end{align*}
	gelte
	\begin{enumerate}[a)]
		\item
			$f$ ist stetig
		\item
			$f$ ist (global in $\R^d$ und bezüglich $x$ gleichmäßig) Lipschitzstetig in $y$, d.h. es existiert $L > 0$ mit
			\[
				\|f(x,y) - f(x,z)\| \le L \|y-z\|
				\qquad \forall x\in [x_0,x_{\text{end}}], y,z \in \R^d
			\]
	\end{enumerate}
	Dann existiert eine stetig differenzierbare Funktion $y : [x_0,x_{\text{end}}] \to \R^d$ mit
	\begin{align*}
		y' &= f(x,y(x)) \qquad x\in(x_0,x_{\text{end}}) \\
		y(x_0) &= y_0
	\end{align*}
\end{st}

Wir werden \ref{1.5} mit Hilfe von \ref{1.6} und anderen Hilfssätzen beweisen.

\begin{st}[Banachscher Fixpunktsatz] \label{1.6}
	Sei $(X,d)$ ein vollständiger metrischer Raum und $\Phi: X \to X$ ein kontrahierende Selbstabbildung, d.h. es existiert $q < 1$ mit
	\[
		d(\Phi(x), \Phi(y)) \le q d(x,y)
		\qquad x,y \in X
	\]
	Dann besitzt $\Phi$ genau einen Fixpunkt $\hat x \in X$, d.h. $\Phi(\hat x) = \hat x$.

	Für jeden Startwert $x^{(0)} \in X$ konvergiert die durch die Fixpunktiteration definierte Folge
	\[
		x^{(k+1)} = \Phi(x^{(k)})
	\]
	in der gegebenen Metrik gegen $\hat x$, d.h. $d(x^{(k)},\hat x) \to 0$ ($k \to \infty$).
	\begin{proof}
		siehe Numerik 1.
	\end{proof}
\end{st}


Als vollständiger metrischer Raum werden wir den Raum der stetigen Funktionen betrachten

\begin{lem} \label{1.7}
	Die Menge der auf $[x_0, x_{\text{end}}]$ stetigen Funktionen
	\[
		C([x_0,x_{\text{end}}])^d := \Big\{ y:[x_0,x_{\text{end}}] \to \R^d \text{ stetig} \Big\}
	\]
	ist bezüglich der Supremumsnorm (Maximumsnorm) $\|y\|_\infty = \max_{x\in [x_0,x_{\text{end}}]} \|y(x)\|$ ein Banachraum (bezüglich der induzierten Metrik $d(y_1,y_2) = \|y_1-y_2\|_\infty$ ein vollständiger metrischer Raum).
	\begin{proof}
		Die Vektorraumaxiome und Normeigenschaften sind eine Übung.

		\begin{seg}[Vollständigkeit]
			Zeige: jede Cauchyfolge konvergiert in $C([x_0,x_{\text{end}}])^d$ bezüglich $\|\cdot\|_\infty$.
			Sei $(y^{(n)})_{n \in \N}$ eine Cauchyfolge bezüglich $\|\cdot\|_\infty$, d.h. $\forall \eps > 0 \exists N \in \N : \forall n,m \ge N$ gilt:
			\[
				\eps > \|y^{(n)} -y^{(m)}\|_\infty = \max_{x\in [x_0,x_{\text{end}}]} \|y^{(n)}(x) - y^{(m)}(x) \|
			\]
			Für jedes feste $x \in [x_0,x_{\text{end}}]$ ist dann $\eps > \| y^{(n)}(x) - y^{(m)}(x)\|$ für $n,m \ge \N$.
			Also ist $(y^{(n)}(x))_{n\in \N} \subset \R^d$ Cauchyfolge und konvergiert in $\R^d$.

			Definiere damit $y : [x_0,x_{\text{end}}] \to \R^d$ durch 
			\[
				y := \lim_{n\to \infty} y^{(n)}(x).
			\]
			Es ergibt sich im Grenzwert die Beziehung
			\[
				\eps \ge \|y^{(n)}(x) - y(x)\|
				\qquad \forall n \ge \N
			\]
			d.h.
			\[
				\forall \eps > 0 \exists N \in \N: \qquad
				\eps \ge \max_{x\in [x_0,x_{\text{end}}]} \|y^{(n)}(x)-y(x)\|
			\]
			Damit konvergiert $y^{(n)}$ gleichmäßig gegen $y$, also ist $y$ stetig, d.h. $y\in C([x_0,x_{\text{end}}])^d$.
			\[
				\|y^{(n)} - y\|_\infty = \max_{x\in [x_0,x_{\text{end}}]} \|y^{(n)}(x) - y(x)\| \to 0
				\qquad y^{(n)} \to y
			\]
		\end{seg}
	\end{proof}
\end{lem}

Wir benötigen eine abgewandelte Norm:

\begin{kor} \label{1.8}
	Für ein $\omega \in C([x_0,x_{\text{end}}])$ gelte für alle $x\in [x_0,x_{\text{end}}]$:
	\[
		\exists c,C > 0 : c \le \omega(x) \le C
	\]
	Dann ist $C([x_0,x_{\text{end}}])^d$ auch bezüglich der gewichteten Supremumsnorm
	\[
		\|y\|_\omega = \max_{x \in [x_0,x_{\text{end}}]}(\omega(x) \|y(x)\|)
	\]
	ein Banachraum.
	
	\begin{proof}
		$\|\cdot\|_\omega$ ist offensichtlich tatsächlich eine Norm und es gilt
		\[
			c \|y\|_\infty \le \|y\|_\infty \le C \|y\|_\infty
			\qquad \forall y\in C([x_0,x_{\text{end}}])^d.
		\]
		Also ist jede Cauchyfolge bezüglich $\|\cdot\|_\omega$ auch Cauchyfolge bezüglich $\|\cdot\|_\infty$ und der Grenzwert bezüglich $\|\cdot\|_\infty$ ist auch Grenzwert bezüglich $\|\cdot\|_\omega$.
	\end{proof}
\end{kor}

Wir formulieren nun das AWP in eine Fixpunktgleichung um.

\begin{lem} \label{1.9}
	Es gelten die Voraussetzungen von \ref{1.5}.
	Sei $y:[x_0,x_{\text{end}}] \to \R^d$.

	Dann ist $y$ stetig differenzierbar und erfüllt das AWP
	\[
		\forall x \in (x_0,x_{\text{end}}): y'=f(x,y(x))  \qquad y(x_0) = y_0
	\]
	genau dann, wenn $y$ stetig ist und folgende Fixpunktgleichung erfüllt:
	\[
		y(x) = y_0 + \int_{x_0}^{x} f(t, y(t)) dt
		\qquad \forall x \in [x_0,x_{\text{end}}]
	\]
	\begin{proof}
		\begin{seg}[$\implies$]
			Ist $y$ stetig differenzierbar und erfüllt das AWP, so ist
			\[
				y(x) = y(x_0) + \int_{x_0}^x y'(t) dt = y_0 + \int_{x_0}^x f(t,y(t)) dt
			\]
		\end{seg}
		\begin{seg}[$\Longleftarrow$]
			Sei $y$ stetig und erfülle die Fixpunktgleichung.
			Dann ist $f \mapsto f(t, y(t))$ stetig und
			\[
				y(x) = y_0 + \int_{x_0}^x f(t,y(t)) dt
			\]
			differenzierbar mit
			\[
				y'(x) = f(x,y(x))
				\qquad y(x_0) = y_0
			\]
		\end{seg}
	\end{proof}
\end{lem}

\begin{proof}[Beweis von \ref{1.5}]
	Jetzt genügt es zu zeigen, dass
	\begin{align*}
		\Phi: y &\mapsto \Phi(y) \\
		\Phi(y): x &\mapsto y_0 + \int_{x_0}^x f(t,y(t)) dt
	\end{align*}
	eine bezüglich einer gewichteten Supremumsnorm kontrahierende Selbstabbildung von $C([x_0,x_{\text{end}}])^d$ ist.

	Die Selbstabbildungseigenschaften sind klar.
	Für die Kontraktionseigenschaften betrachte $y^{(1)}, y^{(2)} \in C([x_0,x_\text{end}])^d$ in einem festen Punkt $x$:
	\begin{align*}
		\|\Phi(y^{(1)}(x)) - \Phi(y^{(2)}(x))\|
		&= \bigg\| \int_{x_0}^x f(t,y^{(t)}(t)) - f(t,y^{(2)}(t)) dt \bigg\| \\
		&\le \int_{x_0}^x \| f(t, y^{(1)}(t) - f(t, y^{(2)}(t))) \| dt \\
		&\le L \int_{x_0}^x \| y^{(1)}(t) - y^{(2)}(t) \| dt
	\end{align*}
	Also
	\[
		\|\Phi(y^{(1)}) - \Phi(y^{(2)}) \|_\infty \le L(x_{\text{end}}-x_0) \|y^{(1)}  - y^{(2)}\|_\infty,
	\]
	so dass $\Phi$ nur für kleine $L$ oder nahe $x_0$ eine Kontraktion ist.

	Wir suchen jetzt eine Gewichtsfunktion $\omega(x)$ (siehe \ref{1.8}): \fixme[übersichtlicher!]
	\[
		\omega(x) \Big\|\Phi(y^{(1)})(x) - \Phi(y^{(2)})(x) \Big\| 
		\le \omega(x) L \int_{x_0}^x \f 1{\omega(t)} \omega(t) \|y^{(1)}(t) - y^{(2)}(t) \| dt
		\le \omega(x) L\|y^{(1)} - y^{(2)} \|_\omega \int_{x_0}^x \f 1{\omega(t)} dt 
	\]
	Wähle $\omega$ so, dass
	\[
		\max_{x\in [x_0,x_{\text{end}}]} \bigg( \omega(x) \int_{x_0}^x \f 1 {\omega(t)} dt  \bigg)
		< \f 1L
	\]
	Wegen
	\[
		e^{-a(x-x_0)} \int_{x_0}^x e^{a(t-x_0)} dt \le \f 1a
	\]
	wähle $\omega(x) := e^{- 2L (x-x_0)}$.
	$\omega$ erfüllt die Voraussetzung von \ref{1.8} und
	\[
		\Big\|\Phi(y^{(1)}) - \Phi(y^{(2)}) \Big\|_{\omega} \le \underbrace{ L \f 1{2L}}_{< 1} \|y^{(1)} - y^{(2)}\|_\omega
	\]
	d.h. $\Phi$ ist eine Kontraktion mit Kontraktionsfaktor $\f 12$.

	Damit ist \ref{1.5} gezeigt.
\end{proof}

\begin{ex} \label{1.10}
	Auf die Lipschitzt-stetigkeit kann nicht verzichtet werden:
	\begin{enumerate}[a)]
		\item
			Betrachte $y' = \sqrt y$, $y_0 = 0$.

			$f(x,y) = \sqrt y$ ist nicht Lipschitz-stetig und die Lösung des AWP ist \emph{nicht} eindeutig, denn
			$y(x) = 0$ und 
			\[
				y(x) = \begin{cases}
					0 & 0\le x \le 1 \\
					\f 14(x-1)^2 & x > 1
				\end{cases}
			\]
		\item
			Betrachte $y' = y^2$, $y(0) = 1$.

			$f(x,y) = y^2$ ist auf $\R$ nicht Lipschitzstetig.

			Man kann zeigen, dass
			\[
				y(x) = \f 1{1-x}
			\]
			die einzige Lösung ist.
			Diese ist auf $[0,1)$ definiert.
	\end{enumerate}
\end{ex}

\begin{nt}[Worst-Case für lokale Lipschitzstetigkeit] \label{1.11}
	$f$ erfülle die lokale und in $x$ gleichmäßige Lipschitzbedingung:
	\[
		\forall x \in [x_0, x_{\text{end}}], y^{(1)}, y^{(2)} \in \_Q :
		\Big\| f(x,y^{(1)}) - f(x,y^{(2)}) \Big\| \le L \|y^{(1)} - y^{(2)}\|
	\]
	mit $Q = (a_1,b_1) \times \dotsb \times (a_d, b_d)$.

	Dann kann man zeigen, dass für jeden Anfangswert $y_0 \in Q$ ein nicht-leeres Teilintervall $[x_0, x_1]$ ($x_1 \le x_{\text{end}}$) mit genau einer Lösung existiert.

	Darüber hinaus kann man zeigen, dass sich die Lösungkurve $(x,y(x))$ bis zum Rand des Rechtecks $[x_0,x_{\text{end}}]\times Q$ eindeutig fortsetzen lässt.
\end{nt}


\subsubsection{Stabilität}


Wie wirken sich Störungen in den Anfangswerten auf die Lösung der DGL aus?

\begin{st} \label{1.12}
	Es gelten die Voraussetzungen von \ref{1.5}.
	Seien $y,z$ zwei Lösungen der gleichen DGL, aber zu verschiedenen Anfangswerten, d.h.
	\begin{align*}
		y'(x) &= f(x,y(x)), \quad y(x_0) = y_0 \\
		z'(x) &= f(x,z(x)), \quad z(x_0) = z_0
	\end{align*}
	Dann gilt
	\[
		\|y(x) - z(x)\| \le e^{L(x-x_0)} \|y_0 - z_0\|
		\qquad \forall x \in [x_0,x_{\text{end}}]
	\]
	\begin{proof}
		Betrachte die Differenz
		\[
			s(x) := \|y(x) - z(x)\|^2 = (y(x)-z(x))^T (y(x) - z(x))
		\]
		Dann ist
		\begin{align*}
			s'(x) :&= 2(y'(x)-z'(x))^T (y(x)-z(x)) \\
			&= 2 \Big( f(x,y(x)) - f(x,z(x)) \Big)^T (y(x) -z(x)) \\ 
			&\le 2 \Big\| f(x,y(x)) - f(x, z(x)) \Big\| \| y(x) -z(x)\| \\
			&\le 2 L \|y(x) - z(x) \|^2 
			= 2 Ls(x)
		\end{align*}
		ist $y_0 = z_0$, so ist nach \ref{1.5} $y(x) = z(x)$ für alle $x \ge x_0$.

		Sonst existiert ein größtmögliches $\delta$ mit $s(x) \neq 0$ auf $[x_0,x_0 + \delta]$.
		Falls $x_0 + \delta < x_{\text{end}}$, dann ist $s(x_0 + \delta) = 0$ (siehe Votieraufgabe 2.5).

		Es genügt die Behauptung in diesem Intervall zu zeigen, da für $s(x_0 + \delta) = 0$ nach \ref{1.5} $y$ und $z$ ab $x \ge x_0 + \delta$ übereinstimmen.

		Für $x \in [x_0, x_0 + \delta]$ gilt
		\[
			\f{d}{dx} \ln (s(x)) = \f {s'(x)}{s(x)} \le 2L
		\]
		Also
		\[
			\ln (s(x))  
			= \int_{x_0}^x \f {d}{dt} \ln(s(t)) dt + \ln(s(x_0))
			\le 2 L (x-x_0) + \ln (s(x_0))
		\]
		und damit
		\[
			\|y(x) - z(x)\|^2 \le e^{2L(x-x_0)} \|y_0-z_0\|^2
		\]
		Daraus folgt die Behauptung.
	\end{proof}
\end{st}


\begin{nt} \label{1.13}
	\begin{enumerate}[a)]
		\item
			Auch wenn $f$ nur lokal Lipschitzstetig ist, gilt das Stabilitätsresultat aus \ref{1.12} dort, wo die eindeutige Existenz gewährleistet ist.
		\item
			Wir werden in dieser Vorlesung im Folgenden annehmen, dass $f$ beliebig oft stetig differenzierbar ist.
			Insbesondere sind diese Funktionen auf jedem kompakten Intervall Lipschitzstetig, so dass das AWP 
			\[
				y'=f(x,y(x)), \qquad y(x_0) = y_0
			\]
			zumindest in einem hinreichend kleinem Intervall $[x_0, x_{\text{end}}]$ wohlgestellt ist (d.h. es existiert eine eindeutige Lösung und es gilt stabile Abhängigkeit von den Anfangsdaten gemäß \ref{1.12}).

			Außerdem kann man dann zeigen, dass auch $y$ unendlich oft stetig differenzierbar ist.
	\end{enumerate}
\end{nt}


\section{Erste Lösungsmethoden}


\subsection{Das Richtungsfeld}


Betrachte ein eindimensionales AWP, in dem wir die Lösung $y: [x_0,\infty) \to \R$ von
\[
	y' = f(x,y(x)) , \qquad y(x_0) = y_0
\]
suchen.

\fixme[Bild: Richtungsfeld]

Wir können die DGL durch das zugehörige Richtungsfeld veranschaulichen.

Zeichne für eine Auswahl von Punkten $(x,y) \in \R^2$ den Richtungspfeil mit Steigung $y'=f(x,y)$ ein, z.B.:
\[
	\begin{pmatrix}
		1 \\
		f(x,y)
	\end{pmatrix}
\]
Eine Funktion löst die DGL genau dann, wenn an jedem Punkt, durch den die Funktion geht, die Steigung der Funktion und die Steigung des Richtungspfeils übereinstimmen.

Man kann das AWP zeichnerisch lösen, indem man ausgehend von dem Startwert $(x_0,y_0)$ die Funktion passend zu den Richtungspfeilen zeichnet.



\end{document}


